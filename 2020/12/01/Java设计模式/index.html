<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no"><meta name="author" content="小灰灰"><meta name="renderer" content="webkit"><meta name="copyright" content="小灰灰"><meta name="keywords" content="小灰灰"><meta name="description" content=""><meta name="Cache-Control" content="no-cache"><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"><title>Java设计模式 · xhh's Blog</title><link rel="stylesheet" href="/css/style.css?v=2018.7.9"><link rel="stylesheet" href="/css/animation.css?v=2018.7.9"><link rel="icon" href="/img/assets/people1.ico"><link rel="stylesheet" href="https://cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css?version=1.5.6"><!-- scripts--><script>(function( w ){
  "use strict";
  // rel=preload support test
  if( !w.loadCSS ){
    w.loadCSS = function(){};
  }
  // define on the loadCSS obj
  var rp = loadCSS.relpreload = {};
  // rel=preload feature support test
  // runs once and returns a function for compat purposes
  rp.support = (function(){
    var ret;
    try {
      ret = w.document.createElement( "link" ).relList.supports( "preload" );
    } catch (e) {
      ret = false;
    }
    return function(){
      return ret;
    };
  })();

  // if preload isn't supported, get an asynchronous load by using a non-matching media attribute
  // then change that media back to its intended value on load
  rp.bindMediaToggle = function( link ){
    // remember existing media attr for ultimate state, or default to 'all'
    var finalMedia = link.media || "all";

    function enableStylesheet(){
      link.media = finalMedia;
    }

    // bind load handlers to enable media
    if( link.addEventListener ){
      link.addEventListener( "load", enableStylesheet );
    } else if( link.attachEvent ){
      link.attachEvent( "onload", enableStylesheet );
    }

    // Set rel and non-applicable media type to start an async request
    // note: timeout allows this to happen async to let rendering continue in IE
    setTimeout(function(){
      link.rel = "stylesheet";
      link.media = "only x";
    });
    // also enable media after 3 seconds,
    // which will catch very old browsers (android 2.x, old firefox) that don't support onload on link
    setTimeout( enableStylesheet, 3000 );
  };

  // loop through link elements in DOM
  rp.poly = function(){
    // double check this to prevent external calls from running
    if( rp.support() ){
      return;
    }
    var links = w.document.getElementsByTagName( "link" );
    for( var i = 0; i < links.length; i++ ){
      var link = links[ i ];
      // qualify links to those with rel=preload and as=style attrs
      if( link.rel === "preload" && link.getAttribute( "as" ) === "style" && !link.getAttribute( "data-loadcss" ) ){
        // prevent rerunning on link
        link.setAttribute( "data-loadcss", true );
        // bind listeners to toggle media back
        rp.bindMediaToggle( link );
      }
    }
  };

  // if unsupported, run the polyfill
  if( !rp.support() ){
    // run once at least
    rp.poly();

    // rerun poly on an interval until onload
    var run = w.setInterval( rp.poly, 500 );
    if( w.addEventListener ){
      w.addEventListener( "load", function(){
        rp.poly();
        w.clearInterval( run );
      } );
    } else if( w.attachEvent ){
      w.attachEvent( "onload", function(){
        rp.poly();
        w.clearInterval( run );
      } );
    }
  }


  // commonjs
  if( typeof exports !== "undefined" ){
    exports.loadCSS = loadCSS;
  }
  else {
    w.loadCSS = loadCSS;
  }
}( typeof global !== "undefined" ? global : this ) );</script><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js" defer></script><script src="/js/main.js?v=2018.7.9" defer></script><!-- fancybox--><link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.2.5/jquery.fancybox.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'"><script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.2.5/jquery.fancybox.min.js" defer></script><!-- busuanzi--><script async src="//dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script></head><body><section class="profile-close" id="cxo-profile"><div class="profile-avatar"><i class="fa fa-caret-left"></i><img src="/img/assets/people.png"></div><!--.profile-saying
  i.fa.fa-comment
  .saying--><div class="cxo-profile-inner"><div class="profile-name">xiaohuihui</div><div class="profile-signature">for me</div><div class="friends"><div>FRIENDS</div><span><a href="//www.cnblogs.com/lc-snail/" target="_black">friendA</a></span><span><a href="//github.com/" target="_black">friendB</a></span><span><a href="//github.com/" target="_black">friendC</a></span></div><div class="read-progress"></div></div></section><header id="cxo-intro" style="height: 70vh;background-image: url(/img/intro/index-bg.png);"><nav id="cxo-intro-nav"><section><div class="intro-nav-title"><a href="/">xhh's Blog</a></div><div class="intro-nav-label-box"><a href="/">Home</a><a href="/about/">About</a><a href="/archives/">Archives</a><a href="/tags/">Tags</a></div><i class="fa fa-bars intro-nav-menu"><div class="intro-nav-drop"><a href="/">Home</a><a href="/about/">About</a><a href="/archives/">Archives</a><a href="/tags/">Tags</a></div></i><div class="clear"></div></section></nav><h1 class="post-title">Java设计模式</h1><div class="post-intros"><div class="post-intro-meta"><span class="post-intro-time"><i class="post-intro-calendar fa fa-calendar"></i><span>2020-12-01 11:34:24</span></span></div><div class="post-intro-read"><span> Word count: <span class="post-count">36k</span> | Reading time: <span class="post-count">156</span>min</span></div></div></header><article class="cxo-up" id="cxo-content-outer"><section id="cxo-content-inner"><article class="article-entry" id="post"><p>typora-root-url: ..</p>
<h1 id="Java设计模式"><a href="#Java设计模式" class="headerlink" title="Java设计模式"></a>Java设计模式</h1><h3 id="设计模式常用的七大原则："><a href="#设计模式常用的七大原则：" class="headerlink" title="设计模式常用的七大原则："></a>设计模式常用的七大原则：</h3><ol>
<li>单一职责原则</li>
<li>接口隔离原则</li>
<li>依赖倒置原则</li>
<li>里氏替换原则</li>
<li>开闭原则ocp</li>
<li>迪米特法则</li>
<li>合成复用原则</li>
</ol>
<h4 id="1-单一职责原则-Single-Principle-Responsibility"><a href="#1-单一职责原则-Single-Principle-Responsibility" class="headerlink" title="1.单一职责原则(Single Principle Responsibility)"></a>1.单一职责原则(Single Principle Responsibility)</h4><p>对类来说，即一个类应该只负责一项职责。如果类A负责两个不同职责：职责1，职责2。当职责1需求变更而改变A时，可能造成职责2执行错误，所以需要将类A的粒度分解为A1，A2。</p>
<ul>
<li>第一例</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> DesignPattern.principle.singleResponsibility;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> coderYang</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2020/12/1 14:19</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SingleResponsibility1</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    Vehicle vehicle = <span class="keyword">new</span> Vehicle();</span><br><span class="line">    vehicle.run(<span class="string">"法拉利"</span>);     <span class="comment">//法拉利正在公路上运行</span></span><br><span class="line">    vehicle.run(<span class="string">"飞机"</span>);      <span class="comment">//飞机正在公路上运行</span></span><br><span class="line">    vehicle.run(<span class="string">"泰坦尼克号"</span>);     <span class="comment">//泰坦尼克号正在公路上运行</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//交通工具类</span></span><br><span class="line"><span class="comment">//在方式1的run方法中,违反了单一职责原则</span></span><br><span class="line"><span class="comment">//解决方案:根据交通工具的运行方法不同,分解不同的类即可</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Vehicle</span></span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">(String vehicle)</span></span>&#123;</span><br><span class="line">    System.out.println(vehicle+<span class="string">"正在公路上运行"</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<ul>
<li>第二例</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> DesignPattern.principle.singleResponsibility;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> coderYang</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2020/12/1 14:24</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SingleResponsibility2</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    RoadVehicle roadVehicle = <span class="keyword">new</span> RoadVehicle();</span><br><span class="line">    roadVehicle.run(<span class="string">"法拉利"</span>);     <span class="comment">//法拉利在公路上运行</span></span><br><span class="line"></span><br><span class="line">    AirVehicle airVehicle = <span class="keyword">new</span> AirVehicle();</span><br><span class="line">    airVehicle.run(<span class="string">"飞机"</span>);     <span class="comment">//飞机在天上运行</span></span><br><span class="line"></span><br><span class="line">    WaterVehicle waterVehicle = <span class="keyword">new</span> WaterVehicle();</span><br><span class="line">    waterVehicle.run(<span class="string">"泰坦尼克号"</span>);    <span class="comment">//泰坦尼克号在水中运行</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 方案2分析:</span></span><br><span class="line"><span class="comment"> * 1.遵守了单一职责原则</span></span><br><span class="line"><span class="comment"> * 2.但是这样做的改动很大,即将类分解,同时修改客户端</span></span><br><span class="line"><span class="comment"> * 3.改进:直接改动Vehicle类,改动的代码会比较少=&gt;方案3</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">RoadVehicle</span></span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">(String vehicle)</span></span>&#123;</span><br><span class="line">    System.out.println(vehicle+<span class="string">"在公路上运行"</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">AirVehicle</span></span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">(String vehicle)</span></span>&#123;</span><br><span class="line">    System.out.println(vehicle+<span class="string">"在天上运行"</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">WaterVehicle</span></span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">(String vehicle)</span></span>&#123;</span><br><span class="line">    System.out.println(vehicle+<span class="string">"在水中运行"</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<ul>
<li>第三例</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> DesignPattern.principle.singleResponsibility;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> coderYang</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2020/12/1 14:31</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SingleResponsibility3</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    Vehicle2 vehicle2 = <span class="keyword">new</span> Vehicle2();</span><br><span class="line">    vehicle2.run(<span class="string">"汽车"</span>);     <span class="comment">//汽车在公路运行</span></span><br><span class="line">    vehicle2.runWater(<span class="string">"轮船"</span>);      <span class="comment">//轮船在水中运行</span></span><br><span class="line">    vehicle2.runAir(<span class="string">"飞机"</span>);      <span class="comment">//飞机在天空运行</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 方式3分析</span></span><br><span class="line"><span class="comment"> * 1.这种修改方法没有对原来的类做大的修改,只是增加了方法</span></span><br><span class="line"><span class="comment"> * 2.这里虽然没有在类这个级别上遵守单一职责原则,但是在方法级别上是仍然遵守单一职责</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Vehicle2</span></span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">(String vehicle)</span></span>&#123;</span><br><span class="line">    System.out.println(vehicle+<span class="string">"在公路运行"</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">runAir</span><span class="params">(String vehicle)</span></span>&#123;</span><br><span class="line">    System.out.println(vehicle+<span class="string">"在天空运行"</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">runWater</span><span class="params">(String vehicle)</span></span>&#123;</span><br><span class="line">    System.out.println(vehicle+<span class="string">"在水中运行"</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<p><strong>单一职责原则注意事项和细节：</strong></p>
<ol>
<li>降低类的复杂度，一个类只复杂一项职责</li>
<li>提高类的可读性，可维护性</li>
<li>降低变更引起的风险</li>
<li>通常情况下，<strong>我们应该遵守单一职责原则</strong>，只要逻辑足够简单，才可以在代码级违反单一职责原则：只有类中方法足够少，可以在方法级别保持单一职责原则。</li>
</ol>
<h4 id="2-接口隔离原则-Interface-Segregation-Principle"><a href="#2-接口隔离原则-Interface-Segregation-Principle" class="headerlink" title="2.接口隔离原则(Interface Segregation Principle)"></a>2.接口隔离原则(Interface Segregation Principle)</h4><p>客户端不应该依赖它不需要的接口，即一个类对另一个类的依赖应该建立在最小的接口上。</p>
<p>问题：</p>
<p><img src="/images/Java%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/image-20201202150538851.png" alt="image-20201202150538851"></p>
<p>此图类A通过接口Interface1依赖类B，类C通过接口Interface1依赖类D，如果接口Interface1对于类A和类C来说不是最小接口，那么类B和类D必须去实现他们不需要的方法。</p>
<p>代码：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> DesignPattern.principle.segregation;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> coderYang</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2020/12/2 15:08</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Segregation</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    A a = <span class="keyword">new</span> A();</span><br><span class="line">    a.depend1(<span class="keyword">new</span> B());       <span class="comment">//B实现了operation1</span></span><br><span class="line">    a.depend2(<span class="keyword">new</span> B());       <span class="comment">//B实现了operation2</span></span><br><span class="line">    a.depend3(<span class="keyword">new</span> B());       <span class="comment">//B实现了operation3</span></span><br><span class="line"></span><br><span class="line">    C c = <span class="keyword">new</span> C();</span><br><span class="line">    c.depend1(<span class="keyword">new</span> D());       <span class="comment">//D实现了operation1</span></span><br><span class="line">    c.depend4(<span class="keyword">new</span> D());       <span class="comment">//D实现了operation4</span></span><br><span class="line">    c.depend5(<span class="keyword">new</span> D());       <span class="comment">//D实现了operation5</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//接口</span></span><br><span class="line"><span class="class"><span class="keyword">interface</span> <span class="title">Interface1</span></span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">void</span> <span class="title">operation1</span><span class="params">()</span></span>;</span><br><span class="line">  <span class="function"><span class="keyword">void</span> <span class="title">operation2</span><span class="params">()</span></span>;</span><br><span class="line">  <span class="function"><span class="keyword">void</span> <span class="title">operation3</span><span class="params">()</span></span>;</span><br><span class="line">  <span class="function"><span class="keyword">void</span> <span class="title">operation4</span><span class="params">()</span></span>;</span><br><span class="line">  <span class="function"><span class="keyword">void</span> <span class="title">operation5</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//类B</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">B</span> <span class="keyword">implements</span> <span class="title">Interface1</span></span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">operation1</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    System.out.println(<span class="string">"B实现了operation1"</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">operation2</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    System.out.println(<span class="string">"B实现了operation2"</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">operation3</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    System.out.println(<span class="string">"B实现了operation3"</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">operation4</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    System.out.println(<span class="string">"B实现了operation4"</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">operation5</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    System.out.println(<span class="string">"B实现了operation5"</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//类D</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">D</span> <span class="keyword">implements</span> <span class="title">Interface1</span></span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">operation1</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    System.out.println(<span class="string">"D实现了operation1"</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">operation2</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    System.out.println(<span class="string">"D实现了operation2"</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">operation3</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    System.out.println(<span class="string">"D实现了operation3"</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">operation4</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    System.out.println(<span class="string">"D实现了operation4"</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">operation5</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    System.out.println(<span class="string">"D实现了operation5"</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span></span>&#123;    <span class="comment">//A通过interface1依赖(使用)B类,但是只会用到1,2,3方法</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">depend1</span><span class="params">(Interface1 i)</span></span>&#123;</span><br><span class="line">    i.operation1();</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">depend2</span><span class="params">(Interface1 i)</span></span>&#123;</span><br><span class="line">    i.operation2();</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">depend3</span><span class="params">(Interface1 i)</span></span>&#123;</span><br><span class="line">    i.operation3();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">C</span></span>&#123;    <span class="comment">//C类通过interface1依赖(使用)D类,但是只会使用到1,4,5方法</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">depend1</span><span class="params">(Interface1 i)</span></span>&#123;</span><br><span class="line">    i.operation1();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">depend4</span><span class="params">(Interface1 i)</span></span>&#123;</span><br><span class="line">    i.operation4();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">depend5</span><span class="params">(Interface1 i)</span></span>&#123;</span><br><span class="line">    i.operation5();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>









<p><strong>按隔离原则应当这样处理：</strong></p>
<p>将接口Interface1拆分为独立的几个接口，类A和类C分别与他们需要的接口建立依赖关系。也就是采用接口隔离原则 。</p>
<p>接口Interface1中出现的方法，根据实际情况拆分为三个接口。</p>
<p><img src="/images/Java%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/image-20201202161447282.png" alt="image-20201202161447282"></p>
<p>代码：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> DesignPattern.principle.segregation.improve;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> coderYang</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2020/12/2 15:08</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Segregation</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    A a = <span class="keyword">new</span> A();</span><br><span class="line">    <span class="comment">//A类通过接口依赖B类</span></span><br><span class="line">    a.depend1(<span class="keyword">new</span> B());     <span class="comment">//B实现了operation1</span></span><br><span class="line">    a.depend2(<span class="keyword">new</span> B());     <span class="comment">//B实现了operation2</span></span><br><span class="line">    a.depend3(<span class="keyword">new</span> B());     <span class="comment">//B实现了operation3</span></span><br><span class="line"></span><br><span class="line">    C c = <span class="keyword">new</span> C();</span><br><span class="line">    <span class="comment">//C类通过皆空依赖(使用)D类</span></span><br><span class="line">    c.depend1(<span class="keyword">new</span> D());     <span class="comment">//D实现了operation1</span></span><br><span class="line">    c.depend4(<span class="keyword">new</span> D());     <span class="comment">//D实现了operation4</span></span><br><span class="line">    c.depend5(<span class="keyword">new</span> D());     <span class="comment">//D实现了operation5</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//接口1</span></span><br><span class="line"><span class="class"><span class="keyword">interface</span> <span class="title">Interface1</span></span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">void</span> <span class="title">operation1</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//接口2</span></span><br><span class="line"><span class="class"><span class="keyword">interface</span> <span class="title">Interface2</span></span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">void</span> <span class="title">operation2</span><span class="params">()</span></span>;</span><br><span class="line">  <span class="function"><span class="keyword">void</span> <span class="title">operation3</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//接口3</span></span><br><span class="line"><span class="class"><span class="keyword">interface</span> <span class="title">Interface3</span></span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">void</span> <span class="title">operation4</span><span class="params">()</span></span>;</span><br><span class="line">  <span class="function"><span class="keyword">void</span> <span class="title">operation5</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//类B</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">B</span> <span class="keyword">implements</span> <span class="title">Interface1</span>,<span class="title">Interface2</span></span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">operation1</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    System.out.println(<span class="string">"B实现了operation1"</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">operation2</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    System.out.println(<span class="string">"B实现了operation2"</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">operation3</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    System.out.println(<span class="string">"B实现了operation3"</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//类D</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">D</span> <span class="keyword">implements</span> <span class="title">Interface1</span>,<span class="title">Interface3</span></span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">operation1</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    System.out.println(<span class="string">"D实现了operation1"</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">operation4</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    System.out.println(<span class="string">"D实现了operation4"</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">operation5</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    System.out.println(<span class="string">"D实现了operation5"</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span></span>&#123;    <span class="comment">//A通过interface1依赖(使用)B类,但是只会用到1,2,3方法</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">depend1</span><span class="params">(Interface1 i)</span></span>&#123;</span><br><span class="line">    i.operation1();</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">depend2</span><span class="params">(Interface2 i)</span></span>&#123;</span><br><span class="line">    i.operation2();</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">depend3</span><span class="params">(Interface2 i)</span></span>&#123;</span><br><span class="line">    i.operation3();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">C</span></span>&#123;    <span class="comment">//C类通过interface1依赖(使用)D类,但是只会使用到1,4,5方法</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">depend1</span><span class="params">(Interface1 i)</span></span>&#123;</span><br><span class="line">    i.operation1();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">depend4</span><span class="params">(Interface3 i)</span></span>&#123;</span><br><span class="line">    i.operation4();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">depend5</span><span class="params">(Interface3 i)</span></span>&#123;</span><br><span class="line">    i.operation5();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

















<h4 id="3-依赖倒转原则-Dependence-Inversion-Principle"><a href="#3-依赖倒转原则-Dependence-Inversion-Principle" class="headerlink" title="3.依赖倒转原则(Dependence Inversion Principle)"></a>3.依赖倒转原则(Dependence Inversion Principle)</h4><p>1）高层模块不应该依赖底层模块，二者都应该依赖其抽象</p>
<p>2）抽象不应该依赖细节，细节应该依赖抽象</p>
<p>3）依赖倒转(倒置)的中心思想是面向接口编程</p>
<p>4）依赖倒转原则是基于这样的设计理念：相对于细节的多变性，抽象的东西要稳定的多。以抽象为基础搭建的架构比以细节为基础的架构要稳的多。在java中，抽象指的是接口或者抽象类，细节就是具体的实现类。</p>
<p>5）使用接口或抽象类的目的是制定好规范，而不涉及任何具体的操作，把展现细节的任务交给他们的实现类去完成。</p>
<p><strong>方案1：</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> DesignPattern.principle.inversion;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> coderYang</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2020/12/4 11:03</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DependencyInversion</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    Person person = <span class="keyword">new</span> Person();</span><br><span class="line">    person.receive(<span class="keyword">new</span> Email());    <span class="comment">//电子邮件信息:Hello World</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Email</span></span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> String <span class="title">getInfo</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">"电子邮件信息:Hello World"</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//完成Person接收消息的功能</span></span><br><span class="line"><span class="comment">//方式1分析</span></span><br><span class="line"><span class="comment">//1.如果我们获取的对象是微信,短信等等,而不是email,则新增类,同时Person也要增加相应的接收方法</span></span><br><span class="line"><span class="comment">//2.解决思路:引入一个抽象的接口IReceiver,表示一个接收者,这样Person类与接口发生依赖</span></span><br><span class="line"><span class="comment">//  因为Email,WeiXin等都属于接收的范围,他们各自实现IReceiver接口就ok,这样就符合依赖倒转原则</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span></span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">receive</span><span class="params">(Email email)</span></span>&#123;</span><br><span class="line">    System.out.println(email.getInfo());</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<p><strong>方案2(依赖倒转):</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> DesignPattern.principle.inversion.improve;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> coderYang</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2020/12/4 11:03</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DependencyInversion</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    Person person = <span class="keyword">new</span> Person();</span><br><span class="line">    person.receive(<span class="keyword">new</span> Email());    <span class="comment">//电子邮件信息:Hello World</span></span><br><span class="line">    person.receive(<span class="keyword">new</span> WeiXin());   <span class="comment">//微信消息:Hello,welcome using WeChat</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//定义接口</span></span><br><span class="line"><span class="class"><span class="keyword">interface</span> <span class="title">IReceiver</span></span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> String <span class="title">getInfo</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Email</span> <span class="keyword">implements</span> <span class="title">IReceiver</span></span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> String <span class="title">getInfo</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">"电子邮件信息:Hello World"</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">WeiXin</span> <span class="keyword">implements</span> <span class="title">IReceiver</span></span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> String <span class="title">getInfo</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">"微信消息:Hello,welcome using WeChat"</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span></span>&#123;</span><br><span class="line">  <span class="comment">//面向接口编程</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">receive</span><span class="params">(IReceiver receiver)</span></span>&#123;</span><br><span class="line">    System.out.println(receiver.getInfo());</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>







<p><strong>依赖关系传递的三方式</strong>：</p>
<ol>
<li>接口传递</li>
<li>构造方法传递</li>
<li>setter方式传递</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> DesignPattern.principle.inversion;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> coderYang</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2020/12/6 13:24</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DependencyPass</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    <span class="comment">//第一种方式   通过接口传递</span></span><br><span class="line"><span class="comment">//    Xiaomi xiaomi = new Xiaomi();</span></span><br><span class="line"><span class="comment">//    OpenAndClose openAndClose = new OpenAndClose();</span></span><br><span class="line"><span class="comment">//    openAndClose.open(xiaomi);    //小米电视机,打开</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//第二种方式   通过构造器进行依赖的传递</span></span><br><span class="line"><span class="comment">//    Xiaomi xiaomi = new Xiaomi();</span></span><br><span class="line"><span class="comment">//    OpenAndClose openAndClose = new OpenAndClose(xiaomi);</span></span><br><span class="line"><span class="comment">//    openAndClose.open();      //小米电视机,打开</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//第三种方式     通过setter的方式进行依赖的传递</span></span><br><span class="line">    Xiaomi xiaomi = <span class="keyword">new</span> Xiaomi();</span><br><span class="line">    OpenAndClose openAndClose = <span class="keyword">new</span> OpenAndClose();</span><br><span class="line">    openAndClose.setTv(xiaomi);</span><br><span class="line">    openAndClose.open();      <span class="comment">//小米电视机,打开</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 方式1:通过接口传递实现依赖</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="comment">//interface IOpenAndClose&#123;</span></span><br><span class="line"><span class="comment">//  public void open(ITV tv);   //抽象方法,接收接口</span></span><br><span class="line"><span class="comment">//&#125;</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//interface ITV&#123;  //ITV接口</span></span><br><span class="line"><span class="comment">//  public void play();</span></span><br><span class="line"><span class="comment">//&#125;</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">////实现接口</span></span><br><span class="line"><span class="comment">//class OpenAndClose implements IOpenAndClose&#123;</span></span><br><span class="line"><span class="comment">//  public void open(ITV tv)&#123;</span></span><br><span class="line"><span class="comment">//    tv.play();</span></span><br><span class="line"><span class="comment">//  &#125;</span></span><br><span class="line"><span class="comment">//&#125;</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"></span><br><span class="line"><span class="comment">////例子:小米电视机</span></span><br><span class="line"><span class="comment">//class Xiaomi implements ITV&#123;</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//  @Override</span></span><br><span class="line"><span class="comment">//  public void play() &#123;</span></span><br><span class="line"><span class="comment">//    System.out.println("小米电视机,打开");</span></span><br><span class="line"><span class="comment">//  &#125;</span></span><br><span class="line"><span class="comment">//&#125;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 方式2:通过构造方法传递依赖</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="comment">//interface IOpenAndClose&#123;</span></span><br><span class="line"><span class="comment">//  public void open();     //抽象方法</span></span><br><span class="line"><span class="comment">//&#125;</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//interface ITV&#123;   //ITV接口</span></span><br><span class="line"><span class="comment">//  public void play();</span></span><br><span class="line"><span class="comment">//&#125;</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//class OpenAndClose implements IOpenAndClose&#123;</span></span><br><span class="line"><span class="comment">//  public ITV tv;    //成员</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//  public OpenAndClose(ITV tv) &#123;     //构造器</span></span><br><span class="line"><span class="comment">//    this.tv = tv;</span></span><br><span class="line"><span class="comment">//  &#125;</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//  @Override</span></span><br><span class="line"><span class="comment">//  public void open() &#123;</span></span><br><span class="line"><span class="comment">//    this.tv.play();</span></span><br><span class="line"><span class="comment">//  &#125;</span></span><br><span class="line"><span class="comment">//&#125;</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">////例子</span></span><br><span class="line"><span class="comment">//class Xiaomi implements ITV&#123;</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//  @Override</span></span><br><span class="line"><span class="comment">//  public void play() &#123;</span></span><br><span class="line"><span class="comment">//    System.out.println("小米电视机,打开");</span></span><br><span class="line"><span class="comment">//  &#125;</span></span><br><span class="line"><span class="comment">//&#125;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 方式3:通过setter方法传递</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="class"><span class="keyword">interface</span> <span class="title">IOpenAndClose</span></span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">open</span><span class="params">()</span></span>;     <span class="comment">//抽象方法</span></span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setTv</span><span class="params">(ITV tv)</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">interface</span> <span class="title">ITV</span></span>&#123;    <span class="comment">//ITV接口</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">play</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">OpenAndClose</span> <span class="keyword">implements</span> <span class="title">IOpenAndClose</span></span>&#123;</span><br><span class="line">  <span class="keyword">private</span> ITV tv;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setTv</span><span class="params">(ITV tv)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.tv = tv;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">open</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.tv.play();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//例子</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Xiaomi</span> <span class="keyword">implements</span> <span class="title">ITV</span></span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">play</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    System.out.println(<span class="string">"小米电视机,打开"</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>







<p><strong>依赖倒转原则的注意事项和细节：</strong></p>
<ol>
<li>底层模块尽量都要有抽象类或接口，或两者都有，程序稳定性更好。</li>
<li>变量的声明类型尽量是抽象类或接口，这样我们的变量引用和实际对象间，就存在一个缓冲层，利于程序扩展和优化。</li>
<li>继承时遵循里氏替换原则。</li>
</ol>
<h4 id="4-里氏替换原则-Liskov-Substitution-principle"><a href="#4-里氏替换原则-Liskov-Substitution-principle" class="headerlink" title="4.里氏替换原则(Liskov Substitution principle)"></a>4.里氏替换原则(Liskov Substitution principle)</h4><p><strong>OO中的继承性质的思考和说明</strong></p>
<ol>
<li>继承包含这样一层含义：父类中凡是已经实现好的方法，实际上是在设定规范和契约，虽然它不强制要求所有子类必须遵守这些契约，但是如果子类对这些已经实现的方法任意修改，就会对整个继承体系造成破坏。</li>
<li>继承在给程序设计带来便利的同时，也带来了弊端。比如使用继承会给程序带来侵入性，程序的可移植性降低，增加对象间的耦合性，如果一个类被其他的类所继承，则当这个类需要修改时，必须考虑到所有的子类，并且父类修改后，所有涉及到子类的功能都有可能产生故障。</li>
<li>正确的使用继承=&gt;<strong>里氏替换原则</strong></li>
</ol>
<p><strong>里氏替换原则</strong>：</p>
<ol>
<li>如果对每个类型为T1的对象o1，都有类型为T2的对象o2，使得以T1定义的所有程序p在所有的对象o1都替换为o2时，程序p的行为没有发生变化，那么类型T2是类型T1的子类型。换句话说，所有引用基类的地方必须能透明地使用其子类的对象。</li>
<li>在使用继承时，遵循里氏替换原则，在子类中尽量不要重写父类的方法</li>
<li>里氏替换原则告诉我们，继承实际上让两个类的耦合性增强了，<strong>在适当的情况下，可以通过聚合，组合，依赖来解决问题</strong>。</li>
</ol>
<p>代码1:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> DesignPattern.principle.liskov;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> coderYang</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2020/12/6 19:12</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Liskov</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    A a = <span class="keyword">new</span> A();</span><br><span class="line">    System.out.println(<span class="string">"11-3="</span>+a.func1(<span class="number">11</span>,<span class="number">3</span>));        <span class="comment">//11-3=8</span></span><br><span class="line">    System.out.println(<span class="string">"1-8="</span>+a.func1(<span class="number">1</span>,<span class="number">8</span>));    <span class="comment">//1-8=-7</span></span><br><span class="line"></span><br><span class="line">    System.out.println(<span class="string">"----------------------"</span>);</span><br><span class="line">    B b = <span class="keyword">new</span> B();</span><br><span class="line">    System.out.println(<span class="string">"11-3="</span>+b.func1(<span class="number">11</span>,<span class="number">3</span>));    <span class="comment">//11-3=14</span></span><br><span class="line">    System.out.println(<span class="string">"1-8="</span>+b.func1(<span class="number">1</span>,<span class="number">8</span>));      <span class="comment">//1-8=9</span></span><br><span class="line">    System.out.println(<span class="string">"11+3+9="</span>+b.func2(<span class="number">11</span>,<span class="number">3</span>));    <span class="comment">//11+3+9=23</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//A类</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span></span>&#123;</span><br><span class="line">  <span class="comment">//返回两个数的差</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">func1</span><span class="params">(<span class="keyword">int</span> num1,<span class="keyword">int</span> num2)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> num1-num2;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//B类,继承A类</span></span><br><span class="line"><span class="comment">//增加了一个功能:完成两个数相加,再和9求和</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">B</span> <span class="keyword">extends</span> <span class="title">A</span></span>&#123;</span><br><span class="line">  <span class="comment">//重写了A类方法,可能是无意识重写的</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">func1</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> a+b;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">func2</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> func1(a,b)+<span class="number">9</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>通过以上代码，我们发现原来运行正常的相减功能发生了错误。原因就是类B无意中重写了父类的方法，造成原有功能出现错误。在实际编程中，我们常常会通过重写父类的方法完成新的功能，这样写起来虽然简单，但整个继承体系的复用性会比较差。特别是运行多态比较频繁的时候。</p>
<p><strong>解决方法：原来的父类和子类都继承一个更通俗的基类，原有的继承关系去掉，采用依赖，聚合，组合等关系代替。</strong></p>
<p><img src="/images/Java%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/image-20201206194922807.png" alt="image-20201206194922807"></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> DesignPattern.principle.liskov.improve;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> coderYang</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2020/12/6 19:12</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Liskov</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    A a = <span class="keyword">new</span> A();</span><br><span class="line">    System.out.println(<span class="string">"11-3="</span>+a.func1(<span class="number">11</span>,<span class="number">3</span>));        <span class="comment">//11-3=8</span></span><br><span class="line">    System.out.println(<span class="string">"1-8="</span>+a.func1(<span class="number">1</span>,<span class="number">8</span>));    <span class="comment">//1-8=-7</span></span><br><span class="line"></span><br><span class="line">    System.out.println(<span class="string">"----------------------"</span>);</span><br><span class="line">    B b = <span class="keyword">new</span> B();</span><br><span class="line">    <span class="comment">//因为B类不再继承A类,因此调用者不会再认为func1是在求减法,调用完成的功能就很明确</span></span><br><span class="line">    System.out.println(<span class="string">"11-3="</span>+b.func1(<span class="number">11</span>,<span class="number">3</span>));    <span class="comment">//11-3=14</span></span><br><span class="line">    System.out.println(<span class="string">"1-8="</span>+b.func1(<span class="number">1</span>,<span class="number">8</span>));      <span class="comment">//1-8=9</span></span><br><span class="line">    System.out.println(<span class="string">"11+3+9="</span>+b.func2(<span class="number">11</span>,<span class="number">3</span>));    <span class="comment">//11+3+9=23</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//使用组合仍然可以使用到A类相关方法</span></span><br><span class="line">    System.out.println(<span class="string">"11-3="</span>+b.func3(<span class="number">11</span>,<span class="number">3</span>));    <span class="comment">//11-3=8</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//创建一个更加基础的集类</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Base</span></span>&#123;</span><br><span class="line">  <span class="comment">//把更加基础的方法和成员写到此Base类</span></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//A类,继承集类Base</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span> <span class="keyword">extends</span> <span class="title">Base</span></span>&#123;</span><br><span class="line">  <span class="comment">//返回两个数的差</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">func1</span><span class="params">(<span class="keyword">int</span> num1,<span class="keyword">int</span> num2)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> num1-num2;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//B类,继承基类Base</span></span><br><span class="line"><span class="comment">//增加了一个功能:完成两个数相加,再和9求和</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">B</span> <span class="keyword">extends</span> <span class="title">Base</span></span>&#123;</span><br><span class="line">  <span class="comment">//如果B需要使用A类的方法,使用组合关系</span></span><br><span class="line">  <span class="keyword">private</span> A a = <span class="keyword">new</span> A();</span><br><span class="line"></span><br><span class="line">  <span class="comment">//重写了A类方法,可能是无意识重写的</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">func1</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> a+b;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">func2</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> func1(a,b)+<span class="number">9</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//使用A的方法</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">func3</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">this</span>.a.func1(a,b);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>













<h4 id="5-开闭原则-Open-Closed-Principle"><a href="#5-开闭原则-Open-Closed-Principle" class="headerlink" title="5.开闭原则(Open Closed Principle)"></a>5.开闭原则(Open Closed Principle)</h4><ol>
<li>开闭原则是编程中最基础的，最重要的设计原则。</li>
<li>一个软件实体如类，模块和函数应该对扩展开放(对提供方)，对修改关闭(对使用方)。用抽象构建框架，用实现扩展细节。</li>
<li>当软件需要变化时，尽量<strong>通过扩展</strong>软件实体的行为来实现变化，而<strong>不是通过修改</strong>已有的代码来实现变化。</li>
<li>编程中遵循其它原则，以及使用设计模式的目的就是遵循开闭原则。</li>
</ol>
<p><img src="/images/Java%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/image-20201212230827178.png" alt="image-20201212230827178"></p>
<p>实例代码：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> DesignPattern.principle.ocp;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> coderYang</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2020/12/8 14:03</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Ocp</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    GraphicEditor graphicEditor = <span class="keyword">new</span> GraphicEditor();</span><br><span class="line">    graphicEditor.drawShape(<span class="keyword">new</span> Rectangle());      <span class="comment">//绘制圆形</span></span><br><span class="line">    graphicEditor.drawShape(<span class="keyword">new</span> Circle());     <span class="comment">//绘制矩形</span></span><br><span class="line">    graphicEditor.drawShape(<span class="keyword">new</span> Triangle());     <span class="comment">//绘制三角形</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//这是一个用于绘图的类 [使用方]</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">GraphicEditor</span></span>&#123;</span><br><span class="line">  <span class="comment">//接收Shape对象,根据type来绘制不同的图形</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">drawShape</span><span class="params">(Shape s)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(s.m_type == <span class="number">1</span>)&#123;</span><br><span class="line">      drawRectangle(s);</span><br><span class="line">    &#125;<span class="keyword">else</span> <span class="keyword">if</span>(s.m_type == <span class="number">2</span>)&#123;</span><br><span class="line">      drawCircle(s);</span><br><span class="line">    &#125;<span class="keyword">else</span> <span class="keyword">if</span>(s.m_type == <span class="number">3</span>)&#123;</span><br><span class="line">      drawTriangle(s);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//绘制矩形</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">drawRectangle</span><span class="params">(Shape r)</span></span>&#123;</span><br><span class="line">    System.out.println(<span class="string">"绘制矩形"</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">//绘制圆形</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">drawCircle</span><span class="params">(Shape r)</span></span>&#123;</span><br><span class="line">    System.out.println(<span class="string">"绘制圆形"</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//绘制新增加的三角形</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">drawTriangle</span><span class="params">(Shape r)</span></span>&#123;</span><br><span class="line">    System.out.println(<span class="string">"绘制三角形"</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//Shape类,基类</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Shape</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> m_type;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//矩形类</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Rectangle</span> <span class="keyword">extends</span> <span class="title">Shape</span></span>&#123;</span><br><span class="line">  <span class="comment">//构造方法</span></span><br><span class="line">  Rectangle() &#123;</span><br><span class="line">    <span class="keyword">super</span>.m_type = <span class="number">1</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//圆形类</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Circle</span> <span class="keyword">extends</span> <span class="title">Shape</span></span>&#123;</span><br><span class="line">  Circle()&#123;</span><br><span class="line">    <span class="keyword">super</span>.m_type = <span class="number">2</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//新增三角形类</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Triangle</span> <span class="keyword">extends</span> <span class="title">Shape</span></span>&#123;</span><br><span class="line">  Triangle()&#123;</span><br><span class="line">    <span class="keyword">super</span>.m_type = <span class="number">3</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>以上代码优缺点：</strong></p>
<ol>
<li>优点比较好理解，简单易操作。</li>
<li>缺点是违反了设计模式的ocp原则，即<strong>对扩展开放(提供方)，对修改关闭(使用方)</strong>。即当我们给类增加新功能的时候，尽量不要修改代码，或尽可能少修改代码。</li>
<li>比如我们这时要新增一个图形种类，我们需要修改的地方就会很多。(会在使用方中进行修改代码，这是不合常理的，不利于功能的扩展)。</li>
</ol>
<p><strong>遵守OCP原则对方式一进行改进</strong>：</p>
<p>思路：<strong>把创建Shape类做成抽象类，并提供一个抽象的draw方法，让子类去实现即可，这样我们有新的图形种类时，只需要让新的图形类继承Shape，并实现draw方法即可，使用方的代码就不需要修改了，这满足了开闭原则</strong>。</p>
<p>修改方案：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> DesignPattern.principle.ocp.improve;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> coderYang</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2020/12/8 14:03</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Ocp</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    GraphicEditor graphicEditor = <span class="keyword">new</span> GraphicEditor();</span><br><span class="line">    graphicEditor.drawShape(<span class="keyword">new</span> Rectangle());      <span class="comment">//绘制圆形</span></span><br><span class="line">    graphicEditor.drawShape(<span class="keyword">new</span> Circle());     <span class="comment">//绘制矩形</span></span><br><span class="line">    graphicEditor.drawShape(<span class="keyword">new</span> Triangle());     <span class="comment">//绘制三角形</span></span><br><span class="line">    graphicEditor.drawShape(<span class="keyword">new</span> OtherGraphic());    <span class="comment">//绘制其它图形</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//这是一个用于绘图的类 [使用方]</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">GraphicEditor</span></span>&#123;</span><br><span class="line">  <span class="comment">//接收Shape对象,调用draw方法,此处跟面向接口编程一个道理</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">drawShape</span><span class="params">(Shape s)</span></span>&#123;</span><br><span class="line">    s.draw();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//Shape类,基类</span></span><br><span class="line"><span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">Shape</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> m_type;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">draw</span><span class="params">()</span></span>;    <span class="comment">//抽象方法</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//矩形类</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Rectangle</span> <span class="keyword">extends</span> <span class="title">Shape</span></span>&#123;</span><br><span class="line">  <span class="comment">//构造方法</span></span><br><span class="line">  Rectangle() &#123;</span><br><span class="line">    <span class="keyword">super</span>.m_type = <span class="number">1</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">draw</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    System.out.println(<span class="string">"绘制矩形"</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//圆形类</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Circle</span> <span class="keyword">extends</span> <span class="title">Shape</span></span>&#123;</span><br><span class="line">  Circle()&#123;</span><br><span class="line">    <span class="keyword">super</span>.m_type = <span class="number">2</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">draw</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    System.out.println(<span class="string">"绘制圆形"</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//新增三角形类</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Triangle</span> <span class="keyword">extends</span> <span class="title">Shape</span></span>&#123;</span><br><span class="line">  Triangle()&#123;</span><br><span class="line">    <span class="keyword">super</span>.m_type = <span class="number">3</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">draw</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    System.out.println(<span class="string">"绘制三角形"</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//新增其它一个图形</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">OtherGraphic</span> <span class="keyword">extends</span> <span class="title">Shape</span></span>&#123;</span><br><span class="line">  OtherGraphic()&#123;</span><br><span class="line">    <span class="keyword">super</span>.m_type = <span class="number">4</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">draw</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    System.out.println(<span class="string">"绘制其它图形"</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>













<h4 id="6-迪米特法则-Demeter-Principle"><a href="#6-迪米特法则-Demeter-Principle" class="headerlink" title="6.迪米特法则(Demeter Principle)"></a>6.迪米特法则(Demeter Principle)</h4><p>基本介绍：</p>
<ol>
<li>一个对象应该对其他对象保持最少的了解。</li>
<li>类与类关系越密切，耦合度越大。</li>
<li>迪米特法则(Demeter Principle)又叫<strong>最少知道原则</strong>，即一个类<strong>对自己依赖的类知道的越少越好</strong>。也就是说，对于依赖的类不管多么复杂，都尽量将逻辑封装在类的内部。对外除了提供的public方法，不要对外泄露任何信息。</li>
<li>迪米特法则还有个更简单的定义：只与直接的朋友通信。</li>
<li><strong>直接的朋友</strong>：每个对象都会与其他对象有耦合关系，只要两个对象之间有<strong>耦合关系</strong>，我们就说这两个对象之间是朋友关系。耦合的方式很多：依赖，关联，组合，聚合等。其中，我们称出现在<strong>成员变量</strong>，<strong>方法参数</strong>，<strong>方法返回值</strong>中的类为直接的朋友，而出现在<strong>局部变量中的类不是直接的朋友</strong>。也就是说，陌生的类最好不要以局部变量的形式出现在类的内部。</li>
</ol>
<p><strong>原始代码：</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> DesignPattern.principle.demeter;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> coderYang</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2020/12/8 15:23</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Demeter1</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    SchoolManager schoolManager = <span class="keyword">new</span> SchoolManager();</span><br><span class="line">    schoolManager.printAllEmployee(<span class="keyword">new</span> CollegeManager());</span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">     * 输出:</span></span><br><span class="line"><span class="comment">     *---------学院员工-----------</span></span><br><span class="line"><span class="comment">     * 学院员工id=0</span></span><br><span class="line"><span class="comment">     * 学院员工id=1</span></span><br><span class="line"><span class="comment">     * 学院员工id=2</span></span><br><span class="line"><span class="comment">     * 学院员工id=3</span></span><br><span class="line"><span class="comment">     * 学院员工id=4</span></span><br><span class="line"><span class="comment">     * 学院员工id=5</span></span><br><span class="line"><span class="comment">     * 学院员工id=6</span></span><br><span class="line"><span class="comment">     * 学院员工id=7</span></span><br><span class="line"><span class="comment">     * 学院员工id=8</span></span><br><span class="line"><span class="comment">     * 学院员工id=9</span></span><br><span class="line"><span class="comment">     * --------学校总部员工-----------</span></span><br><span class="line"><span class="comment">     * 学校总部员工id=0</span></span><br><span class="line"><span class="comment">     * 学校总部员工id=1</span></span><br><span class="line"><span class="comment">     * 学校总部员工id=2</span></span><br><span class="line"><span class="comment">     * 学校总部员工id=3</span></span><br><span class="line"><span class="comment">     * 学校总部员工id=4</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//学校总部员工类</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Employee</span></span>&#123;</span><br><span class="line">  <span class="keyword">private</span> String id;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setId</span><span class="params">(String id)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.id = id;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> String <span class="title">getId</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> id;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//学院员工类</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CollegeEmployee</span></span>&#123;</span><br><span class="line">  <span class="keyword">private</span> String id;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setId</span><span class="params">(String id)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.id = id;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> String <span class="title">getId</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> id;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//管理学院员工的管理类</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CollegeManager</span></span>&#123;</span><br><span class="line">  <span class="comment">//返回学院的所有员工</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> List&lt;CollegeEmployee&gt; <span class="title">getAllEmployee</span><span class="params">()</span></span>&#123;</span><br><span class="line">    List&lt;CollegeEmployee&gt; list = <span class="keyword">new</span> ArrayList&lt;CollegeEmployee&gt;();</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;<span class="number">10</span>;i++)&#123;   <span class="comment">//此处增加了10个员工到list集合</span></span><br><span class="line">      CollegeEmployee emp = <span class="keyword">new</span> CollegeEmployee();</span><br><span class="line">      emp.setId(<span class="string">"学院员工id="</span>+i);</span><br><span class="line">      list.add(emp);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> list;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//SchoolManager类的直接朋友:Employee,CollegeManager</span></span><br><span class="line"><span class="comment">//CollegeEmployee 不是直接朋友,而是一个陌生类,所以违反了迪米特原则</span></span><br><span class="line"><span class="comment">//学校管理类</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SchoolManager</span></span>&#123;</span><br><span class="line">  <span class="comment">//返回学校总部的员工</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> List&lt;Employee&gt; <span class="title">getAllEmployee</span><span class="params">()</span></span>&#123;</span><br><span class="line">    List&lt;Employee&gt; list = <span class="keyword">new</span> ArrayList&lt;Employee&gt;();</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;<span class="number">5</span>;i++)&#123;</span><br><span class="line">      Employee emp = <span class="keyword">new</span> Employee();</span><br><span class="line">      emp.setId(<span class="string">"学校总部员工id="</span>+i);</span><br><span class="line">      list.add(emp);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> list;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//该方法完成输出学校总部和学院员工信息(id)</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">printAllEmployee</span><span class="params">(CollegeManager sub)</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">     * 分析问题:</span></span><br><span class="line"><span class="comment">     * 1.这里的CollegeEmployee不是SchoolManager的直接朋友</span></span><br><span class="line"><span class="comment">     * 2.CollegeEmployee是以局部变量的方式出现在SchoolManager</span></span><br><span class="line"><span class="comment">     * 3.违反了迪米特原则</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="comment">//获取学院的员工</span></span><br><span class="line">    List&lt;CollegeEmployee&gt; list1 = sub.getAllEmployee();</span><br><span class="line">    System.out.println(<span class="string">"---------学院员工-----------"</span>);</span><br><span class="line">    <span class="keyword">for</span> (CollegeEmployee e:list1)&#123;</span><br><span class="line">      System.out.println(e.getId());</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//获取学校总部的员工</span></span><br><span class="line">    List&lt;Employee&gt; list2 = <span class="keyword">this</span>.getAllEmployee();</span><br><span class="line">    System.out.println(<span class="string">"--------学校总部员工-----------"</span>);</span><br><span class="line">    <span class="keyword">for</span> (Employee e:list2)&#123;</span><br><span class="line">      System.out.println(e.getId());</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>







<p><strong>改进方式:</strong></p>
<ol>
<li>前面代码设计的问题在于SchoolManager中，<strong>CollegeEmployee类并不是SchoolManager类的直接朋友</strong>(分析)</li>
<li>按照迪米特法则，应该避免类中出现这样非直接朋友关系的耦合。</li>
<li>按照迪米特法则进行代码改进(如下代码)。</li>
</ol>
<p><strong>迪米特法则代码改进</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> DesignPattern.principle.demeter.improve;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> coderYang</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2020/12/8 15:23</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Demeter1</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    SchoolManager schoolManager = <span class="keyword">new</span> SchoolManager();</span><br><span class="line">    schoolManager.printAllEmployee(<span class="keyword">new</span> CollegeManager());</span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">     * 输出:</span></span><br><span class="line"><span class="comment">     *---------学院员工-----------</span></span><br><span class="line"><span class="comment">     * 学院员工id=0</span></span><br><span class="line"><span class="comment">     * 学院员工id=1</span></span><br><span class="line"><span class="comment">     * 学院员工id=2</span></span><br><span class="line"><span class="comment">     * 学院员工id=3</span></span><br><span class="line"><span class="comment">     * 学院员工id=4</span></span><br><span class="line"><span class="comment">     * 学院员工id=5</span></span><br><span class="line"><span class="comment">     * 学院员工id=6</span></span><br><span class="line"><span class="comment">     * 学院员工id=7</span></span><br><span class="line"><span class="comment">     * 学院员工id=8</span></span><br><span class="line"><span class="comment">     * 学院员工id=9</span></span><br><span class="line"><span class="comment">     * --------学校总部员工-----------</span></span><br><span class="line"><span class="comment">     * 学校总部员工id=0</span></span><br><span class="line"><span class="comment">     * 学校总部员工id=1</span></span><br><span class="line"><span class="comment">     * 学校总部员工id=2</span></span><br><span class="line"><span class="comment">     * 学校总部员工id=3</span></span><br><span class="line"><span class="comment">     * 学校总部员工id=4</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//学校总部员工类</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Employee</span></span>&#123;</span><br><span class="line">  <span class="keyword">private</span> String id;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setId</span><span class="params">(String id)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.id = id;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> String <span class="title">getId</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> id;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//学院员工类</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CollegeEmployee</span></span>&#123;</span><br><span class="line">  <span class="keyword">private</span> String id;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setId</span><span class="params">(String id)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.id = id;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> String <span class="title">getId</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> id;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//管理学院员工的管理类</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CollegeManager</span></span>&#123;</span><br><span class="line">  <span class="comment">//返回学院的所有员工</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> List&lt;CollegeEmployee&gt; <span class="title">getAllEmployee</span><span class="params">()</span></span>&#123;</span><br><span class="line">    List&lt;CollegeEmployee&gt; list = <span class="keyword">new</span> ArrayList&lt;CollegeEmployee&gt;();</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;<span class="number">10</span>;i++)&#123;   <span class="comment">//此处增加了10个员工到list集合</span></span><br><span class="line">      CollegeEmployee emp = <span class="keyword">new</span> CollegeEmployee();</span><br><span class="line">      emp.setId(<span class="string">"学院员工id="</span>+i);</span><br><span class="line">      list.add(emp);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> list;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/*输出学院员工的信息</span></span><br><span class="line"><span class="comment">    就是自己的方法应该在自己的类中存在,不要写到别人的方法体中</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">printEmployee</span><span class="params">()</span></span>&#123;</span><br><span class="line">    List&lt;CollegeEmployee&gt; list1 = <span class="keyword">this</span>.getAllEmployee();</span><br><span class="line">    System.out.println(<span class="string">"---------学院员工-----------"</span>);</span><br><span class="line">    <span class="keyword">for</span> (CollegeEmployee e:list1)&#123;</span><br><span class="line">      System.out.println(e.getId());</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//SchoolManager类的直接朋友:Employee,CollegeManager</span></span><br><span class="line"><span class="comment">//CollegeEmployee 不是直接朋友,而是一个陌生类,所以违反了迪米特原则</span></span><br><span class="line"><span class="comment">//学校管理类</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SchoolManager</span></span>&#123;</span><br><span class="line">  <span class="comment">//返回学校总部的员工</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> List&lt;Employee&gt; <span class="title">getAllEmployee</span><span class="params">()</span></span>&#123;</span><br><span class="line">    List&lt;Employee&gt; list = <span class="keyword">new</span> ArrayList&lt;Employee&gt;();</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;<span class="number">5</span>;i++)&#123;</span><br><span class="line">      Employee emp = <span class="keyword">new</span> Employee();</span><br><span class="line">      emp.setId(<span class="string">"学校总部员工id="</span>+i);</span><br><span class="line">      list.add(emp);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> list;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//该方法完成输出学校总部和学院员工信息(id)</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">printAllEmployee</span><span class="params">(CollegeManager sub)</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">       1.将输出学院的员工方法,封装到CollegeManager</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    sub.printEmployee();</span><br><span class="line"></span><br><span class="line">    <span class="comment">//获取学校总部的员工</span></span><br><span class="line">    List&lt;Employee&gt; list2 = <span class="keyword">this</span>.getAllEmployee();</span><br><span class="line">    System.out.println(<span class="string">"--------学校总部员工-----------"</span>);</span><br><span class="line">    <span class="keyword">for</span> (Employee e:list2)&#123;</span><br><span class="line">      System.out.println(e.getId());</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<p><strong>迪米特法则注意事项和细节</strong></p>
<ol>
<li>迪米特法则的核心是降低类之间的耦合。</li>
<li>但是注意：由于每个类都减少了不必要的依赖，因为迪米特法则只是要求降低类间(对象间)耦合关系，并不是完全没有依赖。</li>
</ol>
<h4 id="7-合成复用原则-Composite-Reuse-Principle"><a href="#7-合成复用原则-Composite-Reuse-Principle" class="headerlink" title="7.合成复用原则(Composite Reuse Principle)"></a>7.合成复用原则(Composite Reuse Principle)</h4><p>基本介绍：</p>
<p>原则是尽量使用合成/聚合的方式，而不是使用继承。 </p>
<p><img src="/images/Java%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/image-20201213192257278.png" alt="image-20201213192257278"></p>
<h4 id="8-设计原则核心思想"><a href="#8-设计原则核心思想" class="headerlink" title="8.设计原则核心思想"></a>8.设计原则核心思想</h4><ol>
<li>找出应用中可能需要变化之处，把它们独立出来，不要和那些不需要变化的代码混在一起。</li>
<li>针对接口编程，而不是针对实现编程。</li>
<li>为了交互对象之间的松耦合设计而努力。</li>
</ol>
<h3 id="类和类之间的关系"><a href="#类和类之间的关系" class="headerlink" title="类和类之间的关系"></a>类和类之间的关系</h3><p>类与类之间的关系：<strong>依赖、泛化(继承)、实现、关联、聚合与组合</strong>。</p>
<h4 id="1-依赖-Dependence"><a href="#1-依赖-Dependence" class="headerlink" title="1.依赖(Dependence)"></a>1.依赖(Dependence)</h4><p>只要是<strong>类中用到了对方</strong>，那么它们之间就存在依赖关系。如果没有对方，连编译都通过不了</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> DesignPattern.uml.dependence;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> coderYang</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2020/12/13 20:19</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">PersonServiceBean</span> </span>&#123;</span><br><span class="line">  <span class="keyword">private</span> PersonDao personDao;      <span class="comment">//类</span></span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">save</span><span class="params">(Person person)</span></span>&#123;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> IDCard <span class="title">getIDCard</span><span class="params">(Integer personid)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">modify</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="comment">//此处违反了迪米特法则</span></span><br><span class="line">    Department department = <span class="keyword">new</span> Department();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Department</span></span>&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">IDCard</span></span>&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span></span>&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">PersonDao</span></span>&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p><img src="/images/Java%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/image-20201213203405516.png" alt="image-20201213203405516"></p>
<p><strong>结论(构成依赖的条件):</strong></p>
<ol>
<li>类中用到了对方</li>
<li>类的成员属性</li>
<li>方法的返回类型</li>
<li>方法接收的参数类型</li>
<li>方法中使用到</li>
</ol>
<h4 id="2-泛化-Generalization"><a href="#2-泛化-Generalization" class="headerlink" title="2.泛化(Generalization)"></a>2.泛化(Generalization)</h4><p>泛化关系实际上就是<strong>继承关系</strong>,他是<strong>依赖关系的特例</strong></p>
<p><img src="/images/Java%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/image-20201213210434581.png" alt="image-20201213210434581"></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> DesignPattern.uml.generalization;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> coderYang</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2020/12/13 20:43</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">DaoSupport</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">save</span><span class="params">(Object entity)</span></span>&#123;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">delete</span><span class="params">(Object id)</span></span>&#123;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">PersonServiceBean</span> <span class="keyword">extends</span> <span class="title">DaoSupport</span></span>&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>









<p>结论:</p>
<ol>
<li>泛化关系实际上就是继承关系.</li>
<li>如果A类继承了B类,我们就说A和B存在泛化关系.</li>
</ol>
<h4 id="3-实现-Implementation"><a href="#3-实现-Implementation" class="headerlink" title="3.实现(Implementation)"></a>3.实现(Implementation)</h4><p>实现关系实际上就是A类实现B类,他就是<strong>依赖关系的特例</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> DesignPattern.uml.implementation;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> coderYang</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2020/12/13 20:56</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">PersonServiceBean</span> <span class="keyword">implements</span> <span class="title">PersonService</span></span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">delete</span><span class="params">(Integer id)</span> </span>&#123;</span><br><span class="line">    System.out.println(<span class="string">"delete.."</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">interface</span> <span class="title">PersonService</span></span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">delete</span><span class="params">(Integer id)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p><img src="/images/Java%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/image-20201213210626944.png" alt="image-20201213210626944"></p>
<h4 id="4-关联-Association"><a href="#4-关联-Association" class="headerlink" title="4.关联(Association)"></a>4.关联(Association)</h4><p>关联关系实际上就是<strong>类与类之间的关系,他是依赖关系的特例</strong></p>
<p>关联关系具有<strong>导航性</strong>：即双向关系或者单项关系</p>
<p>关系具有多重性：如”1”(表示有且只有一个)，”0…”(表示0个或者多个)，”0，1”(表示0个或者一个),”n…m”(表示n到m个都可以)，”m…*”(表示至少m个)。</p>
<p><img src="/images/Java%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/image-20201214090940531.png" alt="image-20201214090940531"></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> DesignPattern.uml.association;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> coderYang</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2020/12/14 9:07</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//单项一对一关系</span></span><br><span class="line"><span class="comment">//public class Person &#123;</span></span><br><span class="line"><span class="comment">//  private IDCard card;</span></span><br><span class="line"><span class="comment">//&#125;</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//class IDCard&#123;</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//&#125;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//单项一对多关系</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Person</span> </span>&#123;</span><br><span class="line">  <span class="keyword">private</span> IDCard card;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">IDCard</span></span>&#123;</span><br><span class="line">  <span class="keyword">private</span> Person person;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>









<h4 id="5-聚合-Aggregation"><a href="#5-聚合-Aggregation" class="headerlink" title="5.聚合(Aggregation)"></a>5.聚合(Aggregation)</h4><p>聚合关系(Aggregation)表示的是<strong>整体和部分的关系</strong>，<strong>整体与部分可以分开</strong>。<strong>聚合关系是关联关系的特例</strong>，所以他具有关联的导航性与多重性。</p>
<p>如：一台电脑由键盘(keyboard)、显示器(monitor)，鼠标等组成；组成电脑的各个配件是可以从电脑上分离出来的，使用带空心菱形的实线来表示：</p>
<p><img src="/images/Java%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/image-20201214092212886.png" alt="image-20201214092212886"></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> DesignPattern.uml.aggregation;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> coderYang</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2020/12/14 9:17</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Computer</span> </span>&#123;</span><br><span class="line">  <span class="keyword">private</span> Mouse mouse;      <span class="comment">//鼠标可以和computer分离</span></span><br><span class="line">  <span class="keyword">private</span> Monitor monitor;    <span class="comment">//显示器可以和computer分离</span></span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setMouse</span><span class="params">(Mouse mouse)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.mouse = mouse;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setMonitor</span><span class="params">(Monitor monitor)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.monitor = monitor;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Mouse</span></span>&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Monitor</span></span>&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>如果我们人，Mouse，Monitor和Computer是不可分离的，则升级为组合关系：</p>
<p>代码如下：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> DesignPattern.uml.aggregation;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> coderYang</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2020/12/14 9:17</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Computer</span> </span>&#123;</span><br><span class="line">  <span class="comment">//如此,耦合关系增强.即为组合关系</span></span><br><span class="line">  <span class="keyword">private</span> Mouse mouse = <span class="keyword">new</span> Mouse();      </span><br><span class="line">  <span class="keyword">private</span> Monitor monitor = <span class="keyword">new</span> Monitor();    </span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setMouse</span><span class="params">(Mouse mouse)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.mouse = mouse;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setMonitor</span><span class="params">(Monitor monitor)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.monitor = monitor;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Mouse</span></span>&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Monitor</span></span>&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>









<h4 id="6-组合-Composition"><a href="#6-组合-Composition" class="headerlink" title="6.组合(Composition)"></a>6.组合(Composition)</h4><p>组合关系：整体与部分的关系，但是<strong>整体与部分不可以分开,</strong>。<strong>组合关系是关联关系的特例</strong></p>
<p><img src="/images/Java%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/image-20201214093134897.png" alt="image-20201214093134897"></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> DesignPattern.uml.composition;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> coderYang</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2020/12/14 9:17</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Computer</span> </span>&#123;</span><br><span class="line">  <span class="keyword">private</span> Mouse mouse = <span class="keyword">new</span> Mouse();      <span class="comment">//鼠标可以和computer不可分离,耦合关系增强</span></span><br><span class="line">  <span class="keyword">private</span> Monitor monitor = <span class="keyword">new</span> Monitor();    <span class="comment">//显示器可以和computer不可分离</span></span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setMouse</span><span class="params">(Mouse mouse)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.mouse = mouse;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setMonitor</span><span class="params">(Monitor monitor)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.monitor = monitor;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Mouse</span></span>&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Monitor</span></span>&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>







<p>第二个案例：在程序中我们定义实体：Person与IDCard、Head，那么Head和Person就是组合，IDCard和Person就是聚合。</p>
<p>但是如果在程序中Person实体中定义了对IDCard进行<strong>级联删除</strong>，即删除Person时连同IDCard一起删除，那么IDCard和Person就是组合了。(只要是同生共死关系就是组合)</p>
<p><img src="/images/Java%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/image-20201214093625178.png" alt="image-20201214093625178"></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> DesignPattern.uml.composition;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> coderYang</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2020/12/14 9:33</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Person</span> </span>&#123;</span><br><span class="line">  <span class="keyword">private</span> IDCard idcard;    <span class="comment">//聚合关系</span></span><br><span class="line">  <span class="keyword">private</span> Head head = <span class="keyword">new</span> Head();     <span class="comment">//组合关系,人不能没有头</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">IDCard</span></span>&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Head</span></span>&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

















<h3 id="设计模式类型"><a href="#设计模式类型" class="headerlink" title="设计模式类型"></a>设计模式类型</h3><p><strong>设计模式分为三种类型，共23钟</strong></p>
<ol>
<li><strong>创建型模式</strong>：<strong>单例模式</strong>、抽象工厂模式、原型模式、建造者模式、<strong>工厂模式</strong>。</li>
<li><strong>结构型模式</strong>：适配器模式、桥接模式、<strong>装饰模式</strong>、组合模式、外观模式、享元模式、<strong>代理模式</strong>。</li>
<li><strong>行为型模式</strong>：模板方法模式、命令模式、访问者模式、迭代器模式、<strong>观察者模式</strong>、中介者模式、备忘录模式、解释器模式(Interpreter模式)、状态模式、策略模式、职责链模式(责任链模式)。</li>
</ol>
<h4 id="1-单例设计模式"><a href="#1-单例设计模式" class="headerlink" title="1.单例设计模式"></a>1.单例设计模式</h4><p>所谓类的单例设计模式，就是采取一定的方法保证在整个软件系统中，对某个类<strong>只能存在一个对象实例</strong>，并且该类只提供一个取得其对象实例的方法(静态方法)。</p>
<p>比如Hibernate的SessionFactory，它充当数据存储源的代理，并负责创建Session对象。SessionFactory并不是轻量级的，一般情况下，一个项目通常只需要一个SessionFactory就够了，这就会使用到单例模式。</p>
<h5 id="单例设计模式八种形式"><a href="#单例设计模式八种形式" class="headerlink" title="单例设计模式八种形式"></a>单例设计模式八种形式</h5><ol>
<li><strong>饿汉式(静态常量)</strong></li>
<li><strong>饿汉式(静态代码块)</strong></li>
<li>懒汉式(线程不安全)</li>
<li>懒汉式(线程安全，同步方法)</li>
<li>懒汉式(线程安全，同步代码块)</li>
<li><strong>双重检查</strong></li>
<li><strong>静态内部类</strong></li>
<li><strong>枚举</strong></li>
</ol>
<h5 id="饿汉式-静态常量"><a href="#饿汉式-静态常量" class="headerlink" title="饿汉式(静态常量)"></a>饿汉式(静态常量)</h5><p>步骤如下：</p>
<ol>
<li>构造器私有化（防止new）</li>
<li>类的内部创建对象</li>
<li>向外暴露一个静态的公共方法</li>
<li>代码实现</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> DesignPattern.singleton.type1;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> coderYang</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2020/12/16 22:30</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SingletonTest01</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    <span class="comment">//测试</span></span><br><span class="line">    Singleton instance = Singleton.getInstance();</span><br><span class="line">    Singleton instance2 = Singleton.getInstance();</span><br><span class="line">    System.out.println(instance == instance2);    <span class="comment">//true</span></span><br><span class="line">    System.out.println(<span class="string">"instance.hashCode="</span>+instance.hashCode());   <span class="comment">//instance.hashCode=1504109395</span></span><br><span class="line">    System.out.println(<span class="string">"instance2.hashCode="</span>+instance2.hashCode());   <span class="comment">//instance2.hashCode=1504109395</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//饿汉式(静态变量)</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Singleton</span></span>&#123;</span><br><span class="line">  <span class="comment">//1.构造器私有化,外部不能new</span></span><br><span class="line">  <span class="function"><span class="keyword">private</span> <span class="title">Singleton</span><span class="params">()</span></span>&#123;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//2.本类内部创建对象实例</span></span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">static</span> Singleton instance = <span class="keyword">new</span> Singleton();</span><br><span class="line"></span><br><span class="line">  <span class="comment">//对外提供一个公有的静态方法,返回实例对象</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Singleton <span class="title">getInstance</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> instance;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<p><strong>优缺点说明：</strong></p>
<ol>
<li><strong>优点</strong>：这种写法比较简单，就是在类装载的时候就完成了实例化。避免了线程同步问题。</li>
<li><strong>缺点</strong>：在类装载的时候就完成实例化，没有达到Lazy Loading的效果。如果从始至终从未使用过这个实例，则会造成内存的浪费。</li>
<li>这种方式基于classloader机制避免了多线程的同步问题，不过，instance在类装载时就实例化，在单例模式中大多数都是调用getInstance方法，但是导致类装载的原因有很多种，因此不能确定有其他的方式(或者其他的静态方法)导致类装载，这时候初始化instance就没有达到<code>lazy loading</code>的效果。</li>
<li>结论：这种单例模式<strong>可用</strong>，<strong>可能</strong>造成内存浪费</li>
</ol>
<h5 id="饿汉式-静态代码块"><a href="#饿汉式-静态代码块" class="headerlink" title="饿汉式(静态代码块)"></a>饿汉式(静态代码块)</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> DesignPattern.singleton.type2;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> coderYang</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2020/12/16 22:30</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SingletonTest02</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    <span class="comment">//测试</span></span><br><span class="line">    Singleton instance = Singleton.getInstance();</span><br><span class="line">    Singleton instance2 = Singleton.getInstance();</span><br><span class="line">    System.out.println(instance == instance2);    <span class="comment">//true</span></span><br><span class="line">    System.out.println(<span class="string">"instance.hashCode="</span>+instance.hashCode());   <span class="comment">//instance.hashCode=1504109395</span></span><br><span class="line">    System.out.println(<span class="string">"instance2.hashCode="</span>+instance2.hashCode());   <span class="comment">//instance2.hashCode=1504109395</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//饿汉式(静态代码块)</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Singleton</span></span>&#123;</span><br><span class="line">  <span class="comment">//1.构造器私有化,外部不能new</span></span><br><span class="line">  <span class="function"><span class="keyword">private</span> <span class="title">Singleton</span><span class="params">()</span></span>&#123;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//2.本类内部创建对象实例</span></span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">static</span> Singleton instance;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">static</span> &#123;  <span class="comment">//在静态代码块中,创建单例对象</span></span><br><span class="line">     instance = <span class="keyword">new</span> Singleton();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//对外提供一个公有的静态方法,返回实例对象</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Singleton <span class="title">getInstance</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> instance;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<p><strong>优缺点说明：</strong></p>
<ol>
<li>这种方式和上面的方式类似，只不过将类实例化的过程放在了静态代码块中，也是在类装载的时候，就执行静态代码块中的代码，初始化类的实例。优缺点上面方法是一样的。</li>
<li>结论：这种单例模式可用，但是可能造成内存浪费。</li>
</ol>
<h5 id="懒汉式-线程不安全"><a href="#懒汉式-线程不安全" class="headerlink" title="懒汉式(线程不安全)"></a>懒汉式(线程不安全)</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> DesignPattern.singleton.type3;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> coderYang</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2020/12/17 10:23</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SingletonTest03</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    System.out.println(<span class="string">"懒汉式1(线程不安全)"</span>);</span><br><span class="line">    Singleton instance = Singleton.getInstance();</span><br><span class="line">    Singleton instance2 = Singleton.getInstance();</span><br><span class="line">    System.out.println(instance == instance2);    <span class="comment">//true</span></span><br><span class="line">    System.out.println(<span class="string">"instance.hashCode="</span>+instance.hashCode());   <span class="comment">//instance.hashCode=1504109395</span></span><br><span class="line">    System.out.println(<span class="string">"instance2.hashCode="</span>+instance2.hashCode());   <span class="comment">//instance2.hashCode=1504109395</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Singleton</span></span>&#123;</span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">static</span> Singleton instance;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//私有构造器</span></span><br><span class="line">  <span class="function"><span class="keyword">private</span> <span class="title">Singleton</span><span class="params">()</span></span>&#123;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//提供一个静态公有方法,当使用到该方法时,才去创建instance</span></span><br><span class="line">  <span class="comment">//即懒汉式</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Singleton <span class="title">getInstance</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(instance == <span class="keyword">null</span>)&#123;</span><br><span class="line">      instance = <span class="keyword">new</span> Singleton();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> instance;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p><strong>优缺点说明：</strong></p>
<ol>
<li>起到了Lazy Loading的效果，但是只能在单线程下使用。</li>
<li>如果在多线程下，一个线程进入了if(singleton == null)判断语句块，还未来得及往下执行，另一个线程也通过了这个判断语句，这时变会产生多个实例。所以在多线程环境下不可使用这种方式。</li>
<li>结论：在实际开发中，不要使用这种方式。</li>
</ol>
<h5 id="懒汉式-线程安全，同步方法"><a href="#懒汉式-线程安全，同步方法" class="headerlink" title="懒汉式(线程安全，同步方法)"></a>懒汉式(线程安全，同步方法)</h5><p>代码演示：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> DesignPattern.singleton.type3;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> coderYang</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2020/12/17 10:23</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SingletonTest03</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    System.out.println(<span class="string">"懒汉式1(线程安全)"</span>);   <span class="comment">//懒汉式1(线程不安全)</span></span><br><span class="line">    Singleton instance = Singleton.getInstance();</span><br><span class="line">    Singleton instance2 = Singleton.getInstance();</span><br><span class="line">    System.out.println(instance == instance2);    <span class="comment">//true</span></span><br><span class="line">    System.out.println(<span class="string">"instance.hashCode="</span>+instance.hashCode());   <span class="comment">//instance.hashCode=1504109395</span></span><br><span class="line">    System.out.println(<span class="string">"instance2.hashCode="</span>+instance2.hashCode());   <span class="comment">//instance2.hashCode=1504109395</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Singleton</span></span>&#123;</span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">static</span> Singleton instance;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//私有构造器</span></span><br><span class="line">  <span class="function"><span class="keyword">private</span> <span class="title">Singleton</span><span class="params">()</span></span>&#123;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//提供一个静态公有方法,当使用到该方法时,才去创建instance</span></span><br><span class="line">  <span class="comment">//即懒汉式</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Singleton <span class="title">getInstance</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(instance == <span class="keyword">null</span>)&#123;</span><br><span class="line">      instance = <span class="keyword">new</span> Singleton();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> instance;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<p><strong>优缺点说明：</strong></p>
<ol>
<li>解决了线程不安全问题。</li>
<li>效率太低了，每个线程在想获得类的实例的时候，执行getInstance()方法都要进行同步。而其实这个方法只执行一次实例化代码就够了，后面想要获得该类实例，直接return就行了。方法进行同步效率太低。</li>
<li>结论：在实际开发中，不推荐使用这种方式。</li>
</ol>
<h5 id="双重检查"><a href="#双重检查" class="headerlink" title="双重检查"></a>双重检查</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> DesignPattern.singleton.type5;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> coderYang</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2020/12/17 10:23</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SingletonTest05</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    System.out.println(<span class="string">"双重检查"</span>);     <span class="comment">//双重检查</span></span><br><span class="line">    Singleton instance = Singleton.getInstance();</span><br><span class="line">    Singleton instance2 = Singleton.getInstance();</span><br><span class="line">    System.out.println(instance == instance2);    <span class="comment">//true</span></span><br><span class="line">    System.out.println(<span class="string">"instance.hashCode="</span>+instance.hashCode());   <span class="comment">//instance.hashCode=1504109395</span></span><br><span class="line">    System.out.println(<span class="string">"instance2.hashCode="</span>+instance2.hashCode());   <span class="comment">//instance2.hashCode=1504109395</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Singleton</span></span>&#123;</span><br><span class="line">  <span class="comment">//volatile 用于将变量标记为“存储于主内存中”,volatile防止指令重排</span></span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">volatile</span> Singleton instance;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//私有构造器</span></span><br><span class="line">  <span class="function"><span class="keyword">private</span> <span class="title">Singleton</span><span class="params">()</span></span>&#123;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//提供一个静态公有方法,加入双重检查代码,解决线程安全问题,同时解决懒加载问题</span></span><br><span class="line">  <span class="comment">//同时保证了效率,推荐使用</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Singleton <span class="title">getInstance</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(instance == <span class="keyword">null</span>)&#123;</span><br><span class="line">      <span class="comment">//同步代码块</span></span><br><span class="line">      <span class="keyword">synchronized</span> (Singleton<span class="class">.<span class="keyword">class</span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(instance == <span class="keyword">null</span>)&#123;</span><br><span class="line">          instance = <span class="keyword">new</span> Singleton();</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> instance;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>对象的创建可能发生指令的重排序，使用 <code>volatile</code> 可以禁止指令的重排序，保证多线程环境内的系统安全。</p>
<p><strong>优缺点说明：</strong></p>
<ol>
<li>Double-Check概念是多线程开发中经常遇到的，如代码中所示，我们进行了两次if(singleton == null)检查，这样就可以保证线程安全了。</li>
<li>这样，实例化代码只用执行一次，后面再次访问时，判断<code>if(singleton == null)</code>，直接retrun实例化对象，也避免了反复进行方法同步。</li>
<li>线程安全：延迟加载(用到的时候再new)；效率极高。</li>
<li>结论：在实际开发中，推荐使用这种单例设计模式。</li>
</ol>
<h5 id="静态内部类"><a href="#静态内部类" class="headerlink" title="静态内部类"></a>静态内部类</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> DesignPattern.singleton.type6;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> coderYang</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2020/12/17 10:23</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SingletonTest06</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    System.out.println(<span class="string">"使用静态内部类完成单例模式"</span>);     <span class="comment">//使用静态内部类完成单例模式</span></span><br><span class="line">    Singleton instance = Singleton.getInstance();</span><br><span class="line">    Singleton instance2 = Singleton.getInstance();</span><br><span class="line">    System.out.println(instance == instance2);    <span class="comment">//true</span></span><br><span class="line">    System.out.println(<span class="string">"instance.hashCode="</span>+instance.hashCode());   <span class="comment">//instance.hashCode=2047526627</span></span><br><span class="line">    System.out.println(<span class="string">"instance2.hashCode="</span>+instance2.hashCode());   <span class="comment">//instance2.hashCode=2047526627</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// 静态内部类完成单例模式,JVM底层装载类是同步的,所以是线程安全的</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Singleton</span></span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//私有构造器</span></span><br><span class="line">  <span class="function"><span class="keyword">private</span> <span class="title">Singleton</span><span class="params">()</span></span>&#123;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//静态内部类,该类中有一个静态属性Singleton,内部类不会在其外部类被加载的同时被加载</span></span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">SingletonInstance</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> Singleton INSTANCE = <span class="keyword">new</span> Singleton();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//提供一个静态公有方法,直接返回SingletonInstance.INSTANCE</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Singleton <span class="title">getInstance</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> SingletonInstance.INSTANCE;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p><strong>优缺点说明：</strong></p>
<ol>
<li>外部类的装载，不会导致内部类的装载。这种方式采用类装载的机制来保证初始化实例时只有一个线程。</li>
<li>静态内部类方式在<code>Singleton</code>类被装载的时候并不会立即实例化，而是在需要实例化时，调用<code>getInstance</code>方法，才会装载<code>SIngletonInstance</code>类，从而完成<code>Singleton</code>的实例化。</li>
<li>类的静态属性只会在第一次加载类的时候初始化，所以在这里，JVM帮助我们保证了线程的安全，在类初始化时，别的线程是无法进入的。</li>
<li>优点：<strong>避免了线程不安全</strong>，利用<strong>静态内部类特点实现延迟加载，效率高</strong>。</li>
<li>结论：推荐使用。</li>
</ol>
<h5 id="枚举"><a href="#枚举" class="headerlink" title="枚举"></a>枚举</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> DesignPattern.singleton.type7;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> coderYang</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2020/12/17 16:14</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SingletonTest07</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    Singleton instance = Singleton.INSTANCE;</span><br><span class="line">    Singleton instance2 = Singleton.INSTANCE;</span><br><span class="line">    System.out.println(instance == instance2);    <span class="comment">//true</span></span><br><span class="line">    System.out.println(instance.hashCode());      <span class="comment">//1504109395</span></span><br><span class="line">    System.out.println(instance2.hashCode());     <span class="comment">//1504109395</span></span><br><span class="line"></span><br><span class="line">    instance.sayOK();   <span class="comment">//OK</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//使用枚举,可以实现单例</span></span><br><span class="line"><span class="keyword">enum</span> Singleton&#123;</span><br><span class="line">  INSTANCE;   <span class="comment">//属性</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">sayOK</span><span class="params">()</span></span>&#123;</span><br><span class="line">    System.out.println(<span class="string">"OK"</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>







<p><strong>优缺点说明：</strong></p>
<ol>
<li>借助JDK1.5添加的枚举来实现单例模式。不仅能避免多线程同步问题，而且还能<strong>防止反序列化重新创建新的对象</strong>。</li>
<li>这种方式是Effective Java作者Josh Bloch提倡的方式。</li>
<li>结论：推荐使用。</li>
</ol>
<h5 id="单例模式在JDK中应用分析"><a href="#单例模式在JDK中应用分析" class="headerlink" title="单例模式在JDK中应用分析"></a>单例模式在JDK中应用分析</h5><p><img src="/images/Java%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/image-20201217163157262.png" alt="image-20201217163157262"></p>
<p><img src="/images/Java%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/image-20201217163219313.png" alt="image-20201217163219313"></p>
<h5 id="单例模式注意事项和细节"><a href="#单例模式注意事项和细节" class="headerlink" title="单例模式注意事项和细节"></a>单例模式注意事项和细节</h5><ol>
<li>单例模式保证了系统内存中该类只存在一个对象，节省了系统资源，对于一些需要频繁创建销毁的对象，使用单例模式可以提高系统性能。</li>
<li>当想实例化一个单例类的时候，必须要记住使用相应的获取对象的方法，而不是使用new</li>
<li>单例模式<strong>使用的场景</strong>：需要<strong>频繁的进行创建和销毁的对象</strong>、创建对象时消耗过多或耗费资源过多(即：<strong>重量级对象</strong>)，但又经常用到的对象、<strong>工具类对象</strong>、频繁访问数据库或文件的对象(比如<strong>数据源</strong>、<strong>session工厂</strong>等)</li>
</ol>
<h4 id="2-工厂设计模式"><a href="#2-工厂设计模式" class="headerlink" title="2.工厂设计模式"></a>2.工厂设计模式</h4><p>需求：</p>
<p>要便于披萨种类的扩展，要便于维护。</p>
<p>1.披萨的种类很多(比如GreekPizz、CheesePizz等)</p>
<p>2.披萨的制作有prepare，bake，cut，box</p>
<p>3.完成披萨店的订购功能。</p>
<h5 id="传统方式"><a href="#传统方式" class="headerlink" title="传统方式"></a>传统方式</h5><p><img src="/images/Java%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/image-20201218140429673.png" alt="image-20201218140429673"></p>
<p><img src="/images/Java%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/image-20201218140826910.png" alt="image-20201218140826910"></p>
<p><code>Pizza.java</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> DesignPattern.factory.simplefactory.pizzastore.pizza;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> coderYang</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2020/12/18 13:24</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="comment">//将Pizza类做成抽象类</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">Pizza</span> </span>&#123;</span><br><span class="line">  <span class="keyword">protected</span> String name;    <span class="comment">//披萨名字</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">//准备原材料,不同的披萨不一样,因此我们做成抽象方法</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">prepare</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">bake</span><span class="params">()</span></span>&#123;</span><br><span class="line">    System.out.println(name+<span class="string">"baking;"</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">cut</span><span class="params">()</span></span>&#123;</span><br><span class="line">    System.out.println(name+<span class="string">"cutting;"</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//打包</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">box</span><span class="params">()</span></span>&#123;</span><br><span class="line">    System.out.println(name+<span class="string">"boxing;"</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.name = name;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p><code>GreekPizza.java</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> DesignPattern.factory.simplefactory.pizzastore.pizza;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> coderYang</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2020/12/18 13:38</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">GreekPizza</span> <span class="keyword">extends</span> <span class="title">Pizza</span></span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">prepare</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    System.out.println(<span class="string">"给希腊披萨准备原材料"</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p><code>CheesePizza.java</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> DesignPattern.factory.simplefactory.pizzastore.pizza;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> coderYang</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2020/12/18 13:38</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CheesePizza</span> <span class="keyword">extends</span> <span class="title">Pizza</span></span>&#123;</span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">prepare</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    System.out.println(<span class="string">"给希腊披萨准备原材料"</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p><code>OrderPizza.java</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> DesignPattern.factory.simplefactory.pizzastore.order;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> DesignPattern.factory.simplefactory.pizzastore.pizza.CheesePizza;</span><br><span class="line"><span class="keyword">import</span> DesignPattern.factory.simplefactory.pizzastore.pizza.GreekPizza;</span><br><span class="line"><span class="keyword">import</span> DesignPattern.factory.simplefactory.pizzastore.pizza.Pizza;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.BufferedReader;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStreamReader;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> coderYang</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2020/12/18 13:31</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">OrderPizza</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//构造器</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="title">OrderPizza</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    Pizza pizza = <span class="keyword">null</span>;</span><br><span class="line">    String orderType;     <span class="comment">//订购披萨的类型</span></span><br><span class="line">    <span class="keyword">do</span>&#123;</span><br><span class="line">      orderType = getType();</span><br><span class="line"></span><br><span class="line">      <span class="keyword">if</span> (orderType.equals(<span class="string">"greek"</span>))&#123;</span><br><span class="line">        pizza = <span class="keyword">new</span> GreekPizza();</span><br><span class="line">        pizza.setName(<span class="string">"希腊披萨"</span>);</span><br><span class="line">      &#125;<span class="keyword">else</span> <span class="keyword">if</span> (orderType.equals(<span class="string">"cheese"</span>))&#123;</span><br><span class="line">        pizza = <span class="keyword">new</span> CheesePizza();</span><br><span class="line">        pizza.setName(<span class="string">"奶酪披萨"</span>);</span><br><span class="line">      &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">//输出披萨制作过程</span></span><br><span class="line">      pizza.prepare();</span><br><span class="line">      pizza.bake();</span><br><span class="line">      pizza.cut();</span><br><span class="line">      pizza.box();</span><br><span class="line">    &#125;<span class="keyword">while</span> (<span class="keyword">true</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//动态获取客户希望订购的披萨种类</span></span><br><span class="line">  <span class="function"><span class="keyword">private</span> String <span class="title">getType</span><span class="params">()</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      BufferedReader strin = <span class="keyword">new</span> BufferedReader(<span class="keyword">new</span> InputStreamReader(System.in));</span><br><span class="line">      System.out.println(<span class="string">"input pizza type:"</span>);</span><br><span class="line">      String str = strin.readLine();</span><br><span class="line">      <span class="keyword">return</span> str;</span><br><span class="line">    &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">      e.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">""</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<p><code>PizzaStore.java</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> DesignPattern.factory.simplefactory.pizzastore.order;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> coderYang</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2020/12/18 13:50</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//相当于一个客户端,发出订购</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">PizzaStore</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">new</span> OrderPizza();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<p><strong>传统方式的优缺点</strong>：</p>
<ol>
<li><p>优点就是比较好理解，简单容易操作。</p>
</li>
<li><p>缺点就是违反了设计模式的OCP原则，即<strong>对扩展开发，对修改关闭</strong>。即当我们给类增加新功能的时候，尽量不修改代码，或者尽可能少修改代码。</p>
</li>
<li><p>比如我们这时要新增加一个Pizaa的种类(Pepper披萨)，我们需要做以下修改。</p>
</li>
</ol>
<p>   <img src="/images/Java%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/image-20201218142221629.png" alt="image-20201218142221629"></p>
<p>   <img src="/images/Java%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/image-20201218142132582.png" alt="image-20201218142132582"></p>
<p>如此一来，代码就会变得及其冗余，耦合性高。</p>
<p><img src="/images/Java%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/image-20201218142535914.png" alt="image-20201218142535914"></p>
<p><strong>改进思路</strong>：</p>
<p><strong>分析</strong>：修改代码可以接受，但是如果我们在其它的地方创建有Pizza的代码，就意味着，也需要修改，而创建Pizza的代码，往往有很多处。</p>
<p><strong>思路</strong>：把创建Pizza对象封装到一个类中，这样我们有新的Pizza种类时，只需要修改该类即可，<strong>其它有创建到Pizza对象的代码就不需要修改了</strong>(<strong>简单工厂模式</strong>)</p>
<h5 id="简单工厂模式"><a href="#简单工厂模式" class="headerlink" title="简单工厂模式"></a>简单工厂模式</h5><p>基本介绍：</p>
<ol>
<li>简单工厂模式是属于创建型模式，是工厂模式的一种。<strong>简单工厂模式是由一个工厂对象决定创建出哪一种产品类的实例</strong>。简单工厂模式是工厂模式家族中最简单实用的模式。</li>
<li>简单工厂模式：定义了一个创建对象的类，由这个类来<strong>封装实例化对象的行为(代码)</strong></li>
<li>在软件开发中，当我们会用到大量的创建某种、某类或某批对象时，就会使用到工厂模式。</li>
</ol>
<p><img src="/images/Java%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/image-20201219124941944.png" alt="image-20201219124941944"></p>
<p><strong>代码如下：</strong></p>
<img src="/images/Java%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/image-20201219110042354.png" alt="image-20201219110042354" style="zoom:80%;" />





<p><strong>order包</strong>：</p>
<p><code>SimpleFactory.java</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> DesignPattern.factory.simplefactory.pizzastore.order;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> DesignPattern.factory.simplefactory.pizzastore.pizza.CheesePizza;</span><br><span class="line"><span class="keyword">import</span> DesignPattern.factory.simplefactory.pizzastore.pizza.GreekPizza;</span><br><span class="line"><span class="keyword">import</span> DesignPattern.factory.simplefactory.pizzastore.pizza.PepperPizza;</span><br><span class="line"><span class="keyword">import</span> DesignPattern.factory.simplefactory.pizzastore.pizza.Pizza;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> coderYang</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2020/12/18 14:46</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//简单工厂类</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SimpleFactory</span> </span>&#123;</span><br><span class="line">  <span class="comment">//根据orderType返回对应的Pizza对象</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> Pizza <span class="title">createPizza</span><span class="params">(String orderType)</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    Pizza pizza = <span class="keyword">null</span>;</span><br><span class="line"></span><br><span class="line">    System.out.println(<span class="string">"使用简单工厂模式"</span>);</span><br><span class="line">    <span class="keyword">if</span> (orderType.equals(<span class="string">"greek"</span>))&#123;</span><br><span class="line">      pizza = <span class="keyword">new</span> GreekPizza();</span><br><span class="line">      pizza.setName(<span class="string">"希腊披萨"</span>);</span><br><span class="line">    &#125;<span class="keyword">else</span> <span class="keyword">if</span> (orderType.equals(<span class="string">"cheese"</span>))&#123;</span><br><span class="line">      pizza = <span class="keyword">new</span> CheesePizza();</span><br><span class="line">      pizza.setName(<span class="string">"奶酪披萨"</span>);</span><br><span class="line">    &#125;<span class="keyword">else</span> <span class="keyword">if</span> (orderType.equals(<span class="string">"pepper"</span>))&#123;</span><br><span class="line">      pizza = <span class="keyword">new</span> PepperPizza();</span><br><span class="line">      pizza.setName(<span class="string">"胡椒披萨"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> pizza;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>







<p><code>OrderPizza.java</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> DesignPattern.factory.simplefactory.pizzastore.order;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> DesignPattern.factory.simplefactory.pizzastore.pizza.Pizza;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.BufferedReader;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStreamReader;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> coderYang</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2020/12/18 13:31</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">OrderPizza</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//定义一个简单工厂对象</span></span><br><span class="line">  SimpleFactory simpleFactory;</span><br><span class="line"></span><br><span class="line">  Pizza pizza = <span class="keyword">null</span>;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//构造器</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="title">OrderPizza</span><span class="params">(SimpleFactory simpleFactory)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.setFactory(simpleFactory);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setFactory</span><span class="params">(SimpleFactory simpleFactory)</span></span>&#123;</span><br><span class="line">    String orderType = <span class="string">""</span>;    <span class="comment">//用户输入的</span></span><br><span class="line">    <span class="keyword">this</span>.simpleFactory = simpleFactory;     <span class="comment">//简单工厂对象</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">do</span> &#123;</span><br><span class="line">      orderType = getType();</span><br><span class="line">      pizza = <span class="keyword">this</span>.simpleFactory.createPizza(orderType);</span><br><span class="line"></span><br><span class="line">      <span class="comment">//输出pizza</span></span><br><span class="line">      <span class="keyword">if</span>(pizza != <span class="keyword">null</span>)&#123;</span><br><span class="line">        pizza.prepare();</span><br><span class="line">        pizza.bake();</span><br><span class="line">        pizza.cut();</span><br><span class="line">        pizza.box();</span><br><span class="line">      &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"订购披萨失败"</span>);</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;<span class="keyword">while</span> (<span class="keyword">true</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//动态获取客户希望订购的披萨种类</span></span><br><span class="line">  <span class="function"><span class="keyword">private</span> String <span class="title">getType</span><span class="params">()</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      BufferedReader strin = <span class="keyword">new</span> BufferedReader(<span class="keyword">new</span> InputStreamReader(System.in));</span><br><span class="line">      System.out.println(<span class="string">"input pizza type:"</span>);</span><br><span class="line">      String str = strin.readLine();</span><br><span class="line">      <span class="keyword">return</span> str;</span><br><span class="line">    &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">      e.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">""</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<p><code>PizzaStore.java</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> DesignPattern.factory.simplefactory.pizzastore.order;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> coderYang</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2020/12/18 13:50</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">  </span><br><span class="line"><span class="comment">//相当于一个客户端,发出订购</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">PizzaStore</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">new</span> OrderPizza(<span class="keyword">new</span> SimpleFactory());</span><br><span class="line">    System.out.println(<span class="string">"程序退出...."</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>







<p><strong>pizza包：</strong></p>
<p><code>Pizza.java</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> DesignPattern.factory.simplefactory.pizzastore.pizza;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> coderYang</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2020/12/18 13:24</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="comment">//将Pizza类做成抽象类</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">Pizza</span> </span>&#123;</span><br><span class="line">  <span class="keyword">protected</span> String name;    <span class="comment">//披萨名字</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">//准备原材料,不同的披萨不一样,因此我们做成抽象方法</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">prepare</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">bake</span><span class="params">()</span></span>&#123;</span><br><span class="line">    System.out.println(name+<span class="string">"baking;"</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">cut</span><span class="params">()</span></span>&#123;</span><br><span class="line">    System.out.println(name+<span class="string">"cutting;"</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//打包</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">box</span><span class="params">()</span></span>&#123;</span><br><span class="line">    System.out.println(name+<span class="string">"boxing;"</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.name = name;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<p><code>CheesePizza.java</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> DesignPattern.factory.simplefactory.pizzastore.pizza;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> coderYang</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2020/12/18 13:38</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CheesePizza</span> <span class="keyword">extends</span> <span class="title">Pizza</span></span>&#123;</span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">prepare</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    System.out.println(<span class="string">"给奶酪披萨准备原材料"</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<p><code>Greek.java</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> DesignPattern.factory.simplefactory.pizzastore.pizza;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> coderYang</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2020/12/18 13:38</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">GreekPizza</span> <span class="keyword">extends</span> <span class="title">Pizza</span></span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">prepare</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    System.out.println(<span class="string">"给希腊披萨准备原材料"</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>















<p><strong>如果把工厂类的<code>createPizza()</code>方法改为静态的，那么就变成了静态工厂方法.</strong></p>
<p><code>SimpleFactory.java</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> DesignPattern.factory.simplefactory.pizzastore.order;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> DesignPattern.factory.simplefactory.pizzastore.pizza.CheesePizza;</span><br><span class="line"><span class="keyword">import</span> DesignPattern.factory.simplefactory.pizzastore.pizza.GreekPizza;</span><br><span class="line"><span class="keyword">import</span> DesignPattern.factory.simplefactory.pizzastore.pizza.PepperPizza;</span><br><span class="line"><span class="keyword">import</span> DesignPattern.factory.simplefactory.pizzastore.pizza.Pizza;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> coderYang</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2020/12/18 14:46</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//简单工厂类</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SimpleFactory</span> </span>&#123;</span><br><span class="line">  <span class="comment">//根据orderType返回对应的Pizza对象</span></span><br><span class="line"><span class="comment">//  public Pizza createPizza(String orderType)&#123;</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//    Pizza pizza = null;</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//    System.out.println("使用简单工厂模式");</span></span><br><span class="line"><span class="comment">//    if (orderType.equals("greek"))&#123;</span></span><br><span class="line"><span class="comment">//      pizza = new GreekPizza();</span></span><br><span class="line"><span class="comment">//      pizza.setName("希腊披萨");</span></span><br><span class="line"><span class="comment">//    &#125;else if (orderType.equals("cheese"))&#123;</span></span><br><span class="line"><span class="comment">//      pizza = new CheesePizza();</span></span><br><span class="line"><span class="comment">//      pizza.setName("奶酪披萨");</span></span><br><span class="line"><span class="comment">//    &#125;else if (orderType.equals("pepper"))&#123;</span></span><br><span class="line"><span class="comment">//      pizza = new PepperPizza();</span></span><br><span class="line"><span class="comment">//      pizza.setName("胡椒披萨");</span></span><br><span class="line"><span class="comment">//    &#125;</span></span><br><span class="line"><span class="comment">//    return pizza;</span></span><br><span class="line"><span class="comment">//  &#125;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  <span class="comment">//静态工厂模式</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Pizza <span class="title">createPizza2</span><span class="params">(String orderType)</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    Pizza pizza = <span class="keyword">null</span>;</span><br><span class="line"></span><br><span class="line">    System.out.println(<span class="string">"使用简单工厂模式"</span>);</span><br><span class="line">    <span class="keyword">if</span> (orderType.equals(<span class="string">"greek"</span>))&#123;</span><br><span class="line">      pizza = <span class="keyword">new</span> GreekPizza();</span><br><span class="line">      pizza.setName(<span class="string">"希腊披萨"</span>);</span><br><span class="line">    &#125;<span class="keyword">else</span> <span class="keyword">if</span> (orderType.equals(<span class="string">"cheese"</span>))&#123;</span><br><span class="line">      pizza = <span class="keyword">new</span> CheesePizza();</span><br><span class="line">      pizza.setName(<span class="string">"奶酪披萨"</span>);</span><br><span class="line">    &#125;<span class="keyword">else</span> <span class="keyword">if</span> (orderType.equals(<span class="string">"pepper"</span>))&#123;</span><br><span class="line">      pizza = <span class="keyword">new</span> PepperPizza();</span><br><span class="line">      pizza.setName(<span class="string">"胡椒披萨"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> pizza;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<p><code>OrderPizza2.java</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> DesignPattern.factory.simplefactory.pizzastore.order;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> DesignPattern.factory.simplefactory.pizzastore.pizza.Pizza;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.BufferedReader;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStreamReader;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> coderYang</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2020/12/19 11:14</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">OrderPizza2</span> </span>&#123;</span><br><span class="line">  Pizza pizza;</span><br><span class="line">  String orderType = <span class="string">""</span>;    <span class="comment">//接收用户输入</span></span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="title">OrderPizza2</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">do</span> &#123;</span><br><span class="line">      orderType = <span class="keyword">this</span>.getType();</span><br><span class="line">      pizza = SimpleFactory.createPizza2(orderType);</span><br><span class="line"></span><br><span class="line">      <span class="comment">//输出pizza</span></span><br><span class="line">      <span class="keyword">if</span>(pizza != <span class="keyword">null</span>)&#123;</span><br><span class="line">        pizza.prepare();</span><br><span class="line">        pizza.bake();</span><br><span class="line">        pizza.cut();</span><br><span class="line">        pizza.box();</span><br><span class="line">      &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"订购披萨失败"</span>);</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;<span class="keyword">while</span> (<span class="keyword">true</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  <span class="comment">//动态获取客户希望订购的披萨种类</span></span><br><span class="line">  <span class="function"><span class="keyword">private</span> String <span class="title">getType</span><span class="params">()</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      BufferedReader strin = <span class="keyword">new</span> BufferedReader(<span class="keyword">new</span> InputStreamReader(System.in));</span><br><span class="line">      System.out.println(<span class="string">"input pizza type:"</span>);</span><br><span class="line">      String str = strin.readLine();</span><br><span class="line">      <span class="keyword">return</span> str;</span><br><span class="line">    &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">      e.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">""</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<p><code>PizzaStore.java</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> DesignPattern.factory.simplefactory.pizzastore.order;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> coderYang</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2020/12/18 13:50</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//相当于一个客户端,发出订购</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">PizzaStore</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line"><span class="comment">//    new OrderPizza(new SimpleFactory());</span></span><br><span class="line"><span class="comment">//    System.out.println("程序退出....");</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//静态工厂</span></span><br><span class="line">    <span class="keyword">new</span> OrderPizza2();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



















<h5 id="工厂方法模式"><a href="#工厂方法模式" class="headerlink" title="工厂方法模式"></a>工厂方法模式</h5><p><strong>新需求：</strong></p>
<p>披萨项目新的需求：客户在点披萨时，可以点击不同口味的披萨，比如北京的奶酪pizza、北京的胡椒pizza或者是伦敦的奶酪pizza、伦敦的胡椒pizza。</p>
<ul>
<li>思路一：使用简单工厂模式，创建不同的简单工厂类，比如<code>BJPizzaSimpleFactory、LDPizzaSimpleFactory</code>等等。从这个案例来说，也是可以的，但是考虑到项目的规模，以及软件的可维护性、可扩展性并不是特别好。</li>
<li>思路二：使用工厂方法模式。</li>
</ul>
<p><strong>工厂方法模式介绍</strong></p>
<p><strong>工厂方法模式设计方案</strong>：将披萨项目的实例化功能抽象成抽象方法，在不同的口味点餐子类中具体实现。</p>
<p><strong>工厂方法模式</strong>：<strong>定义了一个创建对象的抽象方法</strong>，由<strong>子类决定要实例化的类</strong>。工厂方法模式将<strong>对象的实例化推迟到子类</strong>。</p>
<p><img src="/images/Java%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/image-20201219155138394.png" alt="image-20201219155138394"></p>
<p><strong>项目目录</strong>：</p>
<p><img src="/images/Java%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/image-20201219154825085.png" alt="image-20201219154825085"></p>
<p><strong>Pizza包</strong>：</p>
<p><code>Pizza.java</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> DesignPattern.factory.factorymethod.pizzastore.pizza;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> coderYang</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2020/12/18 13:24</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="comment">//将Pizza类做成抽象类</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">Pizza</span> </span>&#123;</span><br><span class="line">  <span class="keyword">protected</span> String name;    <span class="comment">//披萨名字</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">//准备原材料,不同的披萨不一样,因此我们做成抽象方法</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">prepare</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">bake</span><span class="params">()</span></span>&#123;</span><br><span class="line">    System.out.println(name+<span class="string">"baking;"</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">cut</span><span class="params">()</span></span>&#123;</span><br><span class="line">    System.out.println(name+<span class="string">"cutting;"</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//打包</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">box</span><span class="params">()</span></span>&#123;</span><br><span class="line">    System.out.println(name+<span class="string">"boxing;"</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.name = name;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<p><code>BJCheesePizza.java</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> DesignPattern.factory.factorymethod.pizzastore.pizza;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> coderYang</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2020/12/18 13:38</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">BJCheesePizza</span> <span class="keyword">extends</span> <span class="title">Pizza</span> </span>&#123;</span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">prepare</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    setName(<span class="string">"北京奶酪披萨"</span>);</span><br><span class="line">    System.out.println(<span class="string">"北京奶酪披萨 准备原材料"</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<p><code>BJPepperPizza.java</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> DesignPattern.factory.factorymethod.pizzastore.pizza;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> coderYang</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2020/12/18 13:38</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">BJCheesePizza</span> <span class="keyword">extends</span> <span class="title">Pizza</span> </span>&#123;</span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">prepare</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    setName(<span class="string">"北京奶酪披萨"</span>);</span><br><span class="line">    System.out.println(<span class="string">"北京奶酪披萨 准备原材料"</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<p><code>LDCheesePizza.java</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> DesignPattern.factory.factorymethod.pizzastore.pizza;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> coderYang</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2020/12/18 13:38</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">LDCheesePizza</span> <span class="keyword">extends</span> <span class="title">Pizza</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">prepare</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    System.out.println(<span class="string">"伦敦胡椒披萨 准备原材料"</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<p><code>LDPepperPizza.java</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> DesignPattern.factory.factorymethod.pizzastore.pizza;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> coderYang</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2020/12/19 13:17</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">LDPepperPizza</span> <span class="keyword">extends</span> <span class="title">Pizza</span></span>&#123;</span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">prepare</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    System.out.println(<span class="string">"伦敦胡椒披萨 准备原材料"</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>







<p><strong>order包</strong>：</p>
<p><code>OrderPizza.java</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> DesignPattern.factory.factorymethod.pizzastore.order;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> DesignPattern.factory.factorymethod.pizzastore.pizza.Pizza;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.BufferedReader;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStreamReader;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> coderYang</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2020/12/19 11:14</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">OrderPizza</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  Pizza pizza;</span><br><span class="line">  String orderType;    <span class="comment">//接受用户输入</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">//定义一个抽象方法,createPizza,让各个工厂子类自己实现</span></span><br><span class="line">  <span class="function"><span class="keyword">abstract</span> Pizza <span class="title">createPizza</span><span class="params">(String orderType)</span></span>;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//构造器</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="title">OrderPizza</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">do</span> &#123;</span><br><span class="line">      orderType = <span class="keyword">this</span>.getType();</span><br><span class="line">      pizza = createPizza(orderType);   <span class="comment">//抽象方法,由工厂子类完成</span></span><br><span class="line"></span><br><span class="line">      <span class="comment">//输出pizza</span></span><br><span class="line">      <span class="keyword">if</span>(pizza != <span class="keyword">null</span>)&#123;</span><br><span class="line">        pizza.prepare();</span><br><span class="line">        pizza.bake();</span><br><span class="line">        pizza.cut();</span><br><span class="line">        pizza.box();</span><br><span class="line">      &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"订购披萨失败"</span>);</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;<span class="keyword">while</span> (<span class="keyword">true</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  <span class="comment">//动态获取客户希望订购的披萨种类</span></span><br><span class="line">  <span class="function"><span class="keyword">private</span> String <span class="title">getType</span><span class="params">()</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      BufferedReader strin = <span class="keyword">new</span> BufferedReader(<span class="keyword">new</span> InputStreamReader(System.in));</span><br><span class="line">      System.out.println(<span class="string">"input pizza type:"</span>);</span><br><span class="line">      String str = strin.readLine();</span><br><span class="line">      <span class="keyword">return</span> str;</span><br><span class="line">    &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">      e.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">""</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<p><code>BJOrderPizza.java</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> DesignPattern.factory.factorymethod.pizzastore.order;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> DesignPattern.factory.factorymethod.pizzastore.pizza.BJCheesePizza;</span><br><span class="line"><span class="keyword">import</span> DesignPattern.factory.factorymethod.pizzastore.pizza.BJPepperPizza;</span><br><span class="line"><span class="keyword">import</span> DesignPattern.factory.factorymethod.pizzastore.pizza.Pizza;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> coderYang</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2020/12/19 13:38</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">BJOrderPizza</span> <span class="keyword">extends</span> <span class="title">OrderPizza</span></span>&#123;</span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="function">Pizza <span class="title">createPizza</span><span class="params">(String orderType)</span> </span>&#123;</span><br><span class="line">    Pizza pizza = <span class="keyword">null</span>;</span><br><span class="line">    <span class="keyword">if</span>(<span class="string">"cheese"</span>.equals(orderType))&#123;</span><br><span class="line">      pizza = <span class="keyword">new</span> BJCheesePizza();</span><br><span class="line">      pizza.setName(<span class="string">"北京奶酪披萨"</span>);</span><br><span class="line">    &#125;<span class="keyword">else</span> <span class="keyword">if</span>(<span class="string">"pepper"</span>.equals(orderType))&#123;</span><br><span class="line">      pizza = <span class="keyword">new</span> BJPepperPizza();</span><br><span class="line">      pizza.setName(<span class="string">"北京胡椒披萨"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> pizza;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<p><code>LDOrderPizza.java</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> DesignPattern.factory.factorymethod.pizzastore.order;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> DesignPattern.factory.factorymethod.pizzastore.pizza.LDCheesePizza;</span><br><span class="line"><span class="keyword">import</span> DesignPattern.factory.factorymethod.pizzastore.pizza.LDPepperPizza;</span><br><span class="line"><span class="keyword">import</span> DesignPattern.factory.factorymethod.pizzastore.pizza.Pizza;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> coderYang</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2020/12/19 13:58</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">LDOrderPizza</span> <span class="keyword">extends</span> <span class="title">OrderPizza</span></span>&#123;</span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="function">Pizza <span class="title">createPizza</span><span class="params">(String orderType)</span> </span>&#123;</span><br><span class="line">    Pizza pizza = <span class="keyword">null</span>;</span><br><span class="line">    <span class="keyword">if</span>(<span class="string">"cheese"</span>.equals(orderType))&#123;</span><br><span class="line">      pizza = <span class="keyword">new</span> LDCheesePizza();</span><br><span class="line">      pizza.setName(<span class="string">"伦敦奶酪披萨"</span>);</span><br><span class="line">    &#125;<span class="keyword">else</span> <span class="keyword">if</span>(<span class="string">"pepper"</span>.equals(orderType))&#123;</span><br><span class="line">      pizza = <span class="keyword">new</span> LDPepperPizza();</span><br><span class="line">      pizza.setName(<span class="string">"伦敦胡椒披萨"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> pizza;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>







<p><code>PizzaStore.java</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> DesignPattern.factory.factorymethod.pizzastore.order;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> coderYang</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2020/12/19 14:06</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">PizzaStore</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    <span class="comment">//订购北京口味的pizza</span></span><br><span class="line"><span class="comment">//    new BJOrderPizza();</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//订购伦敦口味的pizza</span></span><br><span class="line">    <span class="keyword">new</span> LDOrderPizza();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>















<h5 id="抽象工厂模式"><a href="#抽象工厂模式" class="headerlink" title="抽象工厂模式"></a>抽象工厂模式</h5><p>基本介绍：</p>
<ol>
<li>抽象工厂模式：定义了一个<strong>interface</strong>用于创建相关或有依赖关系的对象簇，而<strong>无需指明具体的类</strong>。</li>
<li>抽象工厂模式可以将<strong>简单工厂模式</strong>和<strong>工厂方法模式</strong>进行整合。</li>
<li>从设计层面看，抽象工厂模式就是对简单工厂模式的改进(或者称为进一步的抽象)。</li>
<li>将工厂抽象成两层，AbsFactory(抽象工厂)和具体实现的工厂子类。程序员可以根据创建的对象类型使用对应的工厂子类。这样将单个的简单工厂类变成了<strong>工厂簇</strong>，更利于代码的维护和扩展。</li>
</ol>
<p><img src="/images/Java%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/image-20201219163155758.png" alt="image-20201219163155758"></p>
<p><strong>项目目录：</strong></p>
<p><img src="/images/Java%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/image-20201220105029597.png" alt="image-20201220105029597"></p>
<p><strong>pizza包：</strong></p>
<p><code>Pizza.java</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> DesignPattern.factory.absfactory.pizzastore.pizza;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> coderYang</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2020/12/18 13:24</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="comment">//将Pizza类做成抽象类</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">Pizza</span> </span>&#123;</span><br><span class="line">  <span class="keyword">protected</span> String name;    <span class="comment">//披萨名字</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">//准备原材料,不同的披萨不一样,因此我们做成抽象方法</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">prepare</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">bake</span><span class="params">()</span></span>&#123;</span><br><span class="line">    System.out.println(name+<span class="string">"baking;"</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">cut</span><span class="params">()</span></span>&#123;</span><br><span class="line">    System.out.println(name+<span class="string">"cutting;"</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//打包</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">box</span><span class="params">()</span></span>&#123;</span><br><span class="line">    System.out.println(name+<span class="string">"boxing;"</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.name = name;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<p><code>BJCheesePizza.java</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> DesignPattern.factory.absfactory.pizzastore.pizza;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> coderYang</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2020/12/18 13:38</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">BJCheesePizza</span> <span class="keyword">extends</span> <span class="title">Pizza</span> </span>&#123;</span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">prepare</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    setName(<span class="string">"北京奶酪披萨"</span>);</span><br><span class="line">    System.out.println(<span class="string">"北京奶酪披萨 准备原材料"</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<p><code>BJPepperPizza.java</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> DesignPattern.factory.absfactory.pizzastore.pizza;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> coderYang</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2020/12/18 14:18</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">BJPepperPizza</span> <span class="keyword">extends</span> <span class="title">Pizza</span> </span>&#123;</span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">prepare</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    System.out.println(<span class="string">"北京胡椒披萨 准备原材料"</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<p><code>LDCheesePizza.java</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> DesignPattern.factory.absfactory.pizzastore.pizza;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> coderYang</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2020/12/18 13:38</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">LDCheesePizza</span> <span class="keyword">extends</span> <span class="title">Pizza</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">prepare</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    System.out.println(<span class="string">"伦敦奶酪披萨 准备原材料"</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<p><code>LDPepperPizza.java</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> DesignPattern.factory.absfactory.pizzastore.pizza;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> coderYang</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2020/12/19 13:17</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">LDPepperPizza</span> <span class="keyword">extends</span> <span class="title">Pizza</span> </span>&#123;</span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">prepare</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    System.out.println(<span class="string">"伦敦胡椒披萨 准备原材料"</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>











<p><strong>order包：</strong></p>
<p><code>AbsFactory.java</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> DesignPattern.factory.absfactory.pizzastore.order;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> DesignPattern.factory.absfactory.pizzastore.pizza.Pizza;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> coderYang</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2020/12/19 16:51</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//一个抽象工厂模式的抽象层(接口)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">AbsFactory</span> </span>&#123;</span><br><span class="line">  <span class="comment">//让下面的工厂子类来具体实现</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> Pizza <span class="title">createPizza</span><span class="params">(String orderType)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>







<p><code>BJFactory.java</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> DesignPattern.factory.absfactory.pizzastore.order;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> DesignPattern.factory.absfactory.pizzastore.pizza.BJCheesePizza;</span><br><span class="line"><span class="keyword">import</span> DesignPattern.factory.absfactory.pizzastore.pizza.BJPepperPizza;</span><br><span class="line"><span class="keyword">import</span> DesignPattern.factory.absfactory.pizzastore.pizza.Pizza;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> coderYang</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2020/12/19 16:53</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">BJFactory</span> <span class="keyword">implements</span> <span class="title">AbsFactory</span></span>&#123;</span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> Pizza <span class="title">createPizza</span><span class="params">(String orderType)</span> </span>&#123;</span><br><span class="line">    System.out.println(<span class="string">"抽象工厂模式"</span>);</span><br><span class="line">    Pizza pizza = <span class="keyword">null</span>;</span><br><span class="line">    <span class="keyword">if</span> (<span class="string">"cheese"</span>.equals(orderType))&#123;</span><br><span class="line">      pizza = <span class="keyword">new</span> BJCheesePizza();</span><br><span class="line">      pizza.setName(<span class="string">"北京奶酪披萨"</span>);</span><br><span class="line">    &#125;<span class="keyword">else</span> <span class="keyword">if</span> (<span class="string">"pepper"</span>.equals(orderType))&#123;</span><br><span class="line">      pizza = <span class="keyword">new</span> BJPepperPizza();</span><br><span class="line">      pizza.setName(<span class="string">"北京胡椒披萨"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> pizza;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>







<p><code>LDFactory.java</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> DesignPattern.factory.absfactory.pizzastore.order;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> DesignPattern.factory.absfactory.pizzastore.pizza.*;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> coderYang</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2020/12/19 16:57</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">LDFactory</span> <span class="keyword">implements</span> <span class="title">AbsFactory</span></span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> Pizza <span class="title">createPizza</span><span class="params">(String orderType)</span> </span>&#123;</span><br><span class="line">    System.out.println(<span class="string">"抽象工厂模式"</span>);</span><br><span class="line">    Pizza pizza = <span class="keyword">null</span>;</span><br><span class="line">    <span class="keyword">if</span> (<span class="string">"cheese"</span>.equals(orderType))&#123;</span><br><span class="line">      pizza = <span class="keyword">new</span> LDCheesePizza();</span><br><span class="line">      pizza.setName(<span class="string">"伦敦奶酪披萨"</span>);</span><br><span class="line">    &#125;<span class="keyword">else</span> <span class="keyword">if</span> (<span class="string">"pepper"</span>.equals(orderType))&#123;</span><br><span class="line">      pizza = <span class="keyword">new</span> LDPepperPizza();</span><br><span class="line">      pizza.setName(<span class="string">"伦敦胡椒披萨"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> pizza;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>







<p><code>OrderPizza.java</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> DesignPattern.factory.absfactory.pizzastore.order;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> DesignPattern.factory.absfactory.pizzastore.pizza.Pizza;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.BufferedReader;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStreamReader;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> coderYang</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2020/12/19 16:59</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">OrderPizza</span> </span>&#123;</span><br><span class="line">  AbsFactory factory;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//构造器</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="title">OrderPizza</span><span class="params">(AbsFactory factory)</span></span>&#123;</span><br><span class="line">    setFactory(factory);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">setFactory</span><span class="params">(AbsFactory factory)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.factory = factory;</span><br><span class="line">    Pizza pizza = <span class="keyword">null</span>;</span><br><span class="line">    String orderType;     <span class="comment">//用户输入</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">do</span> &#123;</span><br><span class="line">      orderType = getType();</span><br><span class="line">      <span class="comment">//factory可能是北京的工厂子类,也可能是伦敦的工厂子类</span></span><br><span class="line">      pizza = factory.createPizza(orderType);</span><br><span class="line">      <span class="keyword">if</span> (pizza != <span class="keyword">null</span>)&#123;</span><br><span class="line">        pizza.prepare();</span><br><span class="line">        pizza.bake();</span><br><span class="line">        pizza.cut();</span><br><span class="line">        pizza.box();</span><br><span class="line">      &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">"订购失败"</span>);</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;<span class="keyword">while</span> (<span class="keyword">true</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  <span class="comment">//动态获取客户希望订购的披萨种类</span></span><br><span class="line">  <span class="function"><span class="keyword">private</span> String <span class="title">getType</span><span class="params">()</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      BufferedReader strin = <span class="keyword">new</span> BufferedReader(<span class="keyword">new</span> InputStreamReader(System.in));</span><br><span class="line">      System.out.println(<span class="string">"input pizza type:"</span>);</span><br><span class="line">      String str = strin.readLine();</span><br><span class="line">      <span class="keyword">return</span> str;</span><br><span class="line">    &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">      e.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">""</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<p><code>PizzaStore.java</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> DesignPattern.factory.absfactory.pizzastore.order;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> coderYang</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2020/12/19 17:09</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">PizzaStore</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    <span class="comment">//订购北京的披萨</span></span><br><span class="line"><span class="comment">//    new OrderPizza(new BJFactory());</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//订购伦敦的披萨</span></span><br><span class="line">    <span class="keyword">new</span> OrderPizza(<span class="keyword">new</span> LDFactory());</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>













<h5 id="JDK中的简单工厂模式"><a href="#JDK中的简单工厂模式" class="headerlink" title="JDK中的简单工厂模式"></a>JDK中的简单工厂模式</h5><p>JDK在Calendar类中，就是用了简单工厂模式。</p>
<p><img src="/images/Java%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/image-20201220125441399.png" alt="image-20201220125441399"></p>
<p><img src="/images/Java%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/image-20201220125857350.png" alt="image-20201220125857350"></p>
<p><img src="/images/Java%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/image-20201220130022358.png" alt="image-20201220130022358"></p>
<p><img src="/images/Java%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/image-20201220130038232.png" alt="image-20201220130038232"></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">static</span> Calendar <span class="title">createCalendar</span><span class="params">(TimeZone zone,</span></span></span><br><span class="line"><span class="function"><span class="params">                                       Locale aLocale)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    CalendarProvider provider =</span><br><span class="line">        LocaleProviderAdapter.getAdapter(CalendarProvider<span class="class">.<span class="keyword">class</span>, <span class="title">aLocale</span>)</span></span><br><span class="line"><span class="class">                             .<span class="title">getCalendarProvider</span>()</span>;</span><br><span class="line">    <span class="keyword">if</span> (provider != <span class="keyword">null</span>) &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> provider.getInstance(zone, aLocale);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IllegalArgumentException iae) &#123;</span><br><span class="line">            <span class="comment">// fall back to the default instantiation</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    Calendar cal = <span class="keyword">null</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (aLocale.hasExtensions()) &#123;</span><br><span class="line">        String caltype = aLocale.getUnicodeLocaleType(<span class="string">"ca"</span>);</span><br><span class="line">        <span class="keyword">if</span> (caltype != <span class="keyword">null</span>) &#123;</span><br><span class="line">            <span class="keyword">switch</span> (caltype) &#123;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">"buddhist"</span>:</span><br><span class="line">            cal = <span class="keyword">new</span> BuddhistCalendar(zone, aLocale);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">"japanese"</span>:</span><br><span class="line">                cal = <span class="keyword">new</span> JapaneseImperialCalendar(zone, aLocale);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">"gregory"</span>:</span><br><span class="line">                cal = <span class="keyword">new</span> GregorianCalendar(zone, aLocale);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (cal == <span class="keyword">null</span>) &#123;</span><br><span class="line">        <span class="comment">// If no known calendar type is explicitly specified,</span></span><br><span class="line">        <span class="comment">// perform the traditional way to create a Calendar:</span></span><br><span class="line">        <span class="comment">// create a BuddhistCalendar for th_TH locale,</span></span><br><span class="line">        <span class="comment">// a JapaneseImperialCalendar for ja_JP_JP locale, or</span></span><br><span class="line">        <span class="comment">// a GregorianCalendar for any other locales.</span></span><br><span class="line">        <span class="comment">// <span class="doctag">NOTE:</span> The language, country and variant strings are interned.</span></span><br><span class="line">        <span class="keyword">if</span> (aLocale.getLanguage() == <span class="string">"th"</span> &amp;&amp; aLocale.getCountry() == <span class="string">"TH"</span>) &#123;</span><br><span class="line">            cal = <span class="keyword">new</span> BuddhistCalendar(zone, aLocale);</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (aLocale.getVariant() == <span class="string">"JP"</span> &amp;&amp; aLocale.getLanguage() == <span class="string">"ja"</span></span><br><span class="line">                   &amp;&amp; aLocale.getCountry() == <span class="string">"JP"</span>) &#123;</span><br><span class="line">            cal = <span class="keyword">new</span> JapaneseImperialCalendar(zone, aLocale);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            cal = <span class="keyword">new</span> GregorianCalendar(zone, aLocale);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> cal;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>













<h5 id="工厂模式总结"><a href="#工厂模式总结" class="headerlink" title="工厂模式总结"></a>工厂模式总结</h5><ol>
<li>工厂模式的意义：将实例化对象的代码提取出来，放到一个类中统一管理和维护，达到和主项目的依赖关系的解耦。从而提高项目的扩展性和维护性。</li>
<li>三种工厂模式(简单工厂模式、工厂方法模式、抽象工厂模式)。</li>
<li>设计模式的<strong>依赖抽象</strong>原则。</li>
</ol>
<ul>
<li>创建实例对象时，不要直接new类，而是把这个new类的当作放在一个工厂的方法中，并返回。变量不要直接持有具体类的引用。</li>
<li>不要让类继承具体类，而是继承抽象或者是实现interface(接口)</li>
<li>不要覆盖基类中已经实现的方法。</li>
</ul>
<h4 id="3-原型模式"><a href="#3-原型模式" class="headerlink" title="3.原型模式"></a>3.原型模式</h4><p>克隆羊问题：</p>
<p>​    现有一只羊tom，姓名为:tom，年龄为:1，颜色为：白色，请编写程序创建和tom羊属性完全相同的十只羊。</p>
<h5 id="传统的方式解决克隆羊问题"><a href="#传统的方式解决克隆羊问题" class="headerlink" title="传统的方式解决克隆羊问题"></a>传统的方式解决克隆羊问题</h5><p><img src="/images/Java%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/image-20201221155858413.png" alt="image-20201221155858413"></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> DesignPattern.prototype;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.Iterator;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> coderYang</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2020/12/21 16:01</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Client</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    Sheep sheep = <span class="keyword">new</span> Sheep(<span class="string">"tom"</span>,<span class="number">1</span>,<span class="string">"white"</span>);</span><br><span class="line">    System.out.println(sheep);</span><br><span class="line">    <span class="keyword">int</span> i = <span class="number">1</span>;</span><br><span class="line">    List&lt;Sheep&gt; sheepList = <span class="keyword">new</span> ArrayList&lt;Sheep&gt;();</span><br><span class="line">    <span class="comment">//创建十头羊</span></span><br><span class="line">    <span class="keyword">while</span> (i&lt;=<span class="number">10</span>)&#123;</span><br><span class="line">      Sheep sheep1 = <span class="keyword">new</span> Sheep(sheep.getName(),sheep.getAge(),sheep.getColor());</span><br><span class="line">      sheepList.add(sheep1);</span><br><span class="line">      ++i;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//创建迭代器对象</span></span><br><span class="line">    Iterator iterator = sheepList.iterator();</span><br><span class="line">    <span class="keyword">int</span> j = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (iterator.hasNext())&#123;</span><br><span class="line">      Object obj = iterator.next();</span><br><span class="line">      System.out.println(<span class="string">"sheep"</span>+ ++j +<span class="string">"="</span>+obj);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">Sheep&#123;name='tom', age=1, color='white'&#125;</span></span><br><span class="line"><span class="comment">sheep1=Sheep&#123;name='tom', age=1, color='white'&#125;</span></span><br><span class="line"><span class="comment">sheep2=Sheep&#123;name='tom', age=1, color='white'&#125;</span></span><br><span class="line"><span class="comment">sheep3=Sheep&#123;name='tom', age=1, color='white'&#125;</span></span><br><span class="line"><span class="comment">sheep4=Sheep&#123;name='tom', age=1, color='white'&#125;</span></span><br><span class="line"><span class="comment">sheep5=Sheep&#123;name='tom', age=1, color='white'&#125;</span></span><br><span class="line"><span class="comment">sheep6=Sheep&#123;name='tom', age=1, color='white'&#125;</span></span><br><span class="line"><span class="comment">sheep7=Sheep&#123;name='tom', age=1, color='white'&#125;</span></span><br><span class="line"><span class="comment">sheep8=Sheep&#123;name='tom', age=1, color='white'&#125;</span></span><br><span class="line"><span class="comment">sheep9=Sheep&#123;name='tom', age=1, color='white'&#125;</span></span><br><span class="line"><span class="comment">sheep10=Sheep&#123;name='tom', age=1, color='white'&#125;</span></span><br><span class="line"><span class="comment"> */</span></span><br></pre></td></tr></table></figure>







<p><strong>传统方式的优缺点</strong></p>
<ol>
<li><p>优点就是比较好理解，简单易操作。</p>
</li>
<li><p>在创建对象时，总是需要重新获取原始对象的属性，如果创建的对象比较复杂时，效率较低。</p>
</li>
<li><p>总是需要重新初始化对象，而不是动态的获取对象运行时的状态，不够灵活。改进思路：原型模式。</p>
</li>
</ol>
<p><strong>原型模式基本介绍</strong></p>
<ol>
<li>原型模式(Prototype模式)是指：<strong>用原型实例指定创建对象的种类</strong>，并通过拷贝这些原型，创建新的对象。</li>
<li>原型模式是一种<strong>创建型模式</strong>，允许一个对象再创建另外一个可定制的对象，无需知道如何创建的细节。</li>
<li>工作原理是：通过将一个原型对象传给那个要发动创建的对象，这个要发动创建的对象通过请求原型对象拷贝它们来实施创建，即：<code>对象.clone()</code></li>
<li>形象的理解：孙大圣拔出猴毛，变出其它孙大圣。 </li>
</ol>
<p><img src="/images/Java%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/image-20201221170047766.png" alt="image-20201221170047766"></p>
<p>ConcretePrototype1和2就是复制出来的对象。</p>
<h5 id="改进-原型模式"><a href="#改进-原型模式" class="headerlink" title="改进(原型模式)"></a><strong>改进(原型模式)</strong></h5><p>​    Java中Object类是所有类的根类，Object类提供了一个clone()方法，该方法可以将一个Java对象复制一份，但是需要实现clone的Java类必须要实现一个接口Cloneable，该接口表示该类能复制且具有复制的能力 =&gt; 原型模式。</p>
<p><strong>代码：</strong></p>
<p><code>Sheep.java</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> DesignPattern.prototype.improve;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> coderYang</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2020/12/21 15:59</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="comment">//此处接口Cloneable里面是没有东西的,可理解为一种标识</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Sheep</span> <span class="keyword">implements</span> <span class="title">Cloneable</span></span>&#123;</span><br><span class="line">  <span class="keyword">private</span> String name;</span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">int</span> age;</span><br><span class="line">  <span class="keyword">private</span> String color;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="title">Sheep</span><span class="params">(String name, <span class="keyword">int</span> age, String color)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">super</span>();</span><br><span class="line">    <span class="keyword">this</span>.name = name;</span><br><span class="line">    <span class="keyword">this</span>.age = age;</span><br><span class="line">    <span class="keyword">this</span>.color = color;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> name;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getAge</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> age;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> String <span class="title">getColor</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> color;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.name = name;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setAge</span><span class="params">(<span class="keyword">int</span> age)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.age = age;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setColor</span><span class="params">(String color)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.color = color;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">"Sheep&#123;"</span> +</span><br><span class="line">            <span class="string">"name='"</span> + name + <span class="string">'\''</span> +</span><br><span class="line">            <span class="string">", age="</span> + age +</span><br><span class="line">            <span class="string">", color='"</span> + color + <span class="string">'\''</span> +</span><br><span class="line">            <span class="string">'&#125;'</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  <span class="comment">//克隆该实例,使用默认的克隆方法来完成</span></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">protected</span> Object <span class="title">clone</span><span class="params">()</span></span>&#123;</span><br><span class="line">    Sheep sheep = <span class="keyword">null</span>;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      sheep = (Sheep)<span class="keyword">super</span>.clone();      <span class="comment">//向下转型</span></span><br><span class="line">    &#125; <span class="keyword">catch</span> (CloneNotSupportedException e) &#123;</span><br><span class="line">      e.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> sheep;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<p><code>Client.java</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> DesignPattern.prototype.improve;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> coderYang</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2020/12/21 17:41</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Client</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    System.out.println(<span class="string">"原型模式完成对象的创建"</span>);</span><br><span class="line">    Sheep sheep = <span class="keyword">new</span> Sheep(<span class="string">"tom"</span>,<span class="number">1</span>,<span class="string">"白色"</span>);</span><br><span class="line">    Sheep sheep2 = (Sheep)sheep.clone();</span><br><span class="line">    Sheep sheep3 = (Sheep)sheep.clone();</span><br><span class="line">    Sheep sheep4 = (Sheep)sheep.clone();</span><br><span class="line">    Sheep sheep5 = (Sheep)sheep.clone();</span><br><span class="line">    Sheep sheep6 = (Sheep)sheep.clone();</span><br><span class="line"></span><br><span class="line">    System.out.println(sheep == sheep2);	<span class="comment">//false</span></span><br><span class="line"></span><br><span class="line">    System.out.println(<span class="string">"sheep2="</span>+sheep2);</span><br><span class="line">    System.out.println(<span class="string">"sheep3="</span>+sheep3);</span><br><span class="line">    System.out.println(<span class="string">"sheep4="</span>+sheep4);</span><br><span class="line">    System.out.println(<span class="string">"sheep5="</span>+sheep5);</span><br><span class="line">    System.out.println(<span class="string">"sheep6="</span>+sheep6);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">原型模式完成对象的创建</span></span><br><span class="line"><span class="comment">sheep2=Sheep&#123;name='tom', age=1, color='白色'&#125;</span></span><br><span class="line"><span class="comment">sheep3=Sheep&#123;name='tom', age=1, color='白色'&#125;</span></span><br><span class="line"><span class="comment">sheep4=Sheep&#123;name='tom', age=1, color='白色'&#125;</span></span><br><span class="line"><span class="comment">sheep5=Sheep&#123;name='tom', age=1, color='白色'&#125;</span></span><br><span class="line"><span class="comment">sheep6=Sheep&#123;name='tom', age=1, color='白色'&#125;</span></span><br><span class="line"><span class="comment"> */</span></span><br></pre></td></tr></table></figure>











<h5 id="原型模式在Spring框架中源码分析"><a href="#原型模式在Spring框架中源码分析" class="headerlink" title="原型模式在Spring框架中源码分析"></a>原型模式在Spring框架中源码分析</h5><h5 id="浅拷贝与深拷贝"><a href="#浅拷贝与深拷贝" class="headerlink" title="浅拷贝与深拷贝"></a>浅拷贝与深拷贝</h5><p><strong>浅拷贝基本介绍：</strong></p>
<ol>
<li>对于数据类型是基本数据类型的成员变量，浅拷贝会直接进行值传递，也就是将该属性值复制一份给新的对象。</li>
<li>对于数据类型是<strong>引用数据类型</strong>的成员变量，比如说成员变量是某个数组、某个类的对象等，那么浅拷贝会进行<strong>引用传递</strong>，也就是只是将该成员变量的引用值(内存地址)复制一份给新的对象。因为实际上两个对象的该成员变量都指向同一个实例。在这种情况下，在一个对象中修改该成员变量会影响到另一个对象的该成员变量值。</li>
<li>前面我们所说的克隆羊就是浅拷贝。</li>
<li>浅拷贝是使用默认的clone()方法来实现 =&gt; <code>sheep = (Sheep)super.clone()</code></li>
</ol>
<p><code>Sheep.java</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> DesignPattern.prototype.improve;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> coderYang</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2020/12/21 15:59</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="comment">//此处接口Cloneable里面是没有东西的,可理解为一种标识</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Sheep</span> <span class="keyword">implements</span> <span class="title">Cloneable</span></span>&#123;</span><br><span class="line">  <span class="keyword">private</span> String name;</span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">int</span> age;</span><br><span class="line">  <span class="keyword">private</span> String color;</span><br><span class="line">  <span class="keyword">private</span> Sheep friend;     <span class="comment">//对象引用</span></span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="title">Sheep</span><span class="params">(String name, <span class="keyword">int</span> age, String color)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">super</span>();</span><br><span class="line">    <span class="keyword">this</span>.name = name;</span><br><span class="line">    <span class="keyword">this</span>.age = age;</span><br><span class="line">    <span class="keyword">this</span>.color = color;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> name;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getAge</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> age;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> String <span class="title">getColor</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> color;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.name = name;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setAge</span><span class="params">(<span class="keyword">int</span> age)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.age = age;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setColor</span><span class="params">(String color)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.color = color;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> Sheep <span class="title">getFriend</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> friend;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setFriend</span><span class="params">(Sheep friend)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.friend = friend;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">"Sheep&#123;"</span> +</span><br><span class="line">            <span class="string">"name='"</span> + name + <span class="string">'\''</span> +</span><br><span class="line">            <span class="string">", age="</span> + age +</span><br><span class="line">            <span class="string">", color='"</span> + color + <span class="string">'\''</span> +</span><br><span class="line">            <span class="string">'&#125;'</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  <span class="comment">//克隆该实例,使用默认的克隆方法来完成</span></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">protected</span> Object <span class="title">clone</span><span class="params">()</span></span>&#123;</span><br><span class="line">    Sheep sheep = <span class="keyword">null</span>;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      sheep = (Sheep)<span class="keyword">super</span>.clone();      <span class="comment">//向下转型</span></span><br><span class="line">    &#125; <span class="keyword">catch</span> (CloneNotSupportedException e) &#123;</span><br><span class="line">      e.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> sheep;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>







<p><code>Client.java</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> DesignPattern.prototype.improve;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> coderYang</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2020/12/21 17:41</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Client</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    System.out.println(<span class="string">"原型模式完成对象的创建"</span>);</span><br><span class="line">    Sheep sheep = <span class="keyword">new</span> Sheep(<span class="string">"tom"</span>, <span class="number">1</span>, <span class="string">"白色"</span>);</span><br><span class="line">    sheep.setFriend(<span class="keyword">new</span> Sheep(<span class="string">"jack"</span>, <span class="number">2</span>, <span class="string">"黑色"</span>));</span><br><span class="line"></span><br><span class="line">    Sheep sheep2 = (Sheep) sheep.clone();</span><br><span class="line">    Sheep sheep3 = (Sheep) sheep.clone();</span><br><span class="line">    Sheep sheep4 = (Sheep) sheep.clone();</span><br><span class="line">    Sheep sheep5 = (Sheep) sheep.clone();</span><br><span class="line">    Sheep sheep6 = (Sheep) sheep.clone();</span><br><span class="line"></span><br><span class="line">    System.out.println(sheep == sheep2);      <span class="comment">//false</span></span><br><span class="line"></span><br><span class="line">    System.out.println(<span class="string">"sheep2="</span> + sheep2 + sheep2.getFriend().hashCode());</span><br><span class="line">    System.out.println(<span class="string">"sheep3="</span> + sheep3 + sheep3.getFriend().hashCode());</span><br><span class="line">    System.out.println(<span class="string">"sheep4="</span> + sheep4 + sheep4.getFriend().hashCode());</span><br><span class="line">    System.out.println(<span class="string">"sheep5="</span> + sheep5 + sheep5.getFriend().hashCode());</span><br><span class="line">    System.out.println(<span class="string">"sheep5="</span> + sheep5 + sheep6.getFriend().hashCode());</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">原型模式完成对象的创建</span></span><br><span class="line"><span class="comment">false</span></span><br><span class="line"><span class="comment">sheep2=Sheep&#123;name='tom', age=1, color='白色'&#125;1504109395</span></span><br><span class="line"><span class="comment">sheep3=Sheep&#123;name='tom', age=1, color='白色'&#125;1504109395</span></span><br><span class="line"><span class="comment">sheep4=Sheep&#123;name='tom', age=1, color='白色'&#125;1504109395</span></span><br><span class="line"><span class="comment">sheep5=Sheep&#123;name='tom', age=1, color='白色'&#125;1504109395</span></span><br><span class="line"><span class="comment">sheep5=Sheep&#123;name='tom', age=1, color='白色'&#125;1504109395</span></span><br><span class="line"><span class="comment"> */</span></span><br></pre></td></tr></table></figure>

















<p><strong>深拷贝基本介绍</strong></p>
<ol>
<li>复制对象的所有基本数据类型的成员变量值。</li>
<li>为所有引用数据类型的成员变量申请存储空间，<strong>并复制每个引用数据类型成员变量所引用的对象</strong>，<strong>直到该对象可达的所有对象</strong>。也就是说，<strong>对象进行深拷贝要对整个对象(包括对象的引用类型)进行拷贝</strong>。</li>
<li><strong>深拷贝实现方式1</strong>：<strong>重写clone</strong>方法来实现深拷贝。</li>
<li><strong>深拷贝实现方式2</strong>：通过<strong>对象序列化</strong>实现深拷贝(推荐)。</li>
</ol>
<p><strong>目录：</strong></p>
<p><img src="/images/Java%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/image-20201222142710421.png" alt="image-20201222142710421"></p>
<p><code>DeepCloneableTarget.java</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> DesignPattern.prototype.deepclone;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.Serializable;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> coderYang</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2020/12/22 11:22</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DeepCloneableTarget</span> <span class="keyword">implements</span> <span class="title">Serializable</span>,<span class="title">Cloneable</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">long</span> serialVersionUID = <span class="number">1L</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">private</span> String cloneName;</span><br><span class="line">  <span class="keyword">private</span> String cloneClass;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="title">DeepCloneableTarget</span><span class="params">(String cloneName, String cloneClass)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.cloneName = cloneName;</span><br><span class="line">    <span class="keyword">this</span>.cloneClass = cloneClass;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//因为该类的属性都是String,因此我们这里使用默认的clone方法完成即可</span></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">protected</span> Object <span class="title">clone</span><span class="params">()</span> <span class="keyword">throws</span> CloneNotSupportedException </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">super</span>.clone();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<p><code>DeepProtoType.java</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> DesignPattern.prototype.deepclone;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.*;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> coderYang</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2020/12/22 11:32</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DeepProtoType</span> <span class="keyword">implements</span> <span class="title">Serializable</span>,<span class="title">Cloneable</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> String name;   <span class="comment">//String属性</span></span><br><span class="line">  <span class="keyword">public</span> DeepCloneableTarget deepCloneableTarget;     <span class="comment">//引用类型</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  <span class="comment">//深拷贝方式一:使用clone方法</span></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">protected</span> Object <span class="title">clone</span><span class="params">()</span> <span class="keyword">throws</span> CloneNotSupportedException </span>&#123;</span><br><span class="line">    Object deep = <span class="keyword">null</span>;</span><br><span class="line">    <span class="comment">//这里完成对基本数据类型(属性)和String的克隆</span></span><br><span class="line">    deep = <span class="keyword">super</span>.clone();</span><br><span class="line">    <span class="comment">//对引用类型的属性进行单独处理</span></span><br><span class="line">    DeepProtoType deepProtoType = (DeepProtoType)deep;</span><br><span class="line">    deepProtoType.deepCloneableTarget = (DeepCloneableTarget)deepCloneableTarget.clone();</span><br><span class="line">    <span class="keyword">return</span> deepProtoType;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  <span class="comment">//深拷贝方式二:通过对象的序列化实现(推荐)</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> Object <span class="title">deepClone</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="comment">//创建流对象</span></span><br><span class="line">    ByteArrayOutputStream bos = <span class="keyword">null</span>;</span><br><span class="line">    ObjectOutputStream oos = <span class="keyword">null</span>;</span><br><span class="line">    ByteArrayInputStream bis = <span class="keyword">null</span>;</span><br><span class="line">    ObjectInputStream ois = <span class="keyword">null</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      <span class="comment">//序列化</span></span><br><span class="line">      bos = <span class="keyword">new</span> ByteArrayOutputStream();</span><br><span class="line">      oos = <span class="keyword">new</span> ObjectOutputStream(bos);</span><br><span class="line">      oos.writeObject(<span class="keyword">this</span>);    <span class="comment">//把当前对象以对象流的方式输出</span></span><br><span class="line"></span><br><span class="line">      <span class="comment">//反序列化</span></span><br><span class="line">      bis = <span class="keyword">new</span> ByteArrayInputStream(bos.toByteArray());</span><br><span class="line">      ois = <span class="keyword">new</span> ObjectInputStream(bis);</span><br><span class="line">      DeepProtoType copyObj = (DeepProtoType)ois.readObject();</span><br><span class="line">      <span class="keyword">return</span> copyObj;</span><br><span class="line">    &#125;<span class="keyword">catch</span> (Exception e)&#123;</span><br><span class="line">      e.printStackTrace();</span><br><span class="line">      <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    &#125;<span class="keyword">finally</span> &#123;</span><br><span class="line">      <span class="comment">//关闭流</span></span><br><span class="line">      <span class="keyword">try</span> &#123;</span><br><span class="line">        bos.close();</span><br><span class="line">        oos.close();</span><br><span class="line">        bis.close();</span><br><span class="line">        ois.close();</span><br><span class="line">      &#125; <span class="keyword">catch</span> (IOException e2) &#123;</span><br><span class="line">        e2.printStackTrace();</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>







<p><code>Client.java</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> DesignPattern.prototype.deepclone;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> coderYang</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2020/12/22 12:39</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Client</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> CloneNotSupportedException </span>&#123;</span><br><span class="line">    DeepProtoType deepProtoType = <span class="keyword">new</span> DeepProtoType();</span><br><span class="line">    deepProtoType.name = <span class="string">"小灰灰"</span>;</span><br><span class="line">    deepProtoType.deepCloneableTarget = <span class="keyword">new</span> DeepCloneableTarget(<span class="string">"程序员小李"</span>,<span class="string">"程序猿类"</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//方式一完成深拷贝</span></span><br><span class="line">    DeepProtoType deepProtoType1 = (DeepProtoType)deepProtoType.clone();</span><br><span class="line">    DeepProtoType deepProtoType2 = (DeepProtoType)deepProtoType.clone();</span><br><span class="line"></span><br><span class="line">    System.out.println(<span class="string">"重写clone深拷贝:deepProType1.name="</span>+deepProtoType1.name+<span class="string">"deepProType1.deepCloneableTarget="</span>+deepProtoType1.deepCloneableTarget.hashCode());</span><br><span class="line">    System.out.println(<span class="string">"重写clone深拷贝:deepProType2.name="</span>+deepProtoType2.name+<span class="string">"deepProType2.deepCloneableTarget="</span>+deepProtoType2.deepCloneableTarget.hashCode());</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">//方式二完成深拷贝</span></span><br><span class="line">    DeepProtoType deepProtoType3 = (DeepProtoType)deepProtoType.deepClone();</span><br><span class="line">    DeepProtoType deepProtoType4 = (DeepProtoType)deepProtoType.deepClone();</span><br><span class="line"></span><br><span class="line">    System.out.println(<span class="string">"序列化深拷贝:deepProType3.name="</span>+deepProtoType3.name+<span class="string">"deepProType3.deepCloneableTarget="</span>+deepProtoType3.deepCloneableTarget.hashCode());</span><br><span class="line">    System.out.println(<span class="string">"序列化深拷贝:deepProType4.name="</span>+deepProtoType4.name+<span class="string">"deepProType4.deepCloneableTarget="</span>+deepProtoType4.deepCloneableTarget.hashCode());</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">  输出结果:可以看到</span></span><br><span class="line"><span class="comment">  重写clone深拷贝:deepProType1.name=小灰灰deepProType1.deepCloneableTarget=2047526627</span></span><br><span class="line"><span class="comment">  重写clone深拷贝:deepProType2.name=小灰灰deepProType2.deepCloneableTarget=760563749</span></span><br><span class="line"><span class="comment">  序列化深拷贝:deepProType3.name=小灰灰deepProType3.deepCloneableTarget=703504298</span></span><br><span class="line"><span class="comment">  序列化深拷贝:deepProType4.name=小灰灰deepProType4.deepCloneableTarget=201556483</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"> */</span></span><br></pre></td></tr></table></figure>

















<h5 id="原型模式注意事项及缺点"><a href="#原型模式注意事项及缺点" class="headerlink" title="原型模式注意事项及缺点"></a>原型模式注意事项及缺点</h5><ol>
<li>创建新的对象比较复杂时，可以利用原型模式简化对象的创建过程，同时也能够提高效率。</li>
<li>不用重新初始化对象，而是<strong>动态的获取对象运行时的状态</strong>。</li>
<li>如果原始对象发生变化(增加或减少属性)，其它克隆对象的也会发生相应的改变，无需修改代码。</li>
<li>在实现深克隆的时候可能需要比较复杂的代码。</li>
<li><strong>缺点</strong>：需要为每一个类配备一个克隆方法，这对全新的类来说不是很难，但对已有的类进行改造时，需要修改其源代码，违背了ocp原则，这点请同学们注意。</li>
</ol>
<h4 id="4-建造者模式"><a href="#4-建造者模式" class="headerlink" title="4.建造者模式"></a>4.建造者模式</h4><p>盖房子需求：</p>
<ol>
<li>需要建房子：这一过程为打桩、砌墙、封顶。</li>
<li>房子有各种各样的，比如普通房，高楼，别墅，各种房子的过程虽然一样，但是要求不要相同。</li>
<li>请编写程序，完成需求。</li>
</ol>
<h5 id="传统方式解决建房子需求："><a href="#传统方式解决建房子需求：" class="headerlink" title="传统方式解决建房子需求："></a>传统方式解决建房子需求：</h5><p><img src="/images/Java%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/image-20201222211340125.png" alt="image-20201222211340125"></p>
<p><strong>项目目录</strong>：</p>
<p><img src="/images/Java%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/image-20201222211411659.png" alt="image-20201222211411659"></p>
<p><code>AbstractHouse.java</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> DesignPattern.builder;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> coderYang</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2020/12/22 21:04</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">AbstractHouse</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//打地基</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">buildBasic</span><span class="params">()</span></span>;</span><br><span class="line">  <span class="comment">//砌墙</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">buildWalls</span><span class="params">()</span></span>;</span><br><span class="line">  <span class="comment">//封顶</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">roofed</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">build</span><span class="params">()</span></span>&#123;</span><br><span class="line">    buildBasic();</span><br><span class="line">    buildWalls();</span><br><span class="line">    roofed();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<p><code>CommonHouse.java</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> DesignPattern.builder;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> coderYang</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2020/12/22 21:06</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CommonHouse</span> <span class="keyword">extends</span> <span class="title">AbstractHouse</span> </span>&#123;</span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">buildBasic</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    System.out.println(<span class="string">"普通房子打地基"</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">buildWalls</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    System.out.println(<span class="string">"普通房子砌墙"</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">roofed</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    System.out.println(<span class="string">"普通房子封顶"</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<p><code>Client.java</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> DesignPattern.builder;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> coderYang</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2020/12/22 21:10</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Client</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    CommonHouse commonHouse = <span class="keyword">new</span> CommonHouse();</span><br><span class="line">    commonHouse.build();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">  普通房子打地基</span></span><br><span class="line"><span class="comment">  普通房子砌墙</span></span><br><span class="line"><span class="comment">  普通房子封顶</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>









<p><strong>传统方式解决盖房子需求问题分析</strong></p>
<ol>
<li>优点是比较好理解，简单易操作。</li>
<li>设计的程序结构，过于简单，没有设计缓存层对象，程序的扩展和维护不好，也就是说，这种设计方案，把<strong>产品(</strong>即：房子)和<strong>创建产品</strong>的过程(即：建房子流程)封装在一起了，耦合性增强了。</li>
<li>解决方案：将产品和产品建造过程解耦 =&gt; <strong>建造者模式</strong>。</li>
</ol>
<h5 id="建造者模式介绍"><a href="#建造者模式介绍" class="headerlink" title="建造者模式介绍"></a>建造者模式介绍</h5><p>基本介绍：</p>
<ol>
<li><strong>建造者模式(Builder Pattern)</strong>又叫<strong>生成器模式</strong>，是一种<strong>对象构建模式</strong>。它可以将复杂对象的建造过程抽象出来(抽象类别)，使这个抽象过程的不同实现方法可以构造出不同表现(属性)的对象。</li>
<li><strong>建造者模式</strong>是一步一步创建一个复杂的对象，它允许用户只通过指定复杂对象的类型和内容就可以构造它们，用户不需要知道内部的具体构建细节。</li>
</ol>
<img src="/images/Java%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/image-20201222223258974.png" alt="image-20201222223258974" style="zoom: 50%;" />







<p><strong>建造者模式的四个角色</strong>：</p>
<ol>
<li><strong>Product(产品角色)</strong>：一个具体的产品对象。</li>
<li><strong>Builder(抽象建造者)</strong>：创建一个Product对象的各个部件指定的<strong>接口/抽象类</strong>。</li>
<li><strong>ConcreteBuilder(具体建造者)</strong>：实现接口，构建和装配各个部件。</li>
<li><strong>Director(指挥者)</strong>：构建一个使用Builder接口的对象。它主要是用于创建一个复杂的对象。它主要有两个作用，一是：隔离了客户与对象的生产过程，二是：复杂控制产品对象的生产过程。</li>
</ol>
<p><img src="/images/Java%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/image-20201223140955119.png" alt="image-20201223140955119"></p>
<h5 id="建造者模式解决建房子需求"><a href="#建造者模式解决建房子需求" class="headerlink" title="建造者模式解决建房子需求"></a>建造者模式解决建房子需求</h5><p><img src="/images/Java%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/image-20201223112849024.png" alt="image-20201223112849024"></p>
<p><strong>项目目录</strong>：</p>
<p><img src="/images/Java%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/image-20201223141130235.png" alt="image-20201223141130235"></p>
<p><code>House.java</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> DesignPattern.builder.improve;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> coderYang</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2020/12/23 10:55</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">House</span> </span>&#123;</span><br><span class="line">  <span class="keyword">private</span> String basic;</span><br><span class="line">  <span class="keyword">private</span> String wall;</span><br><span class="line">  <span class="keyword">private</span> String roofed;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> String <span class="title">getBasic</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> basic;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> String <span class="title">getWall</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> wall;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> String <span class="title">getRoofed</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> roofed;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setBasic</span><span class="params">(String basic)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.basic = basic;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setWall</span><span class="params">(String wall)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.wall = wall;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setRoofed</span><span class="params">(String roofed)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.roofed = roofed;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<p><code>HouseBuilder.java</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> DesignPattern.builder.improve;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> coderYang</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2020/12/23 10:56</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//抽象的建造者</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">HouseBuilder</span> </span>&#123;</span><br><span class="line">  <span class="keyword">protected</span> House house = <span class="keyword">new</span> House();</span><br><span class="line"></span><br><span class="line">  <span class="comment">//将建造的流程写好,抽象方法</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">buildBasic</span><span class="params">()</span></span>;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">buildWalls</span><span class="params">()</span></span>;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">roofed</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//房子建好后,将产品(房子)返回</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> House <span class="title">buildHouse</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> house;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<p><code>CommonHouse.java</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> DesignPattern.builder.improve;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> coderYang</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2020/12/23 11:00</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CommonHouse</span> <span class="keyword">extends</span> <span class="title">HouseBuilder</span></span>&#123;</span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">buildBasic</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    System.out.println(<span class="string">"普通房子打地基,5m"</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">buildWalls</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    System.out.println(<span class="string">"普通房子砌墙,10cm"</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">roofed</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    System.out.println(<span class="string">"普通房子封顶"</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>









<p><code>HighBuilding.java</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> DesignPattern.builder.improve;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> coderYang</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2020/12/23 11:01</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HighBuilding</span> <span class="keyword">extends</span> <span class="title">HouseBuilder</span></span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">buildBasic</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    System.out.println(<span class="string">"高楼打地基,100m"</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">buildWalls</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    System.out.println(<span class="string">"高楼砌墙,20cm"</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">roofed</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    System.out.println(<span class="string">"高楼封顶"</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>







<p><code>HouseDirector.java</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> DesignPattern.builder.improve;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> coderYang</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2020/12/23 11:03</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="comment">//指挥者,这里去指定制作流程,返回具体的产品</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HouseDirector</span> </span>&#123;</span><br><span class="line">  HouseBuilder houseBuilder = <span class="keyword">null</span>;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//构造器传入houseBuilder</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="title">HouseDirector</span><span class="params">(HouseBuilder houseBuilder)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.houseBuilder = houseBuilder;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//通过setter传入houseBuilder</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setHouseBuilder</span><span class="params">(HouseBuilder houseBuilder)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.houseBuilder = houseBuilder;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//建造房子的流程交给指挥者</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> House <span class="title">constructHouse</span><span class="params">()</span></span>&#123;</span><br><span class="line">    houseBuilder.buildBasic();</span><br><span class="line">    houseBuilder.buildWalls();</span><br><span class="line">    houseBuilder.roofed();</span><br><span class="line">    <span class="keyword">return</span> houseBuilder.buildHouse();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>







<p><code>Client.java</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> DesignPattern.builder.improve;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> coderYang</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2020/12/23 11:11</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Client</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    <span class="comment">//盖普通房子</span></span><br><span class="line">    CommonHouse commonHouse = <span class="keyword">new</span> CommonHouse();</span><br><span class="line">    <span class="comment">//指挥者</span></span><br><span class="line">    HouseDirector houseDirector = <span class="keyword">new</span> HouseDirector(commonHouse);</span><br><span class="line">    <span class="comment">//完成盖房子,返回产品(普通房子)</span></span><br><span class="line">    House house = houseDirector.constructHouse();</span><br><span class="line"></span><br><span class="line">    System.out.println(<span class="string">"---------------------"</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//盖高楼</span></span><br><span class="line">    HighBuilding highBuilding = <span class="keyword">new</span> HighBuilding();</span><br><span class="line">    <span class="comment">//重置建造者</span></span><br><span class="line">    houseDirector.setHouseBuilder(highBuilding);</span><br><span class="line">    <span class="comment">//完成盖房子,返回产品(高楼)</span></span><br><span class="line">    House highHouse = houseDirector.constructHouse();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">普通房子打地基,5m</span></span><br><span class="line"><span class="comment">普通房子砌墙,10cm</span></span><br><span class="line"><span class="comment">普通房子封顶</span></span><br><span class="line"><span class="comment">---------------------</span></span><br><span class="line"><span class="comment">高楼打地基,100m</span></span><br><span class="line"><span class="comment">高楼砌墙,20cm</span></span><br><span class="line"><span class="comment">高楼封顶</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"> */</span></span><br></pre></td></tr></table></figure>















<h5 id="建造者模式在JDK中的应用和源码分析"><a href="#建造者模式在JDK中的应用和源码分析" class="headerlink" title="建造者模式在JDK中的应用和源码分析"></a>建造者模式在JDK中的应用和源码分析</h5><p>源码中建造者模式角色分析：</p>
<ul>
<li><code>Appendable</code>接口定义了多个append方法(抽象方法)，即<code>Appendable</code>为抽象建造者，定义了抽象方法。</li>
<li><code>AbstractStringBuilder</code>实现了<code>Appendable</code>接口方法，这里的<code>AbstractStringBuilder</code>已经是建造者，只是不能实例化。</li>
<li><code>StringBuilder</code>即充当了指挥者角色，同时充当了具体的建造者，建造方法的实现是由<code>AbstractStringBuilder</code>完成，而<code>StringBuilder</code>继承了<code>AbstractStringBuilder</code>。</li>
</ul>
<p><img src="/images/Java%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/image-20201224143425503.png" alt="image-20201224143425503"></p>
<h5 id="建造者模式注意事项和细节"><a href="#建造者模式注意事项和细节" class="headerlink" title="建造者模式注意事项和细节"></a>建造者模式注意事项和细节</h5><ol>
<li><p>客户端(使用程序)不<strong>必知道产品内部组成的细节，将产品本身与产品的创建过程解耦，使得相同的创建过程可以创建不同的产品对象。</strong></p>
</li>
<li><p>每一个具体建造者都相对独立，而与其他的具体建造者无关，因此可以很方便地替换具体建造者或增加新的具体建造者，<strong>用户使用不同的具体建造者即可得到不同的产品对象</strong>。</p>
</li>
<li><p><strong>可以更加精细地控制产品地创建过程</strong>。将复杂产品的插件步骤分解在不同方法中，使得创建过程更加清晰，也更加方便使用程序来控制创建过程。</p>
</li>
<li><p><strong>增加新的具体建造者无须修改原有类库的代码</strong>，指挥者类针对抽象建造者类编程，系统扩展方便，符合<strong>开闭原则</strong>。</p>
</li>
<li><p>建造者模式所创建的产品一般具有较多的共同点，其组成部分相似，<strong>如果产品之间的差异性很大，则不适合使用建造者模式</strong>，因此其使用范围受到一定的限制。</p>
</li>
<li><p>如果产品的内部变化复杂，可能会导致需要定义很多具体的建造者类来实现这种变化，导致系统变得很庞大，因此在这种情况下，要考虑是否选择建造者模式。</p>
</li>
<li><p><strong>抽象模式跟建造者模式区别</strong>：</p>
<p>抽象工厂模式实现对产品家族的创建，一个产品家族是这样的一系列产品：具有不同分类维度的产品组合，采用抽象工厂模式不需要关心构造过程，只关心什么产品由什么工厂生产即可。而建造者模式则是要求按照指定的蓝图建造产品，它的主要目的是通过组装零配件而产生一个新产品。</p>
</li>
</ol>
<h4 id="5-适配器模式"><a href="#5-适配器模式" class="headerlink" title="5.适配器模式"></a>5.适配器模式</h4><p>现实生活中的转接头就是适配器的例子。</p>
<p><strong>基本介绍</strong>：</p>
<ol>
<li>适配器模式(Adapter Pattern)将某个类的接口转换成客户端期望的另一个接口表示，主要目的是<strong>兼容性</strong>，让原本因接口不匹配不能一起工作的两个类可以协同工作。其别名为<strong>包装器(Wrapper)</strong></li>
<li>适配器模式属于<strong>结构型模式</strong>。</li>
<li>主要分为三类：<strong>类适配器模式</strong>、<strong>对象适配器模式</strong>、<strong>接口适配器模式</strong>。</li>
</ol>
<p><strong>工作原理</strong>：</p>
<ol>
<li>适配器模式：将一个类的接口转换成另一种接口，让<strong>原本接口不兼容的类可以兼容</strong></li>
<li>从用户的角度看不到被适配器，是解耦的。</li>
<li>用户调用适配器转化出来的目标接口方法，<strong>适配器</strong>再调用<strong>被适配者的相关接口方法</strong>。</li>
<li>用户收到反馈结果，感觉只是和目标接口交互，如图：</li>
</ol>
<img src="/images/Java%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/image-20201226163501498.png" alt="image-20201226163501498" style="zoom:80%;" />













<h5 id="类适配器模式"><a href="#类适配器模式" class="headerlink" title="类适配器模式"></a>类适配器模式</h5><p>基本介绍：<code>Adapter</code>类，通过继承<code>src</code>类，实现<code>dst</code>类接口，完成<code>src-&gt;dst</code>的适配。</p>
<p><strong>案例</strong>：</p>
<p>​    以生活中充电器的例子来讲解适配器，充电器本身相当于Adapter，220V交流电相当于<code>src(即被适配者)</code>，我们的<code>dst(即目标)</code>是5V直流电。</p>
<p><img src="/images/Java%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/image-20201226165645679.png" alt="image-20201226165645679"></p>
<p><strong>项目目录</strong>：</p>
<p><img src="/images/Java%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/image-20201226171246412.png" alt="image-20201226171246412"></p>
<p><code>Voltage220V.java</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> DesignPattern.adapter.classadapter;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> coderYang</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2020/12/26 16:57</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="comment">//被适配的类</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Voltage220V</span> </span>&#123;</span><br><span class="line">  <span class="comment">//输出220V电压</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">output220V</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> src = <span class="number">220</span>;</span><br><span class="line">    System.out.println(<span class="string">"电压="</span>+src+<span class="string">"V"</span>);</span><br><span class="line">    <span class="keyword">return</span> src;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<p><code>IVoltage220V.java</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> DesignPattern.adapter.classadapter;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> coderYang</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2020/12/26 17:02</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="comment">//适配接口</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">IVoltage5V</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">output5V</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<p><code>VoltageAdapter.java</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> DesignPattern.adapter.classadapter;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> coderYang</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2020/12/26 17:02</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//适配器类</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">VoltageAdapter</span> <span class="keyword">extends</span> <span class="title">Voltage220V</span> <span class="keyword">implements</span> <span class="title">IVoltage5V</span></span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">output5V</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">//获取220V电压</span></span><br><span class="line">    <span class="keyword">int</span> srcV = output220V();</span><br><span class="line">    <span class="keyword">int</span> dstV = srcV / <span class="number">44</span>;</span><br><span class="line">    <span class="keyword">return</span> dstV;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<p><code>Phone.java</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> DesignPattern.adapter.classadapter;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> coderYang</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2020/12/26 17:05</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Phone</span> </span>&#123;</span><br><span class="line">  <span class="comment">//充电</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">charging</span><span class="params">(IVoltage5V iVoltage5V)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (iVoltage5V.output5V() == <span class="number">5</span>)&#123;</span><br><span class="line">      System.out.println(<span class="string">"电压为5V,可以充电"</span>);</span><br><span class="line">    &#125;<span class="keyword">else</span> <span class="keyword">if</span> (iVoltage5V.output5V() &gt; <span class="number">5</span>)&#123;</span><br><span class="line">      System.out.println(<span class="string">"电压大于,无法充电"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<p><code>Client.java</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> DesignPattern.adapter.classadapter;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> coderYang</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2020/12/26 17:08</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Client</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    System.out.println(<span class="string">"==类适配器=="</span>);</span><br><span class="line">    Phone phone = <span class="keyword">new</span> Phone();</span><br><span class="line">    phone.charging(<span class="keyword">new</span> VoltageAdapter());</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">==类适配器==</span></span><br><span class="line"><span class="comment">电压=220V</span></span><br><span class="line"><span class="comment">电压为5V,可以充电</span></span><br><span class="line"><span class="comment"> */</span></span><br></pre></td></tr></table></figure>









<p><strong>类适配器模式注意事项和细节</strong></p>
<ol>
<li>Java是单继承机制，所以类适配器需要继承<code>src</code>类这一点算是一个缺点，因为这要求<code>dst</code>必须是接口，有一定局限性。</li>
<li><code>src</code>类的方法在<code>Adapter</code>中会暴露出来，也增加了使用的成本。</li>
<li>由于其继承了<code>src</code>类，所以它可以根据需求重写<code>src</code>类的方法，使得<code>Adapter</code>的灵活性增强了。</li>
</ol>
<h5 id="对象适配器模式"><a href="#对象适配器模式" class="headerlink" title="对象适配器模式"></a>对象适配器模式</h5><p>对象适配器模式介绍：</p>
<ol>
<li>基本思路和类的适配器模式相同，只是将Adapter类作修改，不是继承<code>src</code>类，而是持有<code>src</code>类的实例，以解决兼容的问题。即：持有<code>src</code>类，实现<code>dst</code>类接口，完成<code>src-&gt;dst</code>的适配。</li>
<li>根据<code>合成复用原则</code>，在系统中尽量使用关联关系来替代继承关系。</li>
<li><strong>对象适配器模式是适配器模式常用的一种</strong>。</li>
</ol>
<p><strong>使用对象适配器改进充电器案例</strong>：</p>
<p><img src="/images/Java%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/image-20210101170944833.png" alt="image-20210101170944833"></p>
<p><strong>项目目录:</strong></p>
<p><img src="/images/Java%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/image-20210101172316743.png" alt="image-20210101172316743"></p>
<p><code>Voltage220V.java</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> DesignPattern.adapter.objectadapter;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> coderYang</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2020/12/26 16:57</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="comment">//被适配的类</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Voltage220V</span> </span>&#123;</span><br><span class="line">  <span class="comment">//输出220V电压</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">output220V</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> src = <span class="number">220</span>;</span><br><span class="line">    System.out.println(<span class="string">"电压="</span>+src+<span class="string">"V"</span>);</span><br><span class="line">    <span class="keyword">return</span> src;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<p><code>IVoltageV.java</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> DesignPattern.adapter.objectadapter;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> coderYang</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2020/12/26 17:02</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="comment">//适配接口</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">IVoltage5V</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">output5V</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>







<p><code>VoltageAdapter.java</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> DesignPattern.adapter.objectadapter;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> coderYang</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2020/12/26 17:02</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//适配器类</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">VoltageAdapter</span> <span class="keyword">implements</span> <span class="title">IVoltage5V</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">final</span> Voltage220V voltage220V;    <span class="comment">//关联关系中的聚合关系</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">//通过构造器,传入一个Voltage220V的实例</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="title">VoltageAdapter</span><span class="params">(Voltage220V voltage220V)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.voltage220V = voltage220V;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">output5V</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> dst = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span>(<span class="keyword">null</span> != voltage220V)&#123;</span><br><span class="line">      <span class="keyword">int</span> src = voltage220V.output220V();   <span class="comment">//获取220V电压</span></span><br><span class="line">      System.out.println(<span class="string">"使用对象适配器进行适配"</span>);</span><br><span class="line">      dst = src / <span class="number">44</span>;</span><br><span class="line">      System.out.println(<span class="string">"适配完成,输出的电压为:"</span>+dst);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> dst;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>







<p><code>Phone.java</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> DesignPattern.adapter.objectadapter;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> coderYang</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2020/12/26 17:05</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Phone</span> </span>&#123;</span><br><span class="line">  <span class="comment">//充电</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">charging</span><span class="params">(IVoltage5V iVoltage5V)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (iVoltage5V.output5V() == <span class="number">5</span>)&#123;</span><br><span class="line">      System.out.println(<span class="string">"电压为5V,可以充电"</span>);</span><br><span class="line">    &#125;<span class="keyword">else</span> <span class="keyword">if</span> (iVoltage5V.output5V() &gt; <span class="number">5</span>)&#123;</span><br><span class="line">      System.out.println(<span class="string">"电压大于,无法充电"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<p><code>Client.java</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> DesignPattern.adapter.objectadapter;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> coderYang</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2020/12/26 17:08</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Client</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    System.out.println(<span class="string">"==对象适配器=="</span>);</span><br><span class="line">    Phone phone = <span class="keyword">new</span> Phone();</span><br><span class="line">    phone.charging(<span class="keyword">new</span> VoltageAdapter(<span class="keyword">new</span> Voltage220V()));</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">==类适配器==</span></span><br><span class="line"><span class="comment">电压=220V</span></span><br><span class="line"><span class="comment">使用对象适配器进行适配</span></span><br><span class="line"><span class="comment">适配完成,输出的电压为:5</span></span><br><span class="line"><span class="comment">电压为5V,可以充电</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">Process finished with exit code 0</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"> */</span></span><br></pre></td></tr></table></figure>







<p><strong>对象适配器模式注意事项和细节</strong></p>
<ol>
<li>对象适配器和类适配器其实算是同一种思想，只不过实现的方式不同，根据合成复用原则，使用组合替代继承，所以它解决了类适配器必须继承src的局限性问题，也不再要求<code>dst</code>必须是接口。</li>
<li>使用成本更低，更灵活。</li>
</ol>
<h5 id="接口适配器模式"><a href="#接口适配器模式" class="headerlink" title="接口适配器模式"></a>接口适配器模式</h5><p>接口适配器模式介绍：</p>
<ol>
<li>一些书籍称为：适配器模式(Default Adapter Pattern)或缺省适配器模式。</li>
<li>当不需要全部实现接口提供的方法时，可先设计一个抽象类实现接口，并为该接口中每个方法提供一个默认实现(空方法)，那么该抽象类的字类可有选择地覆盖父类的某些方法实现需求。</li>
<li>适用于一个接口不想使用其所有的方法的情况。</li>
</ol>
<p><img src="/images/Java%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/image-20210101190752427.png" alt="image-20210101190752427"></p>
<p><strong>项目目录：</strong></p>
<p><img src="/images/Java%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/image-20210101190824944.png" alt="image-20210101190824944"></p>
<p><code>InterfaceA.java</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> DesignPattern.adapter.interfaceadapter;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> coderYang</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/1/1 18:54</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">InterfaceA</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">m1</span><span class="params">()</span></span>;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">m2</span><span class="params">()</span></span>;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">m3</span><span class="params">()</span></span>;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">m4</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>







<p><code>AbsAdapter.java</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> DesignPattern.adapter.interfaceadapter;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> coderYang</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/1/1 18:55</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//在AbsAdapter抽象类中,我们将InterfaceA的方法进行默认实现</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">AbsAdapter</span> <span class="keyword">implements</span> <span class="title">InterfaceA</span></span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">m1</span><span class="params">()</span></span>&#123;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">m2</span><span class="params">()</span></span>&#123;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">m3</span><span class="params">()</span></span>&#123;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">m4</span><span class="params">()</span></span>&#123;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<p><code>Client.java</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> DesignPattern.adapter.interfaceadapter;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> coderYang</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/1/1 18:57</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Client</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    <span class="comment">//使用匿名内部类的方式去覆盖我们需要使用的方法</span></span><br><span class="line">    AbsAdapter absAdapter = <span class="keyword">new</span> AbsAdapter()&#123;</span><br><span class="line">      <span class="comment">//只需要去覆盖我们需要使用的接口方法</span></span><br><span class="line">      <span class="meta">@Override</span></span><br><span class="line">      <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">m1</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"使用了m1的方法"</span>);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">    absAdapter.m1();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>















<h5 id="适配器模式在SpringMVC框架应用的源码分析"><a href="#适配器模式在SpringMVC框架应用的源码分析" class="headerlink" title="适配器模式在SpringMVC框架应用的源码分析"></a>适配器模式在SpringMVC框架应用的源码分析</h5><p>适配器模式在SpringMVC框架应用的源码剖析</p>
<ol>
<li><p>SpringMVC中的<code>HandlerAdapter</code>，就使用了适配器模式。</p>
</li>
<li><p>SpringMVC处理请求的流程</p>
</li>
<li><p>使用<code>HandlerAdapter</code>的原因分析：</p>
<p>可以看到处理器的类型不同，有<strong>多重实现的方式，那么调用方式就不是确定的</strong>，如果需要直接调用Controller方法，需要调用的时候就得不断是使用if else来进行判断是哪一种子类然后执行。那么如果后面要扩展Controller，就得修改原来的代码，这样就违背了OCP原则。</p>
</li>
</ol>
<p><strong>手写SpringMVC通过适配器设计模式获取到对应的Controller的源码</strong></p>
<p><img src="/images/Java%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/image-20210102145118196.png" alt="image-20210102145118196"></p>
<p><strong>项目目录</strong>：</p>
<p><img src="/images/Java%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/image-20210102145214837.png" alt="image-20210102145214837"></p>
<p><code>Controller.java</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> DesignPattern.adapter.springmvc;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> coderYang</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/1/2 13:30</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="comment">//多种Controller实现</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Controller</span> </span>&#123;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">HttpController</span> <span class="keyword">implements</span> <span class="title">Controller</span></span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doHttpHandler</span><span class="params">()</span></span>&#123;</span><br><span class="line">    System.out.println(<span class="string">"http..."</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SimpleController</span> <span class="keyword">implements</span> <span class="title">Controller</span></span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doSimpleHandler</span><span class="params">()</span></span>&#123;</span><br><span class="line">    System.out.println(<span class="string">"simple..."</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">AnnotationController</span> <span class="keyword">implements</span> <span class="title">Controller</span></span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doAnnotationHandler</span><span class="params">()</span></span>&#123;</span><br><span class="line">    System.out.println(<span class="string">"annotation..."</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<p><code>HandlerAdapter.java</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> DesignPattern.adapter.springmvc;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> coderYang</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/1/2 13:33</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="comment">//定义一个Adapter接口</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">HandlerAdapter</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">supports</span><span class="params">(Object handler)</span></span>;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">handle</span><span class="params">(Object handler)</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//多种适配器种类</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SimpleHandlerAdapter</span> <span class="keyword">implements</span> <span class="title">HandlerAdapter</span></span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">supports</span><span class="params">(Object handler)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> (handler <span class="keyword">instanceof</span> SimpleController);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">handle</span><span class="params">(Object handler)</span> </span>&#123;</span><br><span class="line">    ((SimpleController)handler).doSimpleHandler();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">HttpHandlerAdapter</span> <span class="keyword">implements</span> <span class="title">HandlerAdapter</span></span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">supports</span><span class="params">(Object handler)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> (handler <span class="keyword">instanceof</span> HttpController);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">handle</span><span class="params">(Object handler)</span> </span>&#123;</span><br><span class="line">    ((HttpController)handler).doHttpHandler();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">AnnotationHandlerAdapter</span> <span class="keyword">implements</span> <span class="title">HandlerAdapter</span></span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">supports</span><span class="params">(Object handler)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> (handler <span class="keyword">instanceof</span> AnnotationController);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">handle</span><span class="params">(Object handler)</span> </span>&#123;</span><br><span class="line">    ((AnnotationController)handler).doAnnotationHandler();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>







<p><code>DispatchServlet.java</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> DesignPattern.adapter.springmvc;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> coderYang</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/1/2 13:47</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DispatchServlet</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> List&lt;HandlerAdapter&gt; handlerAdapters = <span class="keyword">new</span> ArrayList&lt;HandlerAdapter&gt;();</span><br><span class="line"></span><br><span class="line">  <span class="comment">//构造器</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="title">DispatchServlet</span><span class="params">()</span></span>&#123;</span><br><span class="line">    handlerAdapters.add(<span class="keyword">new</span> AnnotationHandlerAdapter());</span><br><span class="line">    handlerAdapters.add(<span class="keyword">new</span> HttpHandlerAdapter());</span><br><span class="line">    handlerAdapters.add(<span class="keyword">new</span> SimpleHandlerAdapter());</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doDispatch</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="comment">//此处模拟SpringMVC从request取handler的对象</span></span><br><span class="line">    <span class="comment">//适配器可以获取到希望得到的Controller</span></span><br><span class="line"><span class="comment">//    AnnotationController controller = new AnnotationController();</span></span><br><span class="line">    HttpController controller = <span class="keyword">new</span> HttpController();   <span class="comment">//http...</span></span><br><span class="line"><span class="comment">//    SimpleController controller = new SimpleController();</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//得到对应的适配器</span></span><br><span class="line">    HandlerAdapter adapter = getHandler(controller);</span><br><span class="line">    <span class="comment">//通过适配器执行对应的controller对应方法</span></span><br><span class="line">    adapter.handle(controller);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> HandlerAdapter <span class="title">getHandler</span><span class="params">(Controller controller)</span></span>&#123;</span><br><span class="line">    <span class="comment">//遍历:根据得到的controller(handler),返回对应的适配器</span></span><br><span class="line">    <span class="keyword">for</span> (HandlerAdapter adapter : handlerAdapters)&#123;</span><br><span class="line">      <span class="keyword">if</span> (adapter.supports(controller))&#123;</span><br><span class="line">        <span class="keyword">return</span> adapter;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">new</span> DispatchServlet().doDispatch();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>







<p>说明：</p>
<ul>
<li>Spring定义了一个适配接口，使得每一种Controller有一种对应的适配器实现类</li>
<li>适配器代替controller执行相应的方法</li>
<li>扩展Controller时，只需要增加一个适配器类就完成了SpringMVC的扩展了。</li>
</ul>
<h5 id="适配器模式的注意事项和细节"><a href="#适配器模式的注意事项和细节" class="headerlink" title="适配器模式的注意事项和细节"></a>适配器模式的注意事项和细节</h5><ol>
<li><p>三种命名方式，是根据src是以怎样的形式给到Adapter(在Adapter里的形式)来命名的。</p>
</li>
<li><p>类适配器：以类给到，在Adapter里，就是将src当作类，继承。</p>
<p>对象适配器：以对象给到，在Adapter里，将src作为一个对象，持有。</p>
<p>接口适配器：以接口给到，在Adapter里，将src作为一个接口，实现。</p>
</li>
<li><p>Adapter模式最大的作用还是将原本不兼容的接口融合在一起工作。</p>
</li>
<li><p>实际开发中，实现起来不拘泥于我们将的三种方式。</p>
</li>
</ol>
<h4 id="6-桥接模式"><a href="#6-桥接模式" class="headerlink" title="6.桥接模式"></a>6.桥接模式</h4><p>手机操作问题：</p>
<p>现在对不同手机类型的不同品牌实现操作编程(比如：开机、关机、上网、打电话等)，如图：</p>
<p><img src="/images/Java%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/image-20210102153254255.png" alt="image-20210102153254255"></p>
<p>类图：</p>
<p><img src="/images/Java%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/image-20210102154033427.png" alt="image-20210102154033427"></p>
<h5 id="传统问题解决手机操作问题分析"><a href="#传统问题解决手机操作问题分析" class="headerlink" title="传统问题解决手机操作问题分析"></a>传统问题解决手机操作问题分析</h5><ol>
<li>扩展性问题(类爆炸)，如果我们再增加手机的样式(旋转式)，就需要增加各个品牌手机的类，同样如果我们增加一个手机品牌，也要在各个手机样式类下增加。</li>
<li>违反了单一职责原则，当我们增加手机样式时，要同时增加所有品牌的手机，这样就增加了代码维护成本。</li>
<li>解决方案：使用桥接模式。</li>
</ol>
<h5 id="桥接模式基本介绍"><a href="#桥接模式基本介绍" class="headerlink" title="桥接模式基本介绍"></a>桥接模式基本介绍</h5><p>基本介绍：</p>
<ol>
<li>桥接模式(Bride模式)是指：<strong>将实现与抽象放在两个不同的类层次中，使两个层次可以独立改变</strong>。</li>
<li>桥接模式是一种<strong>结构型设计模式</strong>。</li>
<li>Bride模式<strong>基于类的最小设计原则</strong>，通过使用封装、聚合及继承等行为让不同的类承担不同的职责。它的主要特点是把抽象(Abstraction)与行为实现(Implementation)分离开来，从而可以保持各部分的独立性以及应对他们的功能扩展。</li>
</ol>
<p><strong>原理类图</strong></p>
<p>将抽象部分与它的实现部分分离，使它们都可以独立地变化。</p>
<p><img src="/images/Java%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/image-20210102225218070.png" alt="image-20210102225218070"></p>
<p>原理类图说明：</p>
<ol>
<li>Client类：桥接模式的调用者。</li>
<li>抽象类(Abstraction)：维护了<code>Implementor</code>/即它的实现类<code>ConcretImplentorA,ConcretImplementorB</code>，二者是聚合关系，Abstraction<strong>充当桥接类</strong>。</li>
<li><code>RefinedAbstraction</code>：Abstraction抽象类的子类。</li>
<li><code>Implementor</code>：行为实现的接口。</li>
<li><code>ConcreteImplementorA/B</code>：行为的具体实现类。</li>
<li>从UML图：这里的抽象类和接口是聚合的关系，其实是调用和被调用的关系。</li>
</ol>
<h5 id="桥接模式解决手机问题"><a href="#桥接模式解决手机问题" class="headerlink" title="桥接模式解决手机问题"></a>桥接模式解决手机问题</h5><p><img src="/images/Java%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/image-20210102225250562.png" alt="image-20210102225250562"></p>
<p><strong>此处我们理解为手机样式是手机抽象部分，而颜色是手机的实现部分。桥接模式使这两个部分分离，使它们可以独立的变化。</strong></p>
<p><strong>项目目录</strong>：</p>
<p><img src="/images/Java%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/image-20210102225302262.png" alt="image-20210102225302262"></p>
<p><code>Brand.java</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> DesignPattern.bridge;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> coderYang</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/1/2 16:46</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Brand</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">void</span> <span class="title">open</span><span class="params">()</span></span>;</span><br><span class="line">  <span class="function"><span class="keyword">void</span> <span class="title">close</span><span class="params">()</span></span>;</span><br><span class="line">  <span class="function"><span class="keyword">void</span> <span class="title">call</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<p><code>Vivo.java</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> DesignPattern.bridge;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> coderYang</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/1/2 16:53</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Vivo</span> <span class="keyword">implements</span> <span class="title">Brand</span></span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">open</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    System.out.println(<span class="string">"Vivo手机打开"</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">close</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    System.out.println(<span class="string">"Vivo手机关闭"</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">call</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    System.out.println(<span class="string">"Vivo手机打电话"</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>







<p><code>XiaoMi.java</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> DesignPattern.bridge;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> coderYang</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/1/2 16:47</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">XiaoMi</span> <span class="keyword">implements</span> <span class="title">Brand</span></span>&#123;</span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">open</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    System.out.println(<span class="string">"小米手机打开"</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">close</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    System.out.println(<span class="string">"小米手机关闭"</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">call</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    System.out.println(<span class="string">"小米手机打电话"</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>







<p><code>Phone.java</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> DesignPattern.bridge;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> coderYang</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/1/2 16:54</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">Phone</span> </span>&#123;</span><br><span class="line">  <span class="comment">//组合品牌</span></span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">final</span> Brand brand;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//构造器</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="title">Phone</span><span class="params">(Brand brand)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.brand = brand;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">open</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.brand.open();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">close</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.brand.close();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">call</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.brand.close();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>







<p><code>FoldedPhone.java</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> DesignPattern.bridge;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> coderYang</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/1/2 16:59</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//折叠式手机,继承抽象类Phone</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">FoldedPhone</span> <span class="keyword">extends</span> <span class="title">Phone</span></span>&#123;</span><br><span class="line">  <span class="comment">//构造器</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="title">FoldedPhone</span><span class="params">(Brand brand)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">super</span>(brand);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">open</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">super</span>.open();</span><br><span class="line">    System.out.println(<span class="string">"折叠样式手机"</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">close</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">super</span>.close();</span><br><span class="line">    System.out.println(<span class="string">"折叠样式手机"</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">call</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">super</span>.call();</span><br><span class="line">    System.out.println(<span class="string">"折叠样式手机"</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>









<p><code>UpRightPhone.java</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> DesignPattern.bridge;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> coderYang</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/1/2 17:04</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//翻盖式手机,继承抽象类Phone</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UpRightPhone</span> <span class="keyword">extends</span> <span class="title">Phone</span></span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="title">UpRightPhone</span><span class="params">(Brand brand)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">super</span>(brand);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">open</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">super</span>.open();</span><br><span class="line">    System.out.println(<span class="string">"翻盖样式手机"</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">close</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">super</span>.close();</span><br><span class="line">    System.out.println(<span class="string">"翻盖样式手机"</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">call</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">super</span>.call();</span><br><span class="line">    System.out.println(<span class="string">"翻盖样式手机"</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>









<p><code>Client.java</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> DesignPattern.bridge;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> coderYang</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/1/2 17:06</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Client</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    <span class="comment">//获取折叠式手机(Vivo品牌)</span></span><br><span class="line">    Phone phone = <span class="keyword">new</span> FoldedPhone(<span class="keyword">new</span> Vivo());</span><br><span class="line">    phone.open();</span><br><span class="line">    phone.call();</span><br><span class="line">    phone.close();</span><br><span class="line"></span><br><span class="line">    System.out.println(<span class="string">"===================="</span>);</span><br><span class="line">    <span class="comment">//获取折叠式手机(XiaoMi品牌)</span></span><br><span class="line">    Phone phone1 = <span class="keyword">new</span> FoldedPhone(<span class="keyword">new</span> XiaoMi());</span><br><span class="line">    phone.open();</span><br><span class="line">    phone.call();</span><br><span class="line">    phone.close();</span><br><span class="line"></span><br><span class="line">    System.out.println(<span class="string">"======================="</span>);</span><br><span class="line">    <span class="comment">//获取翻盖式手机(Vivo品牌)</span></span><br><span class="line">    Phone phone2 = <span class="keyword">new</span> UpRightPhone(<span class="keyword">new</span> Vivo());</span><br><span class="line">    phone2.open();</span><br><span class="line">    phone2.call();</span><br><span class="line">    phone2.close();</span><br><span class="line"></span><br><span class="line">    System.out.println(<span class="string">"====================="</span>);</span><br><span class="line">    Phone phone3 = <span class="keyword">new</span> UpRightPhone(<span class="keyword">new</span> XiaoMi());</span><br><span class="line">    phone3.open();</span><br><span class="line">    phone3.call();</span><br><span class="line">    phone3.close();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">Vivo手机打开</span></span><br><span class="line"><span class="comment">折叠样式手机</span></span><br><span class="line"><span class="comment">Vivo手机关闭</span></span><br><span class="line"><span class="comment">折叠样式手机</span></span><br><span class="line"><span class="comment">Vivo手机关闭</span></span><br><span class="line"><span class="comment">折叠样式手机</span></span><br><span class="line"><span class="comment">====================</span></span><br><span class="line"><span class="comment">Vivo手机打开</span></span><br><span class="line"><span class="comment">折叠样式手机</span></span><br><span class="line"><span class="comment">Vivo手机关闭</span></span><br><span class="line"><span class="comment">折叠样式手机</span></span><br><span class="line"><span class="comment">Vivo手机关闭</span></span><br><span class="line"><span class="comment">折叠样式手机</span></span><br><span class="line"><span class="comment">=======================</span></span><br><span class="line"><span class="comment">Vivo手机打开</span></span><br><span class="line"><span class="comment">翻盖样式手机</span></span><br><span class="line"><span class="comment">Vivo手机关闭</span></span><br><span class="line"><span class="comment">翻盖样式手机</span></span><br><span class="line"><span class="comment">Vivo手机关闭</span></span><br><span class="line"><span class="comment">翻盖样式手机</span></span><br><span class="line"><span class="comment">=====================</span></span><br><span class="line"><span class="comment">小米手机打开</span></span><br><span class="line"><span class="comment">翻盖样式手机</span></span><br><span class="line"><span class="comment">小米手机关闭</span></span><br><span class="line"><span class="comment">翻盖样式手机</span></span><br><span class="line"><span class="comment">小米手机关闭</span></span><br><span class="line"><span class="comment">翻盖样式手机</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">Process finished with exit code 0</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"> */</span></span><br></pre></td></tr></table></figure>

















<h5 id="桥接模式在JDBC的源码剖析"><a href="#桥接模式在JDBC的源码剖析" class="headerlink" title="桥接模式在JDBC的源码剖析"></a>桥接模式在JDBC的源码剖析</h5><p>桥接模式在JDBC的源码剖析</p>
<ol>
<li>JDBC的Driver接口，如果从桥接模式来看，Driver就是一个皆空，下面有MySQL的Driver，Oracle的Driver，这些就可以当作实现接口类。</li>
</ol>
<p><img src="/images/Java%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/image-20210121153631868.png" alt="image-20210121153631868"></p>
<h5 id="桥接模式的注意事项和细节"><a href="#桥接模式的注意事项和细节" class="headerlink" title="桥接模式的注意事项和细节"></a>桥接模式的注意事项和细节</h5><ol>
<li>实现了抽象和实现部分的分离，从而极大的提供了系统的灵活性，让抽象部分和实现部分独立开来，这有助于系统进行分层设计，从而产生更好的结构化系统。</li>
<li>对于系统的高层部分，只需要知道抽象部分和实现部分的接口就可以了，其它的部分有具体业务来完成。</li>
<li>桥接模式<strong>替代多层继承方案</strong>，可以<strong>减少子类的个数</strong>，降低系统的管理和维护成本。</li>
<li>桥接模式的引入增加了系统的理解和设计难度，由于聚合关联关系建立在抽象层，要求开发者针对抽象进行设计和编程。</li>
<li>桥接模式要求正确识<strong>别出系统中两个独立变化的维度</strong>，因此其使用范围有一定的局限性，即需要有这样的应用场景。</li>
</ol>
<p><strong>桥接模式其它应用场景</strong></p>
<ol>
<li>对于那些不希望使用继承或因为多层次继承导致系统类的个数急剧增加的系统，桥接模式尤为适用。</li>
<li>常见的应用场景：<ul>
<li>JDBC驱动程序</li>
<li>银行转账系统：<ul>
<li>转账分类：网上转账，柜台转账，AMT转账</li>
<li>转账用户类型：普通用户，银行用户，金卡用户…</li>
</ul>
</li>
<li>消息管理：<ul>
<li>消息类型：即使消息，延时消息</li>
<li>消息分类：手机短信，邮件信息，QQ消息…</li>
</ul>
</li>
</ul>
</li>
</ol>
<h4 id="7-装饰者模式"><a href="#7-装饰者模式" class="headerlink" title="7.装饰者模式"></a>7.装饰者模式</h4><p>星巴克咖啡订单项目(咖啡馆)：</p>
<ol>
<li>咖啡种类/单品咖啡：Espresso(意大利浓咖啡)、ShortBlack、LongBlack(美式咖啡)、Decaf(无因咖啡)</li>
<li>调料：Milk、Soy(豆浆)、Chocolate</li>
<li>要求在扩展<strong>新的咖啡种类</strong>时，具有良好的扩展性、改动方便、维护方便</li>
<li>使用OO的方法来计算不同种类咖啡的费用：客户可以点单品咖啡，也可以点单品咖啡+调料组合。</li>
</ol>
<p><strong>方案1：</strong></p>
<p>Drink为抽象类</p>
<p><img src="/images/Java%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/image-20210121181543257.png" alt="image-20210121181543257"></p>
<p>分析：</p>
<ol>
<li>Drink是一个抽象类，表示饮料</li>
<li>description是对咖啡的描述，比如咖啡的名字</li>
<li>cost()方法就是计算费用，Drink类中做成一个抽象方法</li>
<li>Decaf就是单品咖啡，继承Drink，并实现cost()方法</li>
<li>Espress&amp;&amp;Milk就是单品咖啡+调料，这个组合很多</li>
<li>问题：这样设计就会有很多类，当我们增加一个单品咖啡或者新的调料，类的数量就会倍增，就会出现类爆炸</li>
</ol>
<p><strong>方案2：</strong></p>
<p>前面分析到方案1因为<strong>咖啡单品+调料</strong>组合会造成类的倍增，因此可以做改进，将调料内置到Drink类，这样就不会造成类数量过多。从而提高项目的可维护性(如图)。milk，soy，chocolate可以设计为<strong>Boolean</strong>，表示是否要添加相应的调料。</p>
<p><img src="/images/Java%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/image-20210121183619616.png" alt="image-20210121183619616"></p>
<p><strong>问题分析</strong></p>
<ol>
<li>方案2可以控制类的数量，不至于造成很多的类。</li>
<li>在<strong>增加或者删除调料种类</strong>时，代码的维护量很大。</li>
<li>考虑到用户可以添加多份调料时，可以将hasMilk返回一个对应的int</li>
<li>考虑使用装饰者模式。</li>
</ol>
<h5 id="装饰者模式定义"><a href="#装饰者模式定义" class="headerlink" title="装饰者模式定义"></a>装饰者模式定义</h5><ol>
<li>装饰者模式：<strong>动态的将新功能附加到对象上</strong>。在对象功能扩展方面，它比继承更有弹性，装饰者模式也体现了<strong>开闭原则(ocp)</strong></li>
<li>这里提到的动态的将新功能附加到对象和ocp原则，在后面的应用实例上会以代码的形式体现。</li>
</ol>
<h5 id="装饰者模式-Decorator-原理"><a href="#装饰者模式-Decorator-原理" class="headerlink" title="装饰者模式(Decorator)原理"></a>装饰者模式(Decorator)原理</h5><ol>
<li><p>装饰者模式就像<strong>打包一个快递</strong></p>
<p>​    主体(Component(被装饰者))：比如：陶瓷、衣服</p>
<p>​    包装(Decorator(装饰者))：比如：报纸填充、塑料泡沫、纸板、木板</p>
</li>
<li><p>Component：主体：比如类似前面的Drink</p>
</li>
<li><p>ConcreteComponent：具体的主体，比如前面的各个单品咖啡。Decorator：装饰者，比如各调料。</p>
</li>
<li><p>在如图的<strong>Component与ConcreteComponent之间</strong>，如果ConcreteComponent类很多，还可以设计一个缓冲层，将共有的部分提取出来，抽象成一个类。</p>
</li>
</ol>
<p><img src="/images/Java%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/image-20210121192549305.png" alt="image-20210121192549305"></p>
<h5 id="装饰者模式解决星巴克咖啡订单"><a href="#装饰者模式解决星巴克咖啡订单" class="headerlink" title="装饰者模式解决星巴克咖啡订单"></a>装饰者模式解决星巴克咖啡订单</h5><p><img src="/images/Java%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/image-20210203143333816.png" alt="image-20210203143333816"></p>
<p>说明：</p>
<ol>
<li>Drink类就是前面说的抽象类，Component</li>
<li>ShortBlack就是单品咖啡</li>
<li>Decorator是一个装饰类，含有一个被装饰的对象(Drink obj)</li>
<li>Decorator的cost方法进行了一个费用的叠加计算，递归的计算出价格</li>
</ol>
<p><strong>装饰者模式下的订单</strong>：2份巧克力+一份牛奶的LongBlack</p>
<p><img src="/images/Java%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/image-20210121194323869.png" alt="image-20210121194323869"></p>
<p>说明：</p>
<ol>
<li>Milk包含了LongBlack</li>
<li>一份Chocolate包含了(Milk+LongBlack)</li>
<li>一份Chocolate包含了(Chocolate+Milk+LongBlack)</li>
<li>这样不管是什么形式的单品咖啡+调料组合，<strong>通过递归方式可以方便的组合和维护</strong>。</li>
</ol>
<p><strong>项目目录：</strong></p>
<p><img src="/images/Java%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/image-20210203142822857.png" alt="image-20210203142822857"></p>
<p><code>Drink.java</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> DesignPattern.decorator;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> coderYang</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/1/21 19:49</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">Drink</span> </span>&#123;</span><br><span class="line">  <span class="keyword">public</span> String des;    <span class="comment">//描述</span></span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">float</span> price = <span class="number">0.0f</span>;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setDes</span><span class="params">(String des)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.des = des;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setPrice</span><span class="params">(<span class="keyword">float</span> price)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.price = price;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> String <span class="title">getDes</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> des;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">float</span> <span class="title">getPrice</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> price;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//计算费用的抽象方法,被子类调用</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">float</span> <span class="title">cost</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>







<p>抽象层：<code>Coffee.java</code></p>
<p>把各个种类咖啡的共同点=&gt;<strong>咖啡特性</strong>抽取出来，抽象为一个Coffee文件</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> DesignPattern.decorator;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> coderYang</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/1/21 19:51</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Coffee</span> <span class="keyword">extends</span> <span class="title">Drink</span></span>&#123;</span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">float</span> <span class="title">cost</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">super</span>.getPrice();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>









<p><code>ShortBlack.java</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> DesignPattern.decorator;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> coderYang</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/1/21 19:55</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ShortBlack</span> <span class="keyword">extends</span> <span class="title">Coffee</span></span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="title">ShortBlack</span><span class="params">()</span></span>&#123;</span><br><span class="line">    setDes(<span class="string">"short black"</span>);</span><br><span class="line">    setPrice(<span class="number">4.0f</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>







<p><code>Espresso.java</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> DesignPattern.decorator;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> coderYang</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/1/21 19:52</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Espresso</span> <span class="keyword">extends</span> <span class="title">Coffee</span></span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="title">Espresso</span><span class="params">()</span></span>&#123;</span><br><span class="line">    setDes(<span class="string">"意大利咖啡"</span>);</span><br><span class="line">    setPrice(<span class="number">6.0f</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>









<p><code>LongBlack.java</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> DesignPattern.decorator;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> coderYang</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/1/21 19:54</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">LongBlack</span> <span class="keyword">extends</span> <span class="title">Coffee</span></span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="title">LongBlack</span><span class="params">()</span></span>&#123;</span><br><span class="line">    setDes(<span class="string">"long black"</span>);</span><br><span class="line">    setPrice(<span class="number">5.0f</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>









<p>装饰类：<code>Decorator.java</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> DesignPattern.decorator;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> coderYang</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/1/21 19:56</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Decorator</span> <span class="keyword">extends</span> <span class="title">Drink</span></span>&#123;</span><br><span class="line">  <span class="keyword">private</span> Drink obj;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="title">Decorator</span><span class="params">(Drink obj)</span></span>&#123;  <span class="comment">//组合,同生共死是组合</span></span><br><span class="line">    <span class="keyword">this</span>.obj = obj;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">float</span> <span class="title">cost</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">//getPrice是自己的价格</span></span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">super</span>.getPrice() + obj.cost();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> String <span class="title">getDes</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">//obj.getDes()输出被装饰者的信息</span></span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">super</span>.des + <span class="string">" "</span>+<span class="keyword">super</span>.getPrice()+<span class="string">" &amp;&amp; "</span>+obj.getDes();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>













<p><code>Chocolate.java</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> DesignPattern.decorator;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> coderYang</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/1/21 20:04</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="comment">//具体的Decorator,这里指的是调味品</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Chocolate</span> <span class="keyword">extends</span> <span class="title">Decorator</span></span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="title">Chocolate</span><span class="params">(Drink obj)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">super</span>(obj);</span><br><span class="line">    setDes(<span class="string">" 巧克力 "</span>);</span><br><span class="line">    setPrice(<span class="number">3.0f</span>);   <span class="comment">//调味品的价格</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>













<p><code>Milk.java</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> DesignPattern.decorator;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> coderYang</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/1/21 20:06</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Milk</span> <span class="keyword">extends</span> <span class="title">Decorator</span></span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="title">Milk</span><span class="params">(Drink obj)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">super</span>(obj);</span><br><span class="line">    setDes(<span class="string">" 牛奶 "</span>);</span><br><span class="line">    setPrice(<span class="number">2.0f</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>













<p><code>Soy.java</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> DesignPattern.decorator;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> coderYang</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/1/21 20:06</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Soy</span> <span class="keyword">extends</span> <span class="title">Decorator</span></span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="title">Soy</span><span class="params">(Drink obj)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">super</span>(obj);</span><br><span class="line">    setDes(<span class="string">" 豆浆 "</span>);</span><br><span class="line">    setPrice(<span class="number">1.5f</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>















<p><code>CoffeeBar.java</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> DesignPattern.decorator;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> coderYang</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/1/21 20:08</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CoffeeBar</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    <span class="comment">//装饰者模式下订单:2份巧克力+一份牛奶的LongBlack</span></span><br><span class="line">    <span class="comment">//1.点一份LongBlack</span></span><br><span class="line">    Drink order = <span class="keyword">new</span> LongBlack();</span><br><span class="line">    System.out.println(<span class="string">"费用1="</span>+order.cost());</span><br><span class="line">    System.out.println(<span class="string">"描述="</span>+order.getDes());</span><br><span class="line"></span><br><span class="line">    <span class="comment">//2.order 加入一份牛奶</span></span><br><span class="line">    order = <span class="keyword">new</span> Milk(order);</span><br><span class="line">    System.out.println(<span class="string">"加入一份牛奶 费用="</span>+order.cost());</span><br><span class="line">    System.out.println(<span class="string">"加入一份牛奶 描述="</span>+order.getDes());</span><br><span class="line"></span><br><span class="line">    <span class="comment">//3.order 加入一份巧克力</span></span><br><span class="line">    order = <span class="keyword">new</span> Chocolate(order);</span><br><span class="line">    System.out.println(<span class="string">"order 加入一份牛奶,加入一份巧克力 费用="</span>+order.cost());</span><br><span class="line">    System.out.println(<span class="string">"order 加入一份牛奶,加入一份巧克力 描述="</span>+order.getDes());</span><br><span class="line"></span><br><span class="line">    <span class="comment">//4.order 加入一份巧克力</span></span><br><span class="line">    order = <span class="keyword">new</span> Chocolate(order);</span><br><span class="line">    System.out.println(<span class="string">"order 加入一份牛奶 加入两份巧克力 费用="</span>+order.cost());</span><br><span class="line">    System.out.println(<span class="string">"order 加入一份牛奶 加入两份巧克力 描述="</span>+order.getDes());</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>











<p>输出：</p>
<p><img src="/images/Java%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/image-20210203143954016.png" alt="image-20210203143954016"></p>
<h5 id="装饰者模式在JDK应用的源码分析"><a href="#装饰者模式在JDK应用的源码分析" class="headerlink" title="装饰者模式在JDK应用的源码分析"></a>装饰者模式在JDK应用的源码分析</h5><p>Java的IO结构，FilterInputStream就是一个装饰者。</p>
<p><img src="/images/Java%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/image-20210203151415862.png" alt="image-20210203151415862"></p>
<p>FileInputStram是InputStream的子类，类似我们前面的<code>LongBlack,Decaf</code>等。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">InputStream</span> <span class="keyword">implements</span> <span class="title">Closeable</span></span>&#123;&#125;	<span class="comment">//是一个抽象类，即Component。</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">FilterInputStream</span> <span class="keyword">extends</span> <span class="title">InputStream</span></span>&#123;			<span class="comment">//装饰者类Decorator</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">volatile</span> InputStream in;		<span class="comment">//被装饰的对象</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">DataInputStream</span> <span class="keyword">extends</span> <span class="title">FilterInputStream</span> <span class="keyword">implements</span> <span class="title">DataInput</span></span>&#123;&#125;		<span class="comment">//FilterInputStream子类，也继承了被装饰的对象in,它是具体的修饰者,类似于前面的Mile,Soy等</span></span><br></pre></td></tr></table></figure>





<p><img src="/images/Java%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/image-20210203152521681.png" alt="image-20210203152521681"></p>
<h4 id="8-组合模式"><a href="#8-组合模式" class="headerlink" title="8.组合模式"></a>8.组合模式</h4><p>学院院系展示需求：</p>
<p>编写程序展示一个学校院系结构：需求是这样，要在一个页面中展示出学校的院系组成，一个学校有多少个学院，一个学院有多少个系。</p>
<p>传统方案解决学校院系展示(类图)：</p>
<img src="/images/Java%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/image-20210203205135898.png" alt="image-20210203205135898" style="zoom:80%;" />





<h5 id="传统方案解决学校院系展示存在问题的分析"><a href="#传统方案解决学校院系展示存在问题的分析" class="headerlink" title="传统方案解决学校院系展示存在问题的分析"></a>传统方案解决学校院系展示存在问题的分析</h5><ol>
<li>将学院看做是学校的子类，系是学院的子类，这样实际上是站在组织大小来进行分层次的</li>
<li>实际上我们的要求是：在一个页面中展示出学校的院系组成，一个学校有多少个学院，一个学院有多少个系，因此这种方案，不能很好的实现管理的操作，比如对学院、系的添加，删除，遍历等</li>
<li>解决方案：把学校，院，系<strong>都看做</strong>是组织结构，他们之间没有继承的关系，而是一个树形结构，可以更好的实现管理操作=&gt;组合模式</li>
</ol>
<h5 id="组合模式基本介绍"><a href="#组合模式基本介绍" class="headerlink" title="组合模式基本介绍"></a>组合模式基本介绍</h5><ol>
<li>组合模式(Composite Pattern)，又叫部分整体模式，它创建了对象组的树形结构，将对象组合成树状结构以表示”<strong>整体-部分</strong>“的层次关系。</li>
<li>组合模式<strong>依据树形结构来组合对象</strong>，用来表示部分以及整体层次。</li>
<li>这种类型的设计模式属于结构型模式。</li>
<li>组合模式使得用户<strong>对单个对象和组合对象的访问具有一致性</strong>，即：组合能让客户以一致的方式处理对象以及组合对象。</li>
</ol>
<p><img src="/images/Java%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/image-20210203223026587.png" alt="image-20210203223026587"></p>
<ul>
<li><strong>Component</strong>：这是组合中对象声明接口，在适当情况下，实现所有类共有的接口默认行为，用于访问和管理Component子部件，Component可以是抽象类或者接口。</li>
<li><strong>Leaf</strong>：在组合中表示叶子节点，叶子节点没有子结点</li>
<li><strong>Composite</strong>：非叶子节点，用于存储子部件，在Component接口中实现子部件的相关操作，比如增加(add)，删除等操作。</li>
</ul>
<h5 id="组合模式解决的问题"><a href="#组合模式解决的问题" class="headerlink" title="组合模式解决的问题"></a>组合模式解决的问题</h5><ol>
<li><p>组合模式解决这样的问题，当我们要处理的对象可以生成一颗树形结构，而我们要对树上的节点和叶子进行操作时，它能够提供一致的方式，而不用考虑它是节点还是叶子。</p>
</li>
<li><p>对应的示意图：</p>
<img src="/images/Java%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/image-20210203212342984.png" alt="image-20210203212342984" style="zoom:80%;" />















</li>
</ol>
<h5 id="组合模式解决学校院系展示"><a href="#组合模式解决学校院系展示" class="headerlink" title="组合模式解决学校院系展示"></a>组合模式解决学校院系展示</h5><p><img src="/images/Java%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/image-20210203222904479.png" alt="image-20210203222904479"></p>
<p><strong>项目目录</strong></p>
<p><img src="/images/Java%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/image-20210203223116127.png" alt="image-20210203223116127"></p>
<p><code>OrganizationComponent.java</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> DesignPattern.composite;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> coderYang</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/2/3 21:42</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">OrganizationComponent</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">private</span> String name;    <span class="comment">//名字</span></span><br><span class="line">  <span class="keyword">private</span> String desc;    <span class="comment">//说明</span></span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">add</span><span class="params">(OrganizationComponent organizationComponent)</span></span>&#123;</span><br><span class="line">    <span class="comment">//默认实现</span></span><br><span class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> UnsupportedOperationException();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">remove</span><span class="params">(OrganizationComponent organizationComponent)</span></span>&#123;</span><br><span class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> UnsupportedOperationException();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//构造器</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="title">OrganizationComponent</span><span class="params">(String name, String desc)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.name = name;</span><br><span class="line">    <span class="keyword">this</span>.desc = desc;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> name;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.name = name;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> String <span class="title">getDesc</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> desc;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setDesc</span><span class="params">(String desc)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.desc = desc;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//print方法,做成抽象</span></span><br><span class="line">  <span class="function"><span class="keyword">protected</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">print</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>







<p><code>University.java</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> DesignPattern.composite;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> coderYang</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/2/3 21:48</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="comment">//University就是Composite,可以管理College</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">University</span> <span class="keyword">extends</span> <span class="title">OrganizationComponent</span></span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//List中存放的是College</span></span><br><span class="line">  List&lt;OrganizationComponent&gt; organizationComponents = <span class="keyword">new</span> ArrayList&lt;OrganizationComponent&gt;();</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="title">University</span><span class="params">(String name, String desc)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">super</span>(name, desc);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//重写add</span></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">add</span><span class="params">(OrganizationComponent organizationComponent)</span> </span>&#123;</span><br><span class="line">    organizationComponents.add(organizationComponent);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//重写remove方法</span></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">remove</span><span class="params">(OrganizationComponent organizationComponent)</span> </span>&#123;</span><br><span class="line">    organizationComponents.remove(organizationComponent);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">super</span>.getName();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> String <span class="title">getDesc</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">super</span>.getDesc();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//输出University包含的学院</span></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">print</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    System.out.println(<span class="string">"---------"</span>+getName()+<span class="string">"--------"</span>);</span><br><span class="line">    <span class="keyword">for</span> (OrganizationComponent organizationComponent : organizationComponents)&#123;</span><br><span class="line">      System.out.println(organizationComponent.getName());</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>







<p><code>College.java</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> DesignPattern.composite;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> coderYang</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/2/3 21:57</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">College</span> <span class="keyword">extends</span> <span class="title">OrganizationComponent</span></span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//List中存放的是Department</span></span><br><span class="line">  List&lt;OrganizationComponent&gt; organizationComponents = <span class="keyword">new</span> ArrayList&lt;OrganizationComponent&gt;();</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="title">College</span><span class="params">(String name, String desc)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">super</span>(name, desc);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">add</span><span class="params">(OrganizationComponent organizationComponent)</span> </span>&#123;</span><br><span class="line">    <span class="comment">//将来实际业务中,College的add方法和University的add方法不一定完全相同</span></span><br><span class="line">    organizationComponents.add(organizationComponent);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">remove</span><span class="params">(OrganizationComponent organizationComponent)</span> </span>&#123;</span><br><span class="line">    organizationComponents.remove(organizationComponent);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">super</span>.getName();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> String <span class="title">getDesc</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">super</span>.getDesc();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//输出University包含的学院</span></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">print</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    System.out.println(<span class="string">"---------"</span>+getName()+<span class="string">"--------"</span>);</span><br><span class="line">    <span class="keyword">for</span> (OrganizationComponent organizationComponent : organizationComponents)&#123;</span><br><span class="line">      System.out.println(organizationComponent.getName());</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>







<p><code>Department.java</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> DesignPattern.composite;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> coderYang</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/2/3 22:01</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Department</span> <span class="keyword">extends</span> <span class="title">OrganizationComponent</span></span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="title">Department</span><span class="params">(String name, String desc)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">super</span>(name, desc);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//add和remove方法就不用写了,因为Department在此处是叶子节点</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">super</span>.getName();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> String <span class="title">getDesc</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">super</span>.getDesc();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">print</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    System.out.println(getName());</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>











<p><code>Client.java</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> DesignPattern.composite;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> coderYang</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/2/3 22:04</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Client</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    <span class="comment">//从大到小创建对象    学校</span></span><br><span class="line">    OrganizationComponent university = <span class="keyword">new</span> University(<span class="string">"清华大学"</span>, <span class="string">"中国顶级大学"</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//创建学院</span></span><br><span class="line">    OrganizationComponent computerCollege = <span class="keyword">new</span> College(<span class="string">"计算机学院"</span>, <span class="string">"计算即学院"</span>);</span><br><span class="line">    OrganizationComponent infoEngineerCollege = <span class="keyword">new</span> College(<span class="string">"信息工程学院"</span>, <span class="string">"信息工程学院"</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//创建各个学院的系</span></span><br><span class="line">    computerCollege.add(<span class="keyword">new</span> Department(<span class="string">"软件工程"</span>,<span class="string">"对软件的开发"</span>));</span><br><span class="line">    computerCollege.add(<span class="keyword">new</span> Department(<span class="string">"网络工程"</span>,<span class="string">"对网络的应用"</span>));</span><br><span class="line">    computerCollege.add(<span class="keyword">new</span> Department(<span class="string">"计算机科学与技术"</span>,<span class="string">"对计算机进行科学研究"</span>));</span><br><span class="line"></span><br><span class="line">    <span class="comment">//创建信息工程学院的系</span></span><br><span class="line">    infoEngineerCollege.add(<span class="keyword">new</span> Department(<span class="string">"通信工程"</span>,<span class="string">"数据通信方面"</span>));</span><br><span class="line">    infoEngineerCollege.add(<span class="keyword">new</span> Department(<span class="string">"信息工程"</span>,<span class="string">"信息通信方面"</span>));</span><br><span class="line"></span><br><span class="line">    <span class="comment">//将两个学院加入学校中</span></span><br><span class="line">    university.add(computerCollege);</span><br><span class="line">    university.add(infoEngineerCollege);</span><br><span class="line"></span><br><span class="line">    university.print();</span><br><span class="line">    computerCollege.print();</span><br><span class="line">    infoEngineerCollege.print();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>









<p>输出结果：</p>
<p><img src="/images/Java%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/image-20210203223339800.png" alt="image-20210203223339800"></p>
<h5 id="组合模式在JDK集合的源码分析"><a href="#组合模式在JDK集合的源码分析" class="headerlink" title="组合模式在JDK集合的源码分析"></a>组合模式在JDK集合的源码分析</h5><p>Java的集合类HashMap就使用了组合模式</p>
<img src="/images/Java%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/image-20210204132723083.png" alt="image-20210204132723083" style="zoom:80%;" />





<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> JDKSRC;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> coderYang</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/2/3 22:37</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Composite</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    <span class="comment">//1.Map就是一个抽象的构建(类似Component)</span></span><br><span class="line">    <span class="comment">//2.HashMap就是中间的一个构建(Composite),实现/继承了相关方法put,putAll</span></span><br><span class="line">    <span class="comment">//3.Node是HashMap的静态内部类,类似Leaf叶子节点,里面没有put,putAll,remove等方法</span></span><br><span class="line">    Map&lt;Integer,String&gt; hashMap = <span class="keyword">new</span> HashMap&lt;Integer, String&gt;();</span><br><span class="line">    hashMap.put(<span class="number">0</span>,<span class="string">"java"</span>);</span><br><span class="line"></span><br><span class="line">    Map&lt;Integer,String&gt; map = <span class="keyword">new</span> HashMap&lt;Integer, String&gt;();</span><br><span class="line">    map.put(<span class="number">1</span>,<span class="string">"python"</span>);</span><br><span class="line">    map.put(<span class="number">2</span>,<span class="string">"php"</span>);</span><br><span class="line">    hashMap.putAll(map);</span><br><span class="line">    System.out.println(hashMap);</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>















<h5 id="组合模式的注意事项和细节"><a href="#组合模式的注意事项和细节" class="headerlink" title="组合模式的注意事项和细节"></a>组合模式的注意事项和细节</h5><ol>
<li>简化客户端操作。客户端只需要面对一致的对象而不用考虑整体部分或者节点叶子的问题。</li>
<li>具有较强的扩展性。当我们要更改组合对象时，我们只需要调整内部的层次关系，客户端不用做出任何改动。</li>
<li>方便创建出复杂的层次结构。客户端不用理会组合里面的组成细节，容易添加节点或者叶子从而创建出复杂的树形结构</li>
<li>需要<strong>遍历组织机构，或者处理的对象具有树形结构</strong>时，非常<strong>适合用于组合模式</strong></li>
<li>要求较高的抽象性，<strong>如果节点和叶子有很多差异性的话</strong>，比如很多方法和属性都不一样，<strong>不适合使用组合模式</strong>。</li>
</ol>
<h4 id="9-外观模式"><a href="#9-外观模式" class="headerlink" title="9.外观模式"></a>9.外观模式</h4><p><strong>影院管理项目</strong></p>
<p>组件一个家庭影院：</p>
<p>DVD播放器、投影仪、自动屏幕、环绕立体声、爆米花机，要求完成使用家庭影院的功能，其过程为：</p>
<ul>
<li>直接使用遥控器：统筹各设备开关</li>
<li>开爆米花机</li>
<li>放下屏幕</li>
<li>开投影仪</li>
<li>开音响</li>
<li>开DVD，选DVD</li>
<li>去拿爆米花</li>
<li>安调灯光</li>
<li>播放</li>
<li>观影结束后，关闭各种设备</li>
</ul>
<p><strong>传统方式解决影院管理</strong></p>
<p><img src="/images/Java%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/image-20210204140346483.png" alt="image-20210204140346483"></p>
<h5 id="传统方式解决影院管理问题分析"><a href="#传统方式解决影院管理问题分析" class="headerlink" title="传统方式解决影院管理问题分析"></a>传统方式解决影院管理问题分析</h5><ol>
<li>在ClientTest的main方法中，创建各个子系统的对象，并直接去调用子系统(对象)相关方法，会造成调用过程混乱，没有清晰的过程</li>
<li>不利于在ClientTest中，去维护对子系统的操作</li>
<li>解决思路：<strong>定义一个高层接口</strong>，<strong>给子系统中的一组接口提供一个一致的界面</strong>(比如在高层接口提供四个方法ready，play，pause，end)，用来访问子系统中的一群接口</li>
<li>也就是说通过定义一个一致的接口(界面类)，用以屏蔽内部子系统的细节，使得调用端只需跟这个接口发生调用，而无需关心这个子系统的内部细节=&gt;外观模式</li>
</ol>
<h5 id="外观模式基本介绍"><a href="#外观模式基本介绍" class="headerlink" title="外观模式基本介绍"></a>外观模式基本介绍</h5><ol>
<li>外观模式(Facade)，也叫过程模式：外观模式为子系统中的一组接口<strong>提供一个一致的界面</strong>，此模式<strong>定义了一个高层接口</strong>，这个接口使得这一子系统更加容易使用</li>
<li>外观模式通过定义一个一致的接口，用以<strong>屏蔽内部子系统的细节</strong>，使得<strong>调用端只需跟这个接口发生调用</strong>，而无需关系这个子系统的内部细节</li>
</ol>
<p><img src="/images/Java%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/image-20210204143154310.png" alt="image-20210204143154310"></p>
<ul>
<li>外观类(Facede)：为调用端提供统一的调用接口，外观类知道哪些子系统负责处理请求，从而将调用端的请求代理给适当的子系统对象</li>
<li>调用者(Client)：外观接口的调用者</li>
<li>子系统的集合：指模块或者子系统，处理Facade对象指派的任务，它是功能的提供者</li>
</ul>
<h5 id="外观模式解决影院管理"><a href="#外观模式解决影院管理" class="headerlink" title="外观模式解决影院管理"></a>外观模式解决影院管理</h5><ol>
<li>外观模式可以理解为转换一群接口，客户只要调用一个接口，而不调用多个接口才能达到目的。比如：在pc上安装软件的时候经常有一键安装选项(省去选择安装目录、安装的组件等等)，还有就是手机的重启功能(把关机和启动合为一个操作)。</li>
<li>外观模式就是<strong>解决多个复杂接口带来的使用困难，起到简化用户操作的作用</strong></li>
</ol>
<p><img src="/images/Java%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/image-20210204165541105.png" alt="image-20210204165541105"></p>
<p><strong>项目目录</strong></p>
<p><img src="/images/Java%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/image-20210204165600674.png" alt="image-20210204165600674"></p>
<p><code>DVDPlayer.java</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> DesignPattern.facade;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> coderYang</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/2/4 14:34</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DVDPlayer</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//私有构造器</span></span><br><span class="line">  <span class="function"><span class="keyword">private</span> <span class="title">DVDPlayer</span><span class="params">()</span></span>&#123;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//使用单例模式,使用饿汉式</span></span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">static</span> DVDPlayer instance = <span class="keyword">new</span> DVDPlayer();</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> DVDPlayer <span class="title">getInstance</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> instance;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">on</span><span class="params">()</span></span>&#123;</span><br><span class="line">    System.out.println(<span class="string">"DVD on"</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">off</span><span class="params">()</span></span>&#123;</span><br><span class="line">    System.out.println(<span class="string">"DVD off"</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">play</span><span class="params">()</span></span>&#123;</span><br><span class="line">    System.out.println(<span class="string">"DVD is playing"</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">pause</span><span class="params">()</span></span>&#123;</span><br><span class="line">    System.out.println(<span class="string">"DVD pause ..."</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>









<p><code>Popcorn.java</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> DesignPattern.facade;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> coderYang</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/2/4 15:02</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Popcorn</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//私有构造器</span></span><br><span class="line">  <span class="function"><span class="keyword">private</span> <span class="title">Popcorn</span><span class="params">()</span></span>&#123;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//使用单例模式,使用饿汉式</span></span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">static</span> Popcorn instance = <span class="keyword">new</span> Popcorn();</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Popcorn <span class="title">getInstance</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> instance;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">on</span><span class="params">()</span></span>&#123;</span><br><span class="line">    System.out.println(<span class="string">"popcorn on"</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">off</span><span class="params">()</span></span>&#123;</span><br><span class="line">    System.out.println(<span class="string">"popcorn off"</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">pop</span><span class="params">()</span></span>&#123;</span><br><span class="line">    System.out.println(<span class="string">"popcorn is popping"</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>













<p><code>Projector.java</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> DesignPattern.facade;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> coderYang</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/2/4 15:05</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Projector</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//私有构造器</span></span><br><span class="line">  <span class="function"><span class="keyword">private</span> <span class="title">Projector</span><span class="params">()</span></span>&#123;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//使用单例模式,使用饿汉式</span></span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">static</span> Projector instance = <span class="keyword">new</span> Projector();</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Projector <span class="title">getInstance</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> instance;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">on</span><span class="params">()</span></span>&#123;</span><br><span class="line">    System.out.println(<span class="string">"projector on"</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">off</span><span class="params">()</span></span>&#123;</span><br><span class="line">    System.out.println(<span class="string">"projector off"</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">focus</span><span class="params">()</span></span>&#123;</span><br><span class="line">    System.out.println(<span class="string">"projector is focusing"</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>







<p><code>Screen.java</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> DesignPattern.facade;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> coderYang</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/2/4 15:09</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Screen</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//私有构造器</span></span><br><span class="line">  <span class="function"><span class="keyword">private</span> <span class="title">Screen</span><span class="params">()</span></span>&#123;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//使用单例模式,使用饿汉式</span></span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">static</span> Screen instance = <span class="keyword">new</span> Screen();</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Screen <span class="title">getInstance</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> instance;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">up</span><span class="params">()</span></span>&#123;</span><br><span class="line">    System.out.println(<span class="string">"Screen up"</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">down</span><span class="params">()</span></span>&#123;</span><br><span class="line">    System.out.println(<span class="string">"Screen sown"</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>













<p><code>Stereo.java</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> DesignPattern.facade;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> coderYang</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/2/4 16:07</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Stereo</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//私有构造器</span></span><br><span class="line">  <span class="function"><span class="keyword">private</span> <span class="title">Stereo</span><span class="params">()</span></span>&#123;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//使用单例模式,使用饿汉式</span></span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">static</span> Stereo instance = <span class="keyword">new</span> Stereo();</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Stereo <span class="title">getInstance</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> instance;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">on</span><span class="params">()</span></span>&#123;</span><br><span class="line">    System.out.println(<span class="string">"Stereo on"</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">off</span><span class="params">()</span></span>&#123;</span><br><span class="line">    System.out.println(<span class="string">"Stereo off"</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">up</span><span class="params">()</span></span>&#123;</span><br><span class="line">    System.out.println(<span class="string">"Stereo up..."</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">down</span><span class="params">()</span></span>&#123;</span><br><span class="line">    System.out.println(<span class="string">"Stereo down..."</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>











<p><code>TheaterLight.java</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> DesignPattern.facade;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> coderYang</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/2/4 16:11</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TheaterLight</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">private</span> <span class="title">TheaterLight</span><span class="params">()</span></span>&#123;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">static</span> TheaterLight instance = <span class="keyword">new</span> TheaterLight();</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> TheaterLight <span class="title">getInstance</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> instance;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">on</span><span class="params">()</span></span>&#123;</span><br><span class="line">    System.out.println(<span class="string">"TheaterLight on"</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">off</span><span class="params">()</span></span>&#123;</span><br><span class="line">    System.out.println(<span class="string">"TheaterLight off"</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">dim</span><span class="params">()</span></span>&#123;</span><br><span class="line">    System.out.println(<span class="string">"TheaterLight dim..."</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">bright</span><span class="params">()</span></span>&#123;</span><br><span class="line">    System.out.println(<span class="string">"TheaterLight bright..."</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>















<p><code>HomeTheaterFacade.java</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> DesignPattern.facade;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> coderYang</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/2/4 16:20</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HomeTheaterFacade</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//定义各个子系统对象</span></span><br><span class="line">  <span class="keyword">private</span> TheaterLight theaterLight;</span><br><span class="line">  <span class="keyword">private</span> Popcorn popcorn;</span><br><span class="line">  <span class="keyword">private</span> Stereo stereo;</span><br><span class="line">  <span class="keyword">private</span> Projector projector;</span><br><span class="line">  <span class="keyword">private</span> Screen screen;</span><br><span class="line">  <span class="keyword">private</span> DVDPlayer dvdPlayer;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="title">HomeTheaterFacade</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.theaterLight = TheaterLight.getInstance();</span><br><span class="line">    <span class="keyword">this</span>.popcorn = Popcorn.getInstance();</span><br><span class="line">    <span class="keyword">this</span>.stereo = Stereo.getInstance();</span><br><span class="line">    <span class="keyword">this</span>.projector = Projector.getInstance();</span><br><span class="line">    <span class="keyword">this</span>.screen = Screen.getInstance();</span><br><span class="line">    <span class="keyword">this</span>.dvdPlayer = DVDPlayer.getInstance();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//操作分成四步</span></span><br><span class="line">  <span class="comment">//准备操作</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">ready</span><span class="params">()</span></span>&#123;</span><br><span class="line">    popcorn.on();</span><br><span class="line">    popcorn.pop();</span><br><span class="line">    screen.down();</span><br><span class="line">    projector.on();</span><br><span class="line">    stereo.on();</span><br><span class="line">    dvdPlayer.on();</span><br><span class="line">    theaterLight.dim();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//播放</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">play</span><span class="params">()</span></span>&#123;</span><br><span class="line">    dvdPlayer.play();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//暂停操作</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">pause</span><span class="params">()</span></span>&#123;</span><br><span class="line">    dvdPlayer.pause();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//统一结束操作</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">end</span><span class="params">()</span></span>&#123;</span><br><span class="line">    popcorn.off();</span><br><span class="line">    theaterLight.bright();</span><br><span class="line">    screen.up();</span><br><span class="line">    projector.off();</span><br><span class="line">    stereo.off();</span><br><span class="line">    dvdPlayer.off();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>











<p><code>Client.java</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> DesignPattern.facade;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> coderYang</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/2/4 16:15</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Client</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    HomeTheaterFacade homeTheaterFacade = <span class="keyword">new</span> HomeTheaterFacade();</span><br><span class="line">    homeTheaterFacade.ready();</span><br><span class="line">    homeTheaterFacade.play();</span><br><span class="line">    homeTheaterFacade.end();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<p>运行结果：</p>
<p><img src="/images/Java%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/image-20210204165850682.png" alt="image-20210204165850682"></p>
<h5 id="外观模式在Mybatis框架应用的源码分析"><a href="#外观模式在Mybatis框架应用的源码分析" class="headerlink" title="外观模式在Mybatis框架应用的源码分析"></a>外观模式在Mybatis框架应用的源码分析</h5><p>Mybatis中的Configuration去创建MetaObject对象使用到外观模式</p>
<p><img src="/images/Java%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/image-20210204185747433.png" alt="image-20210204185747433"></p>
<h5 id="外观模式的注意事项和细节"><a href="#外观模式的注意事项和细节" class="headerlink" title="外观模式的注意事项和细节"></a>外观模式的注意事项和细节</h5><ol>
<li>外观模式<strong>对外屏蔽了子系统的细节</strong>，因此外观模式降低了客户端对于子系统使用的复杂性</li>
<li>外观模式对客户端与子系统的耦合关系-<strong>解耦</strong>，让子系统内部的模块更易于维护和扩展</li>
<li>通过合理的使用外观模式，可以帮助我们更好的<strong>划分访问的层次</strong></li>
<li>当系统需要进行分层设计时，可以考虑使用Facade模式</li>
<li>在维护一个遗留的大型系统时，可能这个系统已经变得非常难以维护和扩展，此时可以考虑为新系统开发一个Facade类，来提供遗留系统的比较清晰简单的接口，让新系统与Facade类交互，提高复用性</li>
<li>不能过多的或者不合理的使用外观模式，使用外观模式好，还是直接调用模块好。要以让系统有层次，利于维护为目的。</li>
<li><strong>调用子系统很麻烦的时候，就使用外观模式</strong></li>
</ol>
<h4 id="10-享元模式"><a href="#10-享元模式" class="headerlink" title="10.享元模式"></a>10.享元模式</h4><p><strong>展示网站项目需求</strong></p>
<p>小型的外包项目，给客户A做一个产品展示网站，客户A的朋友感觉效果不错，也希望做这样的产品展示网站，但是要求有些不同：</p>
<ol>
<li>有客户要求以新闻的形式发布</li>
<li>有客户要求以博客的形式发布</li>
<li>有客户希望以微信公众号的形式发布</li>
</ol>
<p><strong>传统方式解决网站展现项目</strong></p>
<p><img src="/images/Java%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/image-20210205125927179.png" alt="image-20210205125927179"></p>
<h5 id="传统方式解决网站展现项目-问题分析"><a href="#传统方式解决网站展现项目-问题分析" class="headerlink" title="传统方式解决网站展现项目-问题分析"></a>传统方式解决网站展现项目-问题分析</h5><ol>
<li>需要的网站结构相似度很高，而且都不是高访问量网站，如果分成多个虚拟空间来处理，相当于一个相同网站的实例对象很多，造成服务器的资源浪费</li>
<li>解决思路：整合到一个网站中，共享其相关代码和数据，对于硬盘、内存、CPU、数据库空间等服务器资源都可以达成共享，减少服务器资源</li>
<li>对于代码来说，由于是一份实例，维护和扩展更加容易</li>
<li>上面的解决思路就可以使用<strong>享元模式</strong>来解决</li>
</ol>
<h5 id="享元模式基本介绍"><a href="#享元模式基本介绍" class="headerlink" title="享元模式基本介绍"></a>享元模式基本介绍</h5><ol>
<li>享元模式(Flyweight Pattern)也叫蝇量模式：运用共享的技术有效地支持大量细粒度地对象</li>
<li>常用于系统底层开发，解决系统的性能问题。像<strong>数据库连接池</strong>，里面都是创建好的连接对象，在这些连接对象中有我们需要的则直接拿来用，避免重复创建，如果没有我们需要的，则创建一个</li>
<li>享元模式能够解决<strong>重复对象的内存浪费问题</strong>，当系统中有大量相似对象，需要缓存池时。不需要总是创建新对象，可以从缓冲池里拿。这样可以降低系统内存，同时提高效率</li>
<li>享元模式<strong>经典的应用场景</strong>就是<strong>池技术</strong>了，String常量池、数据库连接池、缓冲池等等都是享元模式的应用，享元模式时池技术的重要实现方式。</li>
</ol>
<img src="/images/Java%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/image-20210205132342610.png" alt="image-20210205132342610" style="zoom: 67%;" />













<p><img src="/images/Java%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/image-20210205133424317.png" alt="image-20210205133424317"></p>
<ul>
<li>Flyweight：是抽象的享元角色，他是产品的抽象类，同时定义出对象的外部状态和内部状态的接口或实现</li>
<li>ConcreteFlyWeight：是具体的享元角色，是具体的产品类，实现抽象角色定义的相关业务</li>
<li>UnShareConcreteFlyWeight：是不可共享的角色，一般不出现在享元工厂。</li>
<li>FlyWeightFactory：享元工厂类，用于构建一个池容器(集合)，同时提供从池中获取对象方法</li>
</ul>
<p><strong>内部状态和外部状态</strong></p>
<p>比如围棋、五子棋、跳棋，它们都有大量的棋子对象，围棋和五子棋只有黑白两色，跳棋颜色多一点，所以棋子颜色就是棋子的内部状态；而各个棋子之间的差别就是位置不同，当我们落子后，落子颜色是固定的，但位置是变化的，所以棋子坐标就是棋子的外部状态。</p>
<ol>
<li>享元模式提出了两个要求：细粒度和共享对象。这里就涉及到内部状态和外部状态了，即将对象的信息分为两个部分：<strong>内部状态</strong>和<strong>外部状态</strong></li>
<li><strong>内部状态</strong>指对象共享出来的信息，存储在享元对象内部且不会随环境的改变而改变</li>
<li><strong>外部状态</strong>指对象得以依赖一个标记，是随环境改变而改变的、不可共享的状态</li>
<li>举个例子：围棋理论上有361个空位可以放棋子，每盘棋都有可能有两三百个棋子对象产生，因为内存空间有限，一台服务器很难支持更多的玩家玩围棋游戏，如果用享元模式来处理棋子，那么棋子对象就可以减少到只有两个实例，这样就很好的解决了对象的开销问题。</li>
</ol>
<h5 id="享元模式解决网站外包问题"><a href="#享元模式解决网站外包问题" class="headerlink" title="享元模式解决网站外包问题"></a>享元模式解决网站外包问题</h5><p><img src="/images/Java%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/image-20210205152549932.png" alt="image-20210205152549932"></p>
<p><strong>项目目录</strong></p>
<p><img src="/images/Java%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/image-20210205152739682.png" alt="image-20210205152739682"></p>
<p><code>WebSite.java</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> DesignPattern.flyweight;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> coderYang</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/2/5 14:57</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">WebSite</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">use</span><span class="params">(User user)</span></span>;     <span class="comment">//抽象方法</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>







<p><code>ConcreteWebSite.java</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> DesignPattern.flyweight;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> coderYang</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/2/5 14:58</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="comment">//具体的网站</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ConcreteWebSite</span> <span class="keyword">extends</span> <span class="title">WebSite</span></span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//共享的部分(内部状态)</span></span><br><span class="line">  <span class="keyword">private</span> String type = <span class="string">""</span>;   <span class="comment">//网站发布的形式(类型)</span></span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="title">ConcreteWebSite</span><span class="params">(String type)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.type = type;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">use</span><span class="params">(User user)</span> </span>&#123;</span><br><span class="line">    System.out.println(<span class="string">"网站的发布形式为:"</span>+type+<span class="string">"|"</span>+<span class="string">"使用者是:"</span>+user.getName());</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>









<p><code>User.java</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> DesignPattern.flyweight;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> coderYang</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/2/5 15:15</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">private</span> String name;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="title">User</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.name = name;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> name;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.name = name;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>











<p><code>WebSiteFactory.java</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> DesignPattern.flyweight;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> coderYang</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/2/5 15:00</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="comment">//网站工厂类,根据需求返回一个具体的网站</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">WebSiteFactory</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//集合,充当池的作用</span></span><br><span class="line">  <span class="keyword">private</span> HashMap&lt;String,ConcreteWebSite&gt; pool = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line"></span><br><span class="line">  <span class="comment">//根据网站的类型,返回一个网站,如果没有就创建一个网站,并放入到池中</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> WebSite <span class="title">getWebSiteCategory</span><span class="params">(String type)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!pool.containsKey(type))&#123;</span><br><span class="line">      <span class="comment">//创建一个并放入池中</span></span><br><span class="line">      pool.put(type,<span class="keyword">new</span> ConcreteWebSite(type));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> (WebSite)pool.get(type);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//获取网站分类的总数(池中有多少个网站类型)</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getWebSiteCount</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> pool.size();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>











<p><code>Client.java</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> DesignPattern.flyweight;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> coderYang</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/2/5 15:08</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Client</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    <span class="comment">//创建一个工厂类</span></span><br><span class="line">    WebSiteFactory factory = <span class="keyword">new</span> WebSiteFactory();</span><br><span class="line"></span><br><span class="line">    <span class="comment">//以一个新闻形式发布的网站</span></span><br><span class="line">    WebSite newsWebsite = factory.getWebSiteCategory(<span class="string">"新闻"</span>);</span><br><span class="line">    newsWebsite.use(<span class="keyword">new</span> User(<span class="string">"小明"</span>));</span><br><span class="line"></span><br><span class="line">    <span class="comment">//以一个博客形式发布的发布的网站</span></span><br><span class="line">    WebSite blogWebsite = factory.getWebSiteCategory(<span class="string">"博客"</span>);</span><br><span class="line">    blogWebsite.use(<span class="keyword">new</span> User(<span class="string">"小红"</span>));</span><br><span class="line"></span><br><span class="line">    <span class="comment">//再以一个形式发布的网站</span></span><br><span class="line">    WebSite blogWebsite2 = factory.getWebSiteCategory(<span class="string">"博客"</span>);</span><br><span class="line">    blogWebsite2.use(<span class="keyword">new</span> User(<span class="string">"coderYang"</span>));</span><br><span class="line"></span><br><span class="line">    <span class="comment">//再以一个形式发布的网站</span></span><br><span class="line">    WebSite blogWebsite3 = factory.getWebSiteCategory(<span class="string">"博客"</span>);</span><br><span class="line">    blogWebsite3.use(<span class="keyword">new</span> User(<span class="string">"路人甲"</span>));</span><br><span class="line"></span><br><span class="line">    System.out.println(<span class="string">"网站的分类共有:"</span>+factory.getWebSiteCount());</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>









<p>运行结果：</p>
<p><img src="/images/Java%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/image-20210205152933690.png" alt="image-20210205152933690"></p>
<h5 id="享元模式在JDK-Integral的应用源码分析"><a href="#享元模式在JDK-Integral的应用源码分析" class="headerlink" title="享元模式在JDK-Integral的应用源码分析"></a>享元模式在JDK-Integral的应用源码分析</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> JDKSRC;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> coderYang</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/2/5 15:31</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">FlyWeight</span> </span>&#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Integer在常量池的缓存范围是-128~127</span></span><br><span class="line"><span class="comment">     * 如果Integral.valueOf(x),x在-127~128之间,就通过享元模式返回对象</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    Integer x = Integer.valueOf(<span class="number">127</span>);</span><br><span class="line">    Integer y = <span class="keyword">new</span> Integer(<span class="number">127</span>);</span><br><span class="line">    Integer z = Integer.valueOf(<span class="number">127</span>);</span><br><span class="line">    Integer w = <span class="keyword">new</span> Integer(<span class="number">127</span>);</span><br><span class="line">    System.out.println(x.equals(y));      <span class="comment">//比较大小,true</span></span><br><span class="line">    System.out.println(x == y);     <span class="comment">//false</span></span><br><span class="line">    System.out.println(x == z);     <span class="comment">//true</span></span><br><span class="line">    System.out.println(w == z);     <span class="comment">//false</span></span><br><span class="line">    System.out.println(w == y);     <span class="comment">//false</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">//不在范围内,没有使用享元模式返回对象,而是新建了一个对象</span></span><br><span class="line">    Integer x1 = Integer.valueOf(<span class="number">128</span>);</span><br><span class="line">    Integer x2 = Integer.valueOf(<span class="number">128</span>);</span><br><span class="line">    System.out.println(x1 == x2);     <span class="comment">//false</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<p><img src="/images/Java%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/image-20210205154755088.png" alt="image-20210205154755088"></p>
<p><img src="/images/Java%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/image-20210205154821701.png" alt="image-20210205154821701"></p>
<p>总结：</p>
<p><code>valueOf</code>方法使用到享元模式，执行速度要比new对象快，还节省内存。</p>
<h5 id="享元模式的注意事项和细节"><a href="#享元模式的注意事项和细节" class="headerlink" title="享元模式的注意事项和细节"></a>享元模式的注意事项和细节</h5><ol>
<li>在享元模式这样理解，”享”就表示共享，”元”表示对象</li>
<li>系统中有大量对象，这些对象消耗大量的内存，并且对象的状态大部分可以外部化时，我们就可以考虑选用享元模式</li>
<li>用<strong>唯一标识码判断</strong>，如果在内存中有，则返回这个唯一标识码所标识的对象，用<code>HashMap</code>/<code>HashTable</code>存储</li>
<li>享元模式大大减少了对象的创建，降低了程序内存的占用，提高效率</li>
<li>享元模式提高了系统的复杂度。<strong>需要分离出内部状态和外部状态</strong>，而外部状态具有固化特性，不应该随着内部状态的改变而改变，这就是我们<strong>使用享元模式需要注意的</strong>。</li>
<li>使用享元模式时，注意划分内部状态和外部状态，并且需要有一个工厂类加以控制。</li>
<li>享元模式经典的应用场景是需要缓冲池的场景，比如String常量池、数据库连接池</li>
</ol>
<h4 id="11-代理模式"><a href="#11-代理模式" class="headerlink" title="11.代理模式"></a>11.代理模式</h4><h5 id="代理模式基本介绍"><a href="#代理模式基本介绍" class="headerlink" title="代理模式基本介绍"></a>代理模式基本介绍</h5><ol>
<li>代理模式：为一个对象<strong>提供一个替身</strong>，以控制对这个对象的访问。即通过代理对象访问目标对象。这样做的好处是：可以在目标对象实现的基础上，增强额外的功能操作，即扩展目标对象的功能。</li>
<li>被代理的对象可以是<strong>远程对象</strong>、<strong>创建开销大的对象</strong>或者<strong>需要安全控制的对象</strong></li>
<li>代理模式有不同的形式，主要有三种：<strong>静态代理</strong>、<strong>动态代理(JDK代理、接口代理)</strong>和<strong>Cglib代理(可以在内存中动态创建对象,而不需要实现接口，他是属于动态代理的范畴)</strong>。</li>
</ol>
<h5 id="静态代理"><a href="#静态代理" class="headerlink" title="静态代理"></a>静态代理</h5><p>静态代理在使用时，需要定义接口或者父类，被代理对象(即目标对象)与代理对象一起实现相同的接口或者继承相同父类</p>
<p><strong>应用实例</strong></p>
<p>具体要求：</p>
<ol>
<li>定义一个接口：ITeacherDao</li>
<li>目标对象TeacherDao实现接口ITeacherDao</li>
<li>使用静态代理方式，就需要在代理对象TeacherDaoProxy中实现ITeacherDao</li>
<li>调用的时候通过调用代理对象的方法来调用目标对象</li>
<li><strong>特别提醒</strong>：代理对象与目标对象要实现相同的接口，然后通过调用相同的方法来调用目标对象的方法。</li>
</ol>
<p><img src="/images/Java%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/image-20210206145527362.png" alt="image-20210206145527362"></p>
<p><strong>项目目录</strong></p>
<p><img src="/images/Java%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/image-20210206145646434.png" alt="image-20210206145646434"></p>
<p><code>ITeacherDao.java</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> DesignPattern.proxy.staticproxy;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> coderYang</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/2/6 14:44</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">ITeacherDao</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">void</span> <span class="title">teach</span><span class="params">()</span></span>;     <span class="comment">//授课方法</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>









<p><code>TeacherDao.java</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> DesignPattern.proxy.staticproxy;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> coderYang</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/2/6 14:45</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TeacherDao</span> <span class="keyword">implements</span> <span class="title">ITeacherDao</span></span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">teach</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">//老师授课中</span></span><br><span class="line">    System.out.println(<span class="string">"老师授课中"</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>







<p><code>TeacherDaoProxy.java</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> DesignPattern.proxy.staticproxy;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> coderYang</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/2/6 14:46</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="comment">//代理对象,静态代理</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TeacherDaoProxy</span> <span class="keyword">implements</span> <span class="title">ITeacherDao</span></span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">private</span> ITeacherDao target;     <span class="comment">//目标对象,通过接口来聚合</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">//构造器</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="title">TeacherDaoProxy</span><span class="params">(ITeacherDao target)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.target = target;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">teach</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    System.out.println(<span class="string">"代理开始...正在完成某些操作..."</span>);</span><br><span class="line">    target.teach();</span><br><span class="line">    System.out.println(<span class="string">"提交..."</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>







<p><code>Client.java</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> DesignPattern.proxy.staticproxy;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> coderYang</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/2/6 14:51</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Client</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    <span class="comment">//创建目标对象(被代理对象)</span></span><br><span class="line">    TeacherDao teacherDao = <span class="keyword">new</span> TeacherDao();</span><br><span class="line"></span><br><span class="line">    <span class="comment">//创建被代理对象,同时将被代理对象传递给代理对象</span></span><br><span class="line">    TeacherDaoProxy teacherDaoProxy = <span class="keyword">new</span> TeacherDaoProxy(teacherDao);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//通过代理对象方法,就是调用了被代理对象的方法,只是我们在代理对象中加了一些操作</span></span><br><span class="line">    teacherDaoProxy.teach();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<p>运行结果：</p>
<p><img src="/images/Java%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/image-20210206145816498.png" alt="image-20210206145816498"></p>
<p><strong>静态代理优缺点</strong></p>
<ol>
<li>优点：在不修改目标对象的功能前提下，能通过代理对象目标功能扩展</li>
<li>缺点：因为代理对象需要与目标对象实现一样的接口，所以会有很多代理类。一旦接口增加方法，目标对象与代理对象都要维护。</li>
</ol>
<h5 id="动态代理"><a href="#动态代理" class="headerlink" title="动态代理"></a>动态代理</h5><p>动态代理基本介绍：</p>
<ol>
<li>代理对象不需要实现接口，但是目标对象要实现接口，否则不能用动态代理</li>
<li>代理对象的生成，是利用JDK的API，动态的在内存中构建代理对象</li>
<li>动态代理也叫做：JDK代理、接口代理</li>
</ol>
<p>JDK中生成代理对象的API</p>
<ol>
<li><p>代理类所在包：<code>java.lang.reflect.Proxy</code></p>
</li>
<li><p>JDK实现代理只需要使用newProxyInstance方法，但是该方法需要接收三个参数:</p>
<p>完整的写法是：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">static</span> Object <span class="title">newProxyInstance</span><span class="params">(ClassLoader loader,Class&lt;?&gt;[] interfaces,InvocationHandler h)</span></span></span><br></pre></td></tr></table></figure>









</li>
</ol>
<p><strong>应用实例</strong></p>
<p>将前面的静态代理改为动态代理模式(即JDK代理模式)</p>
<p><img src="/images/Java%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/image-20210206155843113.png" alt="image-20210206155843113"></p>
<p><strong>项目目录</strong></p>
<p><img src="/images/Java%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/image-20210206155926358.png" alt="image-20210206155926358"></p>
<p><code>ITeacherDao.java</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> DesignPattern.proxy.dynamicproxy;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> coderYang</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/2/6 15:26</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">ITeacherDao</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">void</span> <span class="title">teach</span><span class="params">(String name)</span></span>;     <span class="comment">//授课方法</span></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>







<p><code>TeacherDao.java</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> DesignPattern.proxy.dynamicproxy;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> coderYang</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/2/6 15:27</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TeacherDao</span> <span class="keyword">implements</span> <span class="title">ITeacherDao</span></span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">teach</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">    System.out.println(name+<span class="string">"老师正在授课..."</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>









<p><code>ProxyFactory.java</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> DesignPattern.proxy.dynamicproxy;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.InvocationHandler;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Method;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Proxy;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> coderYang</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/2/6 15:28</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ProxyFactory</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//维护一个目标对象,Object</span></span><br><span class="line">  <span class="keyword">private</span> Object target;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//通过构造器,传入目标对象</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="title">ProxyFactory</span><span class="params">(Object target)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.target = target;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//给目标对象生成一个代理对象</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> Object <span class="title">getProxyInstance</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 参数说明</span></span><br><span class="line"><span class="comment">     * 1.ClassLoader loader:指定当前目标对象使用的类加载器,获取加载器的方法固定</span></span><br><span class="line"><span class="comment">     * 2.Class&lt;?&gt;[] interfaces:目标对象实现的接口类型,使用泛型的方式确认类型</span></span><br><span class="line"><span class="comment">     * 3.InvocationHandler h:事件处理,执行目标对象方法时,会触发事件处理器方法,</span></span><br><span class="line"><span class="comment">     *   会把当前执行的目标对象方法作为参数传入</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">return</span> Proxy.newProxyInstance(target.getClass().getClassLoader(),</span><br><span class="line">            target.getClass().getInterfaces(),</span><br><span class="line">            <span class="keyword">new</span> InvocationHandler() &#123;</span><br><span class="line">              <span class="meta">@Override</span></span><br><span class="line">              <span class="function"><span class="keyword">public</span> Object <span class="title">invoke</span><span class="params">(Object proxy, Method method, Object[] args)</span> <span class="keyword">throws</span> Throwable </span>&#123;</span><br><span class="line">                System.out.println(<span class="string">"JDK代理开始..."</span>);</span><br><span class="line">                <span class="comment">//反射机制调用目标对象的方法</span></span><br><span class="line">                Object res = method.invoke(target, args);</span><br><span class="line">                System.out.println(<span class="string">"方法:"</span>+method+<span class="string">",参数:"</span>+args[<span class="number">0</span>].toString());</span><br><span class="line">                System.out.println(<span class="string">"JDK代理提交..."</span>);</span><br><span class="line">                <span class="keyword">return</span> res;</span><br><span class="line">              &#125;</span><br><span class="line">            &#125;);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>











<p><code>Client.java</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> DesignPattern.proxy.dynamicproxy;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> coderYang</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/2/6 15:46</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Client</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    <span class="comment">//1.创建一个目标对象</span></span><br><span class="line">    ITeacherDao target = <span class="keyword">new</span> TeacherDao();</span><br><span class="line"></span><br><span class="line">    <span class="comment">//给目标对象创建代理对象</span></span><br><span class="line">    ITeacherDao proxyInstance = (ITeacherDao) <span class="keyword">new</span> ProxyFactory(target).getProxyInstance();</span><br><span class="line"></span><br><span class="line">    System.out.println(proxyInstance.getClass());</span><br><span class="line">    proxyInstance.teach(<span class="string">"coderYang"</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>







<p><strong>运行结果</strong></p>
<p><img src="/images/Java%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/image-20210206161840874.png" alt="image-20210206161840874"></p>
<h5 id="Cglib代理"><a href="#Cglib代理" class="headerlink" title="Cglib代理"></a>Cglib代理</h5><p>Cglib代理模式的基本介绍</p>
<ol>
<li>静态代理和JDK代理模式都要求目标对象是实现一个接口，但是有时候目标对象只是一个单独的对象，并没有实现任何的接口，这个时候可使用目标对象子类来实现代理，这就是Cglib代理</li>
<li>Cglib代理也叫<strong>子类代理</strong>，它是在内存中构建一个子类对象从而实现对目标对象功能扩展，有些书也将Cglib代理归属到动态代理。</li>
<li>Cglib是一个强大的高性能的代码生成包，它可以在运行期扩展java类与实现java接口，它广泛的被许多AOP的框架使用，例如Spring AOP，实现方法拦截</li>
<li>在AOP编程中如何选择代理模式：<ol>
<li><strong>目标对象需要实现接口，用JDK代理</strong></li>
<li><strong>目标对象不需要实现接口，用Cglib代理</strong></li>
</ol>
</li>
<li>Cglib包的底层是通过字节码处理框架ASM来转换字节码并生成新的类。</li>
</ol>
<p><strong>Cglib实现步骤</strong></p>
<ol>
<li><p>需要引入Cglib的jar文件</p>
<p><img src="/images/Java%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/image-20210206172903068.png" alt="image-20210206172903068"></p>
</li>
<li><p>在内存中动态构建子类，注意代理的类不能为final，否则报错</p>
</li>
<li><p>目标对象的方法如果为final/static，那么就不会被拦截，即不会执行目标对象额外的业务方法。</p>
</li>
</ol>
<p><img src="/images/Java%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/image-20210206172956915.png" alt="image-20210206172956915"></p>
<p><code>TeacherDao.java</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> DesignPattern.proxy.cglib;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> coderYang</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/2/6 16:50</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TeacherDao</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">teach</span><span class="params">()</span></span>&#123;</span><br><span class="line">    System.out.println(<span class="string">"老师授课中,我是cglib代理,不需要实现接口"</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>









<p><code>ProxyFactory.java</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> DesignPattern.proxy.cglib;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> net.sf.cglib.proxy.Enhancer;</span><br><span class="line"><span class="keyword">import</span> net.sf.cglib.proxy.MethodInterceptor;</span><br><span class="line"><span class="keyword">import</span> net.sf.cglib.proxy.MethodProxy;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Method;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> coderYang</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/2/6 16:51</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ProxyFactory</span> <span class="keyword">implements</span> <span class="title">MethodInterceptor</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//维护一个目标对象</span></span><br><span class="line">  <span class="keyword">private</span> Object target;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//构造器,传入一个被代理的对象</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="title">ProxyFactory</span><span class="params">(Object target)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.target = target;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//返回一个代理对象,是target对象的代理对象</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> Object <span class="title">getProxyInstance</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="comment">//1.创建一个工具类</span></span><br><span class="line">    Enhancer enhancer = <span class="keyword">new</span> Enhancer();</span><br><span class="line">    <span class="comment">//2.设置父类</span></span><br><span class="line">    enhancer.setSuperclass(target.getClass());</span><br><span class="line">    <span class="comment">//3.设置回调函数</span></span><br><span class="line">    enhancer.setCallback(<span class="keyword">this</span>);</span><br><span class="line">    <span class="comment">//4.创建子类对象,即代理对象</span></span><br><span class="line">    <span class="keyword">return</span> enhancer.create();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//重写intercept方法,会调用目标对象的方法</span></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> Object <span class="title">intercept</span><span class="params">(Object o, Method method, Object[] objects, MethodProxy methodProxy)</span> <span class="keyword">throws</span> Throwable </span>&#123;</span><br><span class="line">    System.out.println(<span class="string">"Cglib代理模式开始..."</span>);</span><br><span class="line">    Object returnVal = method.invoke(target, objects);</span><br><span class="line">    System.out.println(<span class="string">"Cglib代理模式提交..."</span>);</span><br><span class="line">    <span class="keyword">return</span> returnVal;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<p><code>Client.java</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> DesignPattern.proxy.cglib;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> coderYang</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/2/6 17:07</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Client</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    <span class="comment">//创建目标对象</span></span><br><span class="line">    TeacherDao target = <span class="keyword">new</span> TeacherDao();</span><br><span class="line">    <span class="comment">//获取到代理对象,并且将目标对象传递给代理对象</span></span><br><span class="line">    TeacherDao proxyInstance = (TeacherDao) <span class="keyword">new</span> ProxyFactory(target).getProxyInstance();</span><br><span class="line">    <span class="comment">//执行代理对象的方法,触发intercept方法,从而实现对目标对象的调用</span></span><br><span class="line">    proxyInstance.teach();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>









<p>运行结果：</p>
<p><img src="/images/Java%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/image-20210206173056257.png" alt="image-20210206173056257"></p>
<h5 id="代理模式的变体"><a href="#代理模式的变体" class="headerlink" title="代理模式的变体"></a>代理模式的变体</h5><p>几种常见的代理模式介绍——几种变体</p>
<p><strong>1.防火墙代理</strong></p>
<p>​    内网通过代理穿透防火墙，实现对公网的访问。</p>
<p><strong>2.缓存代理</strong></p>
<p>​    比如：当请求图片文件等资源时，先到缓存代理取，如果领取到资源则ok，如果领取不到资源，再到公网或者数据库取，然后缓存。</p>
<p><strong>3.远程代理</strong></p>
<p>​    <strong>远程代理的本地代表</strong>，通过它可以把<strong>远程对象当作本地对象</strong>来调用。远程代理通过网络和真正的远程对象沟通信息。</p>
<p><strong>4.同步代理</strong></p>
<p>​    主要使用在多线程编程中，完成多线程间同步工作。</p>
<h4 id="12-模板方法模式"><a href="#12-模板方法模式" class="headerlink" title="12.模板方法模式"></a>12.模板方法模式</h4><p>豆浆制作问题：</p>
<p>编写制作豆浆的程序，说明如下：</p>
<ol>
<li>制作豆浆的流程：选材–&gt;添加配料–&gt;浸泡–&gt;放到豆浆机打碎</li>
<li>通过添加不同的配料，可以制作出不同口味的豆浆</li>
<li>选材、浸泡和放到豆浆机打碎这几个步骤对于制作每种口味的豆浆都是一样的</li>
<li>请使用<strong>模板方法模式</strong>完成(说明：因为模板方法模式，比较简单，很容易就想到这个方案，因此就直接使用，不再使用传统的方案来引出模板方法模式)</li>
</ol>
<h5 id="模板模式基本介绍"><a href="#模板模式基本介绍" class="headerlink" title="模板模式基本介绍"></a>模板模式基本介绍</h5><ol>
<li>模板方法模式(Template Method Pattern)，又叫模板模式(Template Pattern)，在一个抽象类公开定义了执行它的方法的模板。它的子类可以按需要重写方法实现，但调用将以抽象类中定义的方式进行。</li>
<li>简单的说，<strong>模板方法模式</strong>定义一个操作中的算法的骨架，而将一些步骤延迟到子类中，使得子类可以不改变一个算法的结构，就可以重定义该算法的某些特定步骤</li>
<li>这种类型的设计模式属于行为型模式。</li>
</ol>
<p><img src="/images/Java%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/image-20210207132407190.png" alt="image-20210207132407190"></p>
<ul>
<li>AbstractClass：是一个抽象类，类中实现了模板方法，定义了算法的骨架，具体子类需要去实现其它的一些抽象方法operation2,3,4</li>
<li>ConcreteClass：实现抽象方法operation2，3，4，以完成算法中特定子类的步骤</li>
</ul>
<h5 id="模板方法模式解决豆浆制作问题"><a href="#模板方法模式解决豆浆制作问题" class="headerlink" title="模板方法模式解决豆浆制作问题"></a>模板方法模式解决豆浆制作问题</h5><p><img src="/images/Java%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/image-20210207140259935.png" alt="image-20210207140259935"></p>
<p><strong>项目目录</strong></p>
<p><img src="/images/Java%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/image-20210207140317943.png" alt="image-20210207140317943"></p>
<p><code>SoyaMilk.java</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> DesignPattern.template;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> coderYang</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/2/7 13:34</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">SoyaMilk</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//模板方法,make,模板方法可以作为final,不让子类去覆盖</span></span><br><span class="line">  <span class="function"><span class="keyword">final</span> <span class="keyword">void</span> <span class="title">make</span><span class="params">()</span></span>&#123;</span><br><span class="line">    select();</span><br><span class="line">    addCondiments();</span><br><span class="line">    soak();</span><br><span class="line">    beat();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//选材料</span></span><br><span class="line">  <span class="function"><span class="keyword">void</span> <span class="title">select</span><span class="params">()</span></span>&#123;</span><br><span class="line">    System.out.println(<span class="string">"第一步:选择新鲜黄豆"</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//添加不同配料,抽象方法,子类具体实现</span></span><br><span class="line">  <span class="function"><span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">addCondiments</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//浸泡</span></span><br><span class="line">  <span class="function"><span class="keyword">void</span> <span class="title">soak</span><span class="params">()</span></span>&#123;</span><br><span class="line">    System.out.println(<span class="string">"第三步:黄豆和配料开始浸泡,三个小时"</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">void</span> <span class="title">beat</span><span class="params">()</span></span>&#123;</span><br><span class="line">    System.out.println(<span class="string">"第四步:黄豆和配料放到豆浆机去打碎"</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>







<p><code>BlackBeanSoyaMilk.java</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> DesignPattern.template;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> coderYang</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/2/7 13:55</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">BlackBeanSoyaMilk</span> <span class="keyword">extends</span> <span class="title">SoyaMilk</span></span>&#123;</span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">void</span> <span class="title">addCondiments</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    System.out.println(<span class="string">"加上上好的黑豆"</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>







<p><code>PeanutSoyMilk.java</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> DesignPattern.template;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> coderYang</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/2/7 13:56</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">PeanutSoyaMilk</span> <span class="keyword">extends</span> <span class="title">SoyaMilk</span></span>&#123;</span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">void</span> <span class="title">addCondiments</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    System.out.println(<span class="string">"加入上好的花生"</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>







<p><code>Client.java</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> DesignPattern.template;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> coderYang</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/2/7 13:57</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Client</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    System.out.println(<span class="string">"-------制作黑豆豆浆-------"</span>);</span><br><span class="line">    SoyaMilk blackBeanSoyaMilk = <span class="keyword">new</span> BlackBeanSoyaMilk();</span><br><span class="line">    blackBeanSoyaMilk.make();</span><br><span class="line"></span><br><span class="line">    System.out.println(<span class="string">"-------制作花生豆浆-------"</span>);</span><br><span class="line">    SoyaMilk peanutSoyaMilk = <span class="keyword">new</span> PeanutSoyaMilk();</span><br><span class="line">    peanutSoyaMilk.make();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>









<p>运行结果：</p>
<p><img src="/images/Java%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/image-20210207140633675.png" alt="image-20210207140633675"></p>
<p><strong>模板方法模式的钩子方法</strong></p>
<ol>
<li>在模板方法模式的<strong>父类</strong>中，我们可以<strong>定义一个方法</strong>，它<strong>默认不做任何事情</strong>，子类可以视情况要不要覆盖它，该方法称为<strong>钩子</strong>。</li>
<li>还是用上面做豆浆的例子来讲解，比如，我们还希望制作纯豆浆，不添加任何的配料，请使用钩子方法对前面的模板方法进行改造。</li>
</ol>
<p><code>SoyaMilk.java</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> DesignPattern.template.improve;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> coderYang</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/2/7 13:34</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">SoyaMilk</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//模板方法,make,模板方法可以作为final,不让子类去覆盖</span></span><br><span class="line">  <span class="function"><span class="keyword">final</span> <span class="keyword">void</span> <span class="title">make</span><span class="params">()</span></span>&#123;</span><br><span class="line">    select();</span><br><span class="line">    <span class="keyword">if</span>(customerWantCondiments())&#123;</span><br><span class="line">      addCondiments();</span><br><span class="line">    &#125;</span><br><span class="line">    soak();</span><br><span class="line">    beat();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//选材料</span></span><br><span class="line">  <span class="function"><span class="keyword">void</span> <span class="title">select</span><span class="params">()</span></span>&#123;</span><br><span class="line">    System.out.println(<span class="string">"第一步:选择新鲜黄豆"</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//添加不同配料,抽象方法,子类具体实现</span></span><br><span class="line">  <span class="function"><span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">addCondiments</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//浸泡</span></span><br><span class="line">  <span class="function"><span class="keyword">void</span> <span class="title">soak</span><span class="params">()</span></span>&#123;</span><br><span class="line">    System.out.println(<span class="string">"第三步:黄豆和配料开始浸泡,三个小时"</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//打碎</span></span><br><span class="line">  <span class="function"><span class="keyword">void</span> <span class="title">beat</span><span class="params">()</span></span>&#123;</span><br><span class="line">    System.out.println(<span class="string">"第四步:黄豆和配料放到豆浆机去打碎"</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//钩子方法,决定是否添加配料</span></span><br><span class="line">  <span class="function"><span class="keyword">boolean</span> <span class="title">customerWantCondiments</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>







<p><code>PureSoyaMilk.java</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> DesignPattern.template.improve;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> coderYang</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/2/7 14:13</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">PureSoyaMilk</span> <span class="keyword">extends</span> <span class="title">SoyaMilk</span></span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">void</span> <span class="title">addCondiments</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">//空实现</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">boolean</span> <span class="title">customerWantCondiments</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>







<p><code>Client.java</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> DesignPattern.template.improve;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> coderYang</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/2/7 13:57</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Client</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    System.out.println(<span class="string">"-------制作黑豆豆浆-------"</span>);</span><br><span class="line">    SoyaMilk blackBeanSoyaMilk = <span class="keyword">new</span> BlackBeanSoyaMilk();</span><br><span class="line">    blackBeanSoyaMilk.make();</span><br><span class="line"></span><br><span class="line">    System.out.println(<span class="string">"-------制作花生豆浆-------"</span>);</span><br><span class="line">    SoyaMilk peanutSoyaMilk = <span class="keyword">new</span> PeanutSoyaMilk();</span><br><span class="line">    peanutSoyaMilk.make();</span><br><span class="line"></span><br><span class="line">    System.out.println(<span class="string">"--------制作纯豆浆-------"</span>);</span><br><span class="line">    SoyaMilk pureSoyaMilk = <span class="keyword">new</span> PureSoyaMilk();</span><br><span class="line">    pureSoyaMilk.make();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>















<h5 id="模板方法模式在Spring框架应用的源码分析"><a href="#模板方法模式在Spring框架应用的源码分析" class="headerlink" title="模板方法模式在Spring框架应用的源码分析"></a>模板方法模式在Spring框架应用的源码分析</h5><p>Spring IOC容器初始化时运用到的模板方法模式</p>
<p><img src="/images/Java%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/image-20210207183105075.png" alt="image-20210207183105075"></p>
<h5 id="模板方法模式的注意事项和细节"><a href="#模板方法模式的注意事项和细节" class="headerlink" title="模板方法模式的注意事项和细节"></a>模板方法模式的注意事项和细节</h5><ol>
<li>基本思想是：<strong>算法只存在于一个地方，也就是在父类中，容易修改</strong>。需要修改算法时，只要修改父类的模板方法或者已经实现的某些步骤，子类就会继承这些修改。</li>
<li><strong>实现了最大化代码复用</strong>。父类的模板方法和已实现的某些步骤会被子类继承而直接使用。</li>
<li><strong>既统一了算法，也提供了很大的灵活性。</strong>父类的模板方法确保了算法的结构保持不变，同时由子类提供部分步骤的实现。</li>
<li>该模式的不足之处：每一个不同的实现都需要一个子类实现，导致类的个数增加，使得系统更加庞大。</li>
<li>一般模板方法都加上final关键字，防止子类重写模板方法。</li>
<li>模板方法模式使用场景：<strong>当要完成在某个过程，该过程要执行一系列步骤，这一系列的步骤基本相同，但其个别步骤在实现时可能不同</strong>，通常考虑用模板方法模式来处理。</li>
</ol>
<h4 id="13-命令模式"><a href="#13-命令模式" class="headerlink" title="13.命令模式"></a>13.命令模式</h4><p>智能生活项目需求：</p>
<ol>
<li>我们买了一套智能家电，有照明灯、风扇、冰箱、洗衣机，我们只要在手机上安装app就可以控制对这些家电工作。</li>
<li>这些智能家电来自不同的厂家，我们不想针对每一种家电都安装一个App，分别控制，我们希望只要一个app就可以控制全部智能家电。</li>
<li>要实现一个app控制所有智能家电的需要，则每个智能家电厂家都需要提供一个接口给app调用，这时就可以考虑使用命令模式。</li>
<li>命令模式可将”动作的请求者”从”动作的执行者”对象中解耦出来。</li>
<li>在我们的例子中，动作的请求者是手机app，动作的执行者是每个厂商的一个家电产品。</li>
</ol>
<h5 id="命令模式基本介绍"><a href="#命令模式基本介绍" class="headerlink" title="命令模式基本介绍"></a>命令模式基本介绍</h5><ol>
<li>命令模式(Command Pattern)：在软件设计中，我们经常需要向某些对象发送请求，但是并不知道请求的接收者是谁，也不知道被请求的操作是哪个。我们只需要在程序运行时指定具体的请求接收者即可，此时，可以使用命令模式来进行设计。</li>
<li>命令模式使得请求发送者与请求接收者消除彼此之间的耦合，让对象之间的调用关系更加灵活，实现解耦。</li>
<li>在命令模式中，会<strong>将一个请求封装为一个对象</strong>，以便使用不同参数来表示不同的请求(即命名)，同时命令模式也支持可撤销的操作。</li>
<li>通俗易懂的理解：将军发布命令，士兵去执行。其中的几个角色：将军(命令发布者)、士兵(命令的具体执行者)、命令(连接将军和士兵)。Invoker是调用者(将军)，Recevier是被调用者(士兵)，MyCommand是命令，实现了Command接口，持有接收对象。</li>
</ol>
<p><img src="/images/Java%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/image-20210208141904825.png" alt="image-20210208141904825"></p>
<ul>
<li>Invoker：调用者角色</li>
<li>Command：命令角色，需要执行的所有命令都在这里，可以是接口，或抽象类</li>
<li>Receiver：接收者角色，知道如何实施和执行一个请求相关的操作</li>
<li>ConcreteCommand：将一个接收者对象与一个动作绑定，调用接收者相应的操作，实现execute。</li>
</ul>
<h5 id="命令模式解决智能生活项目"><a href="#命令模式解决智能生活项目" class="headerlink" title="命令模式解决智能生活项目"></a>命令模式解决智能生活项目</h5><p><img src="/images/Java%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/image-20210208154001129.png" alt="image-20210208154001129"></p>
<p><img src="/images/Java%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/image-20210208154500584.png" alt="image-20210208154500584"></p>
<p><strong>项目目录</strong></p>
<p><img src="/images/Java%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/image-20210208154029632.png" alt="image-20210208154029632"></p>
<p><code>Command.java</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> DesignPattern.command;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> coderYang</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/2/8 14:37</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//创建命令接口</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Command</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//执行某个操作</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">execute</span><span class="params">()</span></span>;</span><br><span class="line">  <span class="comment">//撤销某个操作</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">undo</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>









<p><code>LightRecevier.java</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> DesignPattern.command;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> coderYang</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/2/8 14:40</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">LightReceiver</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">on</span><span class="params">()</span></span>&#123;</span><br><span class="line">    System.out.println(<span class="string">"电灯打开了"</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">off</span><span class="params">()</span></span>&#123;</span><br><span class="line">    System.out.println(<span class="string">"电灯关闭了"</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>









<p><code>LightOnCommand.java</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> DesignPattern.command;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> coderYang</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/2/8 14:39</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">LightOnCommand</span> <span class="keyword">implements</span> <span class="title">Command</span></span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//聚合LightReceiver</span></span><br><span class="line">  LightReceiver light;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="title">LightOnCommand</span><span class="params">(LightReceiver light)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.light = light;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">execute</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">//调用接收者的方法</span></span><br><span class="line">    light.on();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">undo</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">//调用接收者的方法</span></span><br><span class="line">    light.off();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>









<p><code>LightOffCommand.java</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> DesignPattern.command;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> coderYang</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/2/8 14:43</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">LightOffCommand</span> <span class="keyword">implements</span> <span class="title">Command</span></span>&#123;</span><br><span class="line"></span><br><span class="line">  LightReceiver light;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="title">LightOffCommand</span><span class="params">(LightReceiver light)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.light = light;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">execute</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    light.off();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">undo</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    light.on();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>







<p><code>NullCommand.java</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> DesignPattern.command;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> coderYang</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/2/8 14:46</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 没有任何命令,即空执行:用于初始化每个按钮,当调用空命令时,对象什么都不做</span></span><br><span class="line"><span class="comment"> * 这也是一种设计模式:可以省掉对空判断</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">NullCommand</span> <span class="keyword">implements</span> <span class="title">Command</span></span>&#123;</span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">execute</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">undo</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>







<p><code>RemoteController.java</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> DesignPattern.command;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> coderYang</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/2/8 14:49</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">RemoteController</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//开按钮的命令数组</span></span><br><span class="line">  Command[] onCommands;   <span class="comment">//一列打开按钮(各个功能的)</span></span><br><span class="line">  Command[] offCommands;    <span class="comment">//一列关闭按钮(各个功能的)</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">//执行撤销的命令</span></span><br><span class="line">  Command undoCommand;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="title">RemoteController</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    onCommands = <span class="keyword">new</span> Command[<span class="number">5</span>];</span><br><span class="line">    offCommands = <span class="keyword">new</span> Command[<span class="number">5</span>];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;<span class="number">5</span>;i++)&#123;</span><br><span class="line">      <span class="comment">//默认不操作</span></span><br><span class="line">      onCommands[i] = <span class="keyword">new</span> NullCommand();</span><br><span class="line">      offCommands[i] = <span class="keyword">new</span> NullCommand();</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//给我们的按钮设置你需要的命令</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setCommand</span><span class="params">(<span class="keyword">int</span> no,Command onCommand,Command offCommand)</span></span>&#123;</span><br><span class="line">    onCommands[no] = onCommand;</span><br><span class="line">    offCommands[no] = offCommand;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//按下开的按钮</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onButtonWasPushed</span><span class="params">(<span class="keyword">int</span> no)</span></span>&#123;</span><br><span class="line">    <span class="comment">//找到按下的按钮,并调用对应的方法</span></span><br><span class="line">    onCommands[no].execute();</span><br><span class="line">    <span class="comment">//记录这次的操作,用于撤销</span></span><br><span class="line">    undoCommand = onCommands[no];</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//按下关的按钮</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">offButtonWasPushed</span><span class="params">(<span class="keyword">int</span> no)</span></span>&#123;</span><br><span class="line">    offCommands[no].execute();</span><br><span class="line">    undoCommand = offCommands[no];</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//按下撤销按钮</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">undoButtonWasPushed</span><span class="params">()</span></span>&#123;</span><br><span class="line">    undoCommand.undo();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>











<p><code>Client.java</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> DesignPattern.command;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> coderYang</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/2/8 15:21</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Client</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    <span class="comment">//使用命令设计模式,完成通过遥控器对电灯的操作</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//创建电灯的对象(接收者)</span></span><br><span class="line">    LightReceiver lightReceiver = <span class="keyword">new</span> LightReceiver();</span><br><span class="line"></span><br><span class="line">    <span class="comment">//创建电灯相关的开关命令</span></span><br><span class="line">    LightOnCommand lightOnCommand = <span class="keyword">new</span> LightOnCommand(lightReceiver);</span><br><span class="line">    LightOffCommand lightOffCommand = <span class="keyword">new</span> LightOffCommand(lightReceiver);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//需要一个要控制器来控制</span></span><br><span class="line">    RemoteController remoteController = <span class="keyword">new</span> RemoteController();</span><br><span class="line"></span><br><span class="line">    <span class="comment">//给我们的遥控器设置相关的命令,比如no=0是电灯的开和关的操作</span></span><br><span class="line">    remoteController.setCommand(<span class="number">0</span>,lightOnCommand,lightOffCommand);</span><br><span class="line"></span><br><span class="line">    System.out.println(<span class="string">"--------按下灯的开按钮--------"</span>);</span><br><span class="line">    remoteController.onButtonWasPushed(<span class="number">0</span>);</span><br><span class="line">    System.out.println(<span class="string">"--------按下灯的关按钮--------"</span>);</span><br><span class="line">    remoteController.offButtonWasPushed(<span class="number">0</span>);</span><br><span class="line">    System.out.println(<span class="string">"--------按下灯的撤销按钮--------"</span>);</span><br><span class="line">    remoteController.undoButtonWasPushed();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>









<p><strong>运行结果</strong></p>
<p><img src="/images/Java%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/image-20210208154356179.png" alt="image-20210208154356179"></p>
<h5 id="命令模式在Spring框架JdbcTemplate应用的源码分析"><a href="#命令模式在Spring框架JdbcTemplate应用的源码分析" class="headerlink" title="命令模式在Spring框架JdbcTemplate应用的源码分析"></a>命令模式在Spring框架JdbcTemplate应用的源码分析</h5><p><img src="/images/Java%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/image-20210208162010828.png" alt="image-20210208162010828"></p>
<p><img src="/images/Java%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/image-20210208162336636.png" alt="image-20210208162336636"></p>
<p><img src="/images/Java%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/image-20210208162436336.png" alt="image-20210208162436336"></p>
<p>命令调用者是JdbcTemplate，其中execute(StatementCallback<code>&lt;T&gt;</code>  action )方法中，调用了action.doInStatement方法。不同的实现StatementCallback接口的对象，对应不同的doInStatement实现逻辑。</p>
<p><img src="/images/Java%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/image-20210208163019410.png" alt="image-20210208163019410"></p>
<h5 id="命令模式的注意事项和细节"><a href="#命令模式的注意事项和细节" class="headerlink" title="命令模式的注意事项和细节"></a>命令模式的注意事项和细节</h5><ol>
<li>将发起请求的对象与执行请求的对象解耦。发起请求的对象是调用者，调用者只要调用命令对象的execute()方法就可以让接收者工作，而不必知道具体的接收者对象是谁、是如何实现的，命令对象会负责让接收者执行请求的动作，也就是说：<strong>请求发起者</strong>和<strong>请求执行者</strong>之间的解耦是通过命令对象实现的，命令对象起到了纽带桥梁的作用。</li>
<li>容易设计一个命令队列。只要把命令对象放到队列，就可以多线程的执行命令</li>
<li>容易实现对请求的撤销和重做</li>
<li>命令模式的不足：可能导致某些系统有过多的类，增加了系统的复杂度，这点在使用时要注意</li>
<li>空命令也是一种设计模式，它为我们省去了判空的操作。在上面的示例中，如果没有用空命令，我们每按下一个按键都要判空，这给我们编码带来了一定的麻烦。</li>
<li>命令模式经典的应用场景：界面的一个按钮都是一条命令、模拟CMD(DOS命令)，订单的撤销/恢复、触发-反馈机制。</li>
</ol>
<h4 id="14-访问者模式"><a href="#14-访问者模式" class="headerlink" title="14.访问者模式"></a>14.访问者模式</h4><p><strong>测评系统需求</strong></p>
<p>1.将观众分为男人和女人，对歌手进行测评，当看完某个歌手表演后，得到他们对该歌手不同的评价(评价有不同的种类，比如成功、失败等)</p>
<p>2.传统方案</p>
<p><img src="/images/Java%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/image-20210209132244065.png" alt="image-20210209132244065"></p>
<p><strong>传统方式的问题分析</strong>：</p>
<p>1.如果系统比较小，还是ok的，但是考虑系统增加越来越多新的功能时，对代码改动较大，违反了ocp原则，不利于维护</p>
<p>2.扩展性不好，比如增加了新的人员类型，或者管理方法，都不好做</p>
<h5 id="访问者模式基本介绍"><a href="#访问者模式基本介绍" class="headerlink" title="访问者模式基本介绍"></a>访问者模式基本介绍</h5><ol>
<li><strong>访问者模式(Visitor Pattern)</strong>，封装一些作用于某种数据结构的各元素的操作，它可以在不改变数据结构的前提下定义作用于这些元素的新的操作。</li>
<li>主要将数据结构与数据操作分离，解决<strong>数据结构</strong>和<strong>操作耦合性</strong>问题。</li>
<li><strong>访问者模式的基本工作原理</strong>：在被访问的类里面加一个对外提供接待访问者的接口。</li>
<li><strong>访问者模式主要应用场景是</strong>：需要对一个对象结构中的对象进行很多不同操作(这些操作彼此没有关联)，同时需要避免让这些操作<strong>污染</strong>这些对象的类，可以选用访问者模式解决</li>
</ol>
<p><img src="/images/Java%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/image-20210209161808238.png" alt="image-20210209161808238"></p>
<ul>
<li>Visitor是抽象访问者，为该对象结构中的ConcreteElement的每一个类声明一个visit操作</li>
<li>ConcreteVisitor：是一个具体的访问值实现每个有Visitor声明的操作，是每个操作实现的部分</li>
<li>ObjectStructure：能枚举它的元素，可以提供一个高层的接口，用来允许访问者访问元素</li>
<li>Element：定义一个accept方法，接收一个访问者对象</li>
<li>ConcreteElement：为具体元素，实现了accept方法</li>
</ul>
<h5 id="访问者模式解决测评系统需求"><a href="#访问者模式解决测评系统需求" class="headerlink" title="访问者模式解决测评系统需求"></a>访问者模式解决测评系统需求</h5><p><img src="/images/Java%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/image-20210209155608756.png" alt="image-20210209155608756"></p>
<p><strong>项目目录</strong></p>
<p><img src="/images/Java%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/image-20210209160135948.png" alt="image-20210209160135948"></p>
<p><code>Action.java</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> DesignPattern.visitor;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> coderYang</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/2/9 15:33</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">Action</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//得到男性的测评</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">getManResult</span><span class="params">(Man man)</span></span>;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//得到女性的测评</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">getWomanResult</span><span class="params">(Woman woman)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<p><code>Success.java</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> DesignPattern.visitor;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> coderYang</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/2/9 15:35</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Success</span> <span class="keyword">extends</span> <span class="title">Action</span></span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">getManResult</span><span class="params">(Man man)</span> </span>&#123;</span><br><span class="line">    System.out.println(<span class="string">"女人给歌手的评价是很成功"</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">getWomanResult</span><span class="params">(Woman woman)</span> </span>&#123;</span><br><span class="line">    System.out.println(<span class="string">"女人给该歌手的评价是很成功"</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>







<p><code>Fail.java</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> DesignPattern.visitor;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> coderYang</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/2/9 15:37</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Fail</span> <span class="keyword">extends</span> <span class="title">Action</span></span>&#123;</span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">getManResult</span><span class="params">(Man man)</span> </span>&#123;</span><br><span class="line">    System.out.println(<span class="string">"男人给该歌手的评价是失败"</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">getWomanResult</span><span class="params">(Woman woman)</span> </span>&#123;</span><br><span class="line">    System.out.println(<span class="string">"女人给该歌手的评价是失败"</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<p><code>Person.java</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> DesignPattern.visitor;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> coderYang</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/2/9 15:34</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">Person</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//提供一个方法,让访问者可以访问</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">accept</span><span class="params">(Action action)</span></span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<p><code>Man.java</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> DesignPattern.visitor;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> coderYang</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/2/9 15:35</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Man</span> <span class="keyword">extends</span> <span class="title">Person</span></span>&#123;</span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">accept</span><span class="params">(Action action)</span> </span>&#123;</span><br><span class="line">    action.getManResult(<span class="keyword">this</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<p><code>Woman.java</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> DesignPattern.visitor;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> coderYang</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/2/9 15:35</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 1.这里我们使用到双分派,即首先在客户端程序中,将具体状态作为参数传递Woman中(第一次分派)</span></span><br><span class="line"><span class="comment"> * 2.然后Woman类调用作为参数的"具体方法"中方法getWomanResult,同时将自己(this)作为参数传入</span></span><br><span class="line"><span class="comment"> *   ,完成第二次的分派</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Woman</span> <span class="keyword">extends</span> <span class="title">Person</span></span>&#123;</span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">accept</span><span class="params">(Action action)</span> </span>&#123;</span><br><span class="line">    action.getWomanResult(<span class="keyword">this</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<p><code>ObjectStructure.java</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> DesignPattern.visitor;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.LinkedList;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> coderYang</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/2/9 15:46</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="comment">//数据结构,管理很多人(Man,Woman...)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ObjectStructure</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//维护了一个集合</span></span><br><span class="line">  <span class="keyword">private</span> List&lt;Person&gt; persons = <span class="keyword">new</span> LinkedList&lt;&gt;();</span><br><span class="line"></span><br><span class="line">  <span class="comment">//增加元素到list</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">attach</span><span class="params">(Person person)</span></span>&#123;</span><br><span class="line">    persons.add(person);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//从list移除元素</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">detach</span><span class="params">(Person person)</span></span>&#123;</span><br><span class="line">    persons.remove(person);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//显示测评情况</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">display</span><span class="params">(Action action)</span></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (Person person : persons)&#123;</span><br><span class="line">      person.accept(action);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>









<p><code>Client.java</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> DesignPattern.visitor;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> coderYang</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/2/9 15:51</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Client</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    <span class="comment">//创建ObjectStructure</span></span><br><span class="line">    ObjectStructure objectStructure = <span class="keyword">new</span> ObjectStructure();</span><br><span class="line"></span><br><span class="line">    objectStructure.attach(<span class="keyword">new</span> Man());</span><br><span class="line">    objectStructure.attach(<span class="keyword">new</span> Woman());</span><br><span class="line"></span><br><span class="line">    <span class="comment">//成功</span></span><br><span class="line">    Success success = <span class="keyword">new</span> Success();</span><br><span class="line">    objectStructure.display(success);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//失败fail</span></span><br><span class="line">    System.out.println(<span class="string">"==========="</span>);</span><br><span class="line">    Fail fail = <span class="keyword">new</span> Fail();</span><br><span class="line">    objectStructure.display(fail);</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<p>运行结果：</p>
<p><img src="/images/Java%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/image-20210209160441778.png" alt="image-20210209160441778"></p>
<h5 id="双分派"><a href="#双分派" class="headerlink" title="双分派"></a>双分派</h5><p>上面提到了双分派，所谓双分派是不管类怎么变化，我们都能找到期望的方法运行。双分派意味着得到执行的操作取决于请求的种类和两个接收者的类型。</p>
<p>以上述实例为例，假设我们要添加一个Wait的状态类，考察Man类和Woman类的反应，由于使用了双分派，<strong>只需要增加一个Action子类即可在客户端调用即可，不需要改动任何其他类的代码</strong>。</p>
<h5 id="访问者模式的注意事项和细节"><a href="#访问者模式的注意事项和细节" class="headerlink" title="访问者模式的注意事项和细节"></a>访问者模式的注意事项和细节</h5><p>优点：</p>
<ol>
<li>访问者模式符合单一职责原则、让程序具有优秀的扩展性、灵活性非常高</li>
<li>访问者模式可以对功能进行统一，可以做报表、UI、拦截器与过滤器，适用于数据结构相对稳定的系统</li>
</ol>
<p>缺点：</p>
<ol>
<li>具体元素对访问者公布细节，也就是说访问者关注了其他类的内部细节，这就是迪米特原则所不建议的，这样造成了具体元素变更比较困难</li>
<li>违背了依赖倒转原则。<strong>访问者依赖的是具体元素，而不是抽象元素</strong></li>
<li>因此，如果一个系统有比较稳定的数据结构，又有经常变化的功能需求，那么访问者模式就是比较适合的。</li>
</ol>
</article><!-- lincense--><div class="license-wrapper"><p> <span>Author:  </span><a href="http://xhh460.github.io">小灰灰</a></p><p> <span>Link:  </span><a href="http://xhh460.github.io/2020/12/01/Java%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/">http://xhh460.github.io/2020/12/01/Java%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/</a></p><p> <span>Copyright:  </span><span>All articles in this blog are licensed.</span></p></div><div class="post-paginator"><a class="prevSlogan" href="/2020/12/15/%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/" title="自动化测试"><span>< PreviousPost</span><br><span class="prevTitle">自动化测试</span></a><a class="nextSlogan" href="/2020/10/26/Jsp/" title="Jsp"><span>NextPost ></span><br><span class="nextTitle">Jsp</span></a><div class="clear"></div></div><div id="comment"></div></section></article><footer id="cxo-footer-outer"><div id="cxo-footer-inner"><p class="footer-container"><span>Site by </span><a href="http://hexo.io" target="_blank" rel="noopener"><span>Hexo</span></a><span> | theme </span><a href="https://github.com/Longlongyu/hexo-theme-Cxo" target="_blank" rel="noopener"><span>Cxo</span></a></p><i class="fa fa-user"> </i><span id="busuanzi_value_site_uv"></span><span> | </span><i class="fa fa-eye"> </i><span id="busuanzi_value_site_pv"></span><script>var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?" + 'true';
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();</script></div></footer><!-- catelog--><div class="toc-wrapper" style="top: 70vh;"><div class="toc-catalog"><i class="fa fa-list"> </i><span>CATALOG</span></div><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Java设计模式"><span class="toc-number">1.</span> <span class="toc-text">Java设计模式</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#设计模式常用的七大原则："><span class="toc-number">1.0.1.</span> <span class="toc-text">设计模式常用的七大原则：</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-单一职责原则-Single-Principle-Responsibility"><span class="toc-number">1.0.1.1.</span> <span class="toc-text">1.单一职责原则(Single Principle Responsibility)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-接口隔离原则-Interface-Segregation-Principle"><span class="toc-number">1.0.1.2.</span> <span class="toc-text">2.接口隔离原则(Interface Segregation Principle)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-依赖倒转原则-Dependence-Inversion-Principle"><span class="toc-number">1.0.1.3.</span> <span class="toc-text">3.依赖倒转原则(Dependence Inversion Principle)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-里氏替换原则-Liskov-Substitution-principle"><span class="toc-number">1.0.1.4.</span> <span class="toc-text">4.里氏替换原则(Liskov Substitution principle)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-开闭原则-Open-Closed-Principle"><span class="toc-number">1.0.1.5.</span> <span class="toc-text">5.开闭原则(Open Closed Principle)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6-迪米特法则-Demeter-Principle"><span class="toc-number">1.0.1.6.</span> <span class="toc-text">6.迪米特法则(Demeter Principle)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#7-合成复用原则-Composite-Reuse-Principle"><span class="toc-number">1.0.1.7.</span> <span class="toc-text">7.合成复用原则(Composite Reuse Principle)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#8-设计原则核心思想"><span class="toc-number">1.0.1.8.</span> <span class="toc-text">8.设计原则核心思想</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#类和类之间的关系"><span class="toc-number">1.0.2.</span> <span class="toc-text">类和类之间的关系</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-依赖-Dependence"><span class="toc-number">1.0.2.1.</span> <span class="toc-text">1.依赖(Dependence)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-泛化-Generalization"><span class="toc-number">1.0.2.2.</span> <span class="toc-text">2.泛化(Generalization)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-实现-Implementation"><span class="toc-number">1.0.2.3.</span> <span class="toc-text">3.实现(Implementation)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-关联-Association"><span class="toc-number">1.0.2.4.</span> <span class="toc-text">4.关联(Association)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-聚合-Aggregation"><span class="toc-number">1.0.2.5.</span> <span class="toc-text">5.聚合(Aggregation)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6-组合-Composition"><span class="toc-number">1.0.2.6.</span> <span class="toc-text">6.组合(Composition)</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#设计模式类型"><span class="toc-number">1.0.3.</span> <span class="toc-text">设计模式类型</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-单例设计模式"><span class="toc-number">1.0.3.1.</span> <span class="toc-text">1.单例设计模式</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#单例设计模式八种形式"><span class="toc-number">1.0.3.1.1.</span> <span class="toc-text">单例设计模式八种形式</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#饿汉式-静态常量"><span class="toc-number">1.0.3.1.2.</span> <span class="toc-text">饿汉式(静态常量)</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#饿汉式-静态代码块"><span class="toc-number">1.0.3.1.3.</span> <span class="toc-text">饿汉式(静态代码块)</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#懒汉式-线程不安全"><span class="toc-number">1.0.3.1.4.</span> <span class="toc-text">懒汉式(线程不安全)</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#懒汉式-线程安全，同步方法"><span class="toc-number">1.0.3.1.5.</span> <span class="toc-text">懒汉式(线程安全，同步方法)</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#双重检查"><span class="toc-number">1.0.3.1.6.</span> <span class="toc-text">双重检查</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#静态内部类"><span class="toc-number">1.0.3.1.7.</span> <span class="toc-text">静态内部类</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#枚举"><span class="toc-number">1.0.3.1.8.</span> <span class="toc-text">枚举</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#单例模式在JDK中应用分析"><span class="toc-number">1.0.3.1.9.</span> <span class="toc-text">单例模式在JDK中应用分析</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#单例模式注意事项和细节"><span class="toc-number">1.0.3.1.10.</span> <span class="toc-text">单例模式注意事项和细节</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-工厂设计模式"><span class="toc-number">1.0.3.2.</span> <span class="toc-text">2.工厂设计模式</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#传统方式"><span class="toc-number">1.0.3.2.1.</span> <span class="toc-text">传统方式</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#简单工厂模式"><span class="toc-number">1.0.3.2.2.</span> <span class="toc-text">简单工厂模式</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#工厂方法模式"><span class="toc-number">1.0.3.2.3.</span> <span class="toc-text">工厂方法模式</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#抽象工厂模式"><span class="toc-number">1.0.3.2.4.</span> <span class="toc-text">抽象工厂模式</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#JDK中的简单工厂模式"><span class="toc-number">1.0.3.2.5.</span> <span class="toc-text">JDK中的简单工厂模式</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#工厂模式总结"><span class="toc-number">1.0.3.2.6.</span> <span class="toc-text">工厂模式总结</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-原型模式"><span class="toc-number">1.0.3.3.</span> <span class="toc-text">3.原型模式</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#传统的方式解决克隆羊问题"><span class="toc-number">1.0.3.3.1.</span> <span class="toc-text">传统的方式解决克隆羊问题</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#改进-原型模式"><span class="toc-number">1.0.3.3.2.</span> <span class="toc-text">改进(原型模式)</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#原型模式在Spring框架中源码分析"><span class="toc-number">1.0.3.3.3.</span> <span class="toc-text">原型模式在Spring框架中源码分析</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#浅拷贝与深拷贝"><span class="toc-number">1.0.3.3.4.</span> <span class="toc-text">浅拷贝与深拷贝</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#原型模式注意事项及缺点"><span class="toc-number">1.0.3.3.5.</span> <span class="toc-text">原型模式注意事项及缺点</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-建造者模式"><span class="toc-number">1.0.3.4.</span> <span class="toc-text">4.建造者模式</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#传统方式解决建房子需求："><span class="toc-number">1.0.3.4.1.</span> <span class="toc-text">传统方式解决建房子需求：</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#建造者模式介绍"><span class="toc-number">1.0.3.4.2.</span> <span class="toc-text">建造者模式介绍</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#建造者模式解决建房子需求"><span class="toc-number">1.0.3.4.3.</span> <span class="toc-text">建造者模式解决建房子需求</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#建造者模式在JDK中的应用和源码分析"><span class="toc-number">1.0.3.4.4.</span> <span class="toc-text">建造者模式在JDK中的应用和源码分析</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#建造者模式注意事项和细节"><span class="toc-number">1.0.3.4.5.</span> <span class="toc-text">建造者模式注意事项和细节</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-适配器模式"><span class="toc-number">1.0.3.5.</span> <span class="toc-text">5.适配器模式</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#类适配器模式"><span class="toc-number">1.0.3.5.1.</span> <span class="toc-text">类适配器模式</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#对象适配器模式"><span class="toc-number">1.0.3.5.2.</span> <span class="toc-text">对象适配器模式</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#接口适配器模式"><span class="toc-number">1.0.3.5.3.</span> <span class="toc-text">接口适配器模式</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#适配器模式在SpringMVC框架应用的源码分析"><span class="toc-number">1.0.3.5.4.</span> <span class="toc-text">适配器模式在SpringMVC框架应用的源码分析</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#适配器模式的注意事项和细节"><span class="toc-number">1.0.3.5.5.</span> <span class="toc-text">适配器模式的注意事项和细节</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6-桥接模式"><span class="toc-number">1.0.3.6.</span> <span class="toc-text">6.桥接模式</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#传统问题解决手机操作问题分析"><span class="toc-number">1.0.3.6.1.</span> <span class="toc-text">传统问题解决手机操作问题分析</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#桥接模式基本介绍"><span class="toc-number">1.0.3.6.2.</span> <span class="toc-text">桥接模式基本介绍</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#桥接模式解决手机问题"><span class="toc-number">1.0.3.6.3.</span> <span class="toc-text">桥接模式解决手机问题</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#桥接模式在JDBC的源码剖析"><span class="toc-number">1.0.3.6.4.</span> <span class="toc-text">桥接模式在JDBC的源码剖析</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#桥接模式的注意事项和细节"><span class="toc-number">1.0.3.6.5.</span> <span class="toc-text">桥接模式的注意事项和细节</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#7-装饰者模式"><span class="toc-number">1.0.3.7.</span> <span class="toc-text">7.装饰者模式</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#装饰者模式定义"><span class="toc-number">1.0.3.7.1.</span> <span class="toc-text">装饰者模式定义</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#装饰者模式-Decorator-原理"><span class="toc-number">1.0.3.7.2.</span> <span class="toc-text">装饰者模式(Decorator)原理</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#装饰者模式解决星巴克咖啡订单"><span class="toc-number">1.0.3.7.3.</span> <span class="toc-text">装饰者模式解决星巴克咖啡订单</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#装饰者模式在JDK应用的源码分析"><span class="toc-number">1.0.3.7.4.</span> <span class="toc-text">装饰者模式在JDK应用的源码分析</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#8-组合模式"><span class="toc-number">1.0.3.8.</span> <span class="toc-text">8.组合模式</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#传统方案解决学校院系展示存在问题的分析"><span class="toc-number">1.0.3.8.1.</span> <span class="toc-text">传统方案解决学校院系展示存在问题的分析</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#组合模式基本介绍"><span class="toc-number">1.0.3.8.2.</span> <span class="toc-text">组合模式基本介绍</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#组合模式解决的问题"><span class="toc-number">1.0.3.8.3.</span> <span class="toc-text">组合模式解决的问题</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#组合模式解决学校院系展示"><span class="toc-number">1.0.3.8.4.</span> <span class="toc-text">组合模式解决学校院系展示</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#组合模式在JDK集合的源码分析"><span class="toc-number">1.0.3.8.5.</span> <span class="toc-text">组合模式在JDK集合的源码分析</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#组合模式的注意事项和细节"><span class="toc-number">1.0.3.8.6.</span> <span class="toc-text">组合模式的注意事项和细节</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#9-外观模式"><span class="toc-number">1.0.3.9.</span> <span class="toc-text">9.外观模式</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#传统方式解决影院管理问题分析"><span class="toc-number">1.0.3.9.1.</span> <span class="toc-text">传统方式解决影院管理问题分析</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#外观模式基本介绍"><span class="toc-number">1.0.3.9.2.</span> <span class="toc-text">外观模式基本介绍</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#外观模式解决影院管理"><span class="toc-number">1.0.3.9.3.</span> <span class="toc-text">外观模式解决影院管理</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#外观模式在Mybatis框架应用的源码分析"><span class="toc-number">1.0.3.9.4.</span> <span class="toc-text">外观模式在Mybatis框架应用的源码分析</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#外观模式的注意事项和细节"><span class="toc-number">1.0.3.9.5.</span> <span class="toc-text">外观模式的注意事项和细节</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#10-享元模式"><span class="toc-number">1.0.3.10.</span> <span class="toc-text">10.享元模式</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#传统方式解决网站展现项目-问题分析"><span class="toc-number">1.0.3.10.1.</span> <span class="toc-text">传统方式解决网站展现项目-问题分析</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#享元模式基本介绍"><span class="toc-number">1.0.3.10.2.</span> <span class="toc-text">享元模式基本介绍</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#享元模式解决网站外包问题"><span class="toc-number">1.0.3.10.3.</span> <span class="toc-text">享元模式解决网站外包问题</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#享元模式在JDK-Integral的应用源码分析"><span class="toc-number">1.0.3.10.4.</span> <span class="toc-text">享元模式在JDK-Integral的应用源码分析</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#享元模式的注意事项和细节"><span class="toc-number">1.0.3.10.5.</span> <span class="toc-text">享元模式的注意事项和细节</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#11-代理模式"><span class="toc-number">1.0.3.11.</span> <span class="toc-text">11.代理模式</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#代理模式基本介绍"><span class="toc-number">1.0.3.11.1.</span> <span class="toc-text">代理模式基本介绍</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#静态代理"><span class="toc-number">1.0.3.11.2.</span> <span class="toc-text">静态代理</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#动态代理"><span class="toc-number">1.0.3.11.3.</span> <span class="toc-text">动态代理</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Cglib代理"><span class="toc-number">1.0.3.11.4.</span> <span class="toc-text">Cglib代理</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#代理模式的变体"><span class="toc-number">1.0.3.11.5.</span> <span class="toc-text">代理模式的变体</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#12-模板方法模式"><span class="toc-number">1.0.3.12.</span> <span class="toc-text">12.模板方法模式</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#模板模式基本介绍"><span class="toc-number">1.0.3.12.1.</span> <span class="toc-text">模板模式基本介绍</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#模板方法模式解决豆浆制作问题"><span class="toc-number">1.0.3.12.2.</span> <span class="toc-text">模板方法模式解决豆浆制作问题</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#模板方法模式在Spring框架应用的源码分析"><span class="toc-number">1.0.3.12.3.</span> <span class="toc-text">模板方法模式在Spring框架应用的源码分析</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#模板方法模式的注意事项和细节"><span class="toc-number">1.0.3.12.4.</span> <span class="toc-text">模板方法模式的注意事项和细节</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#13-命令模式"><span class="toc-number">1.0.3.13.</span> <span class="toc-text">13.命令模式</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#命令模式基本介绍"><span class="toc-number">1.0.3.13.1.</span> <span class="toc-text">命令模式基本介绍</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#命令模式解决智能生活项目"><span class="toc-number">1.0.3.13.2.</span> <span class="toc-text">命令模式解决智能生活项目</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#命令模式在Spring框架JdbcTemplate应用的源码分析"><span class="toc-number">1.0.3.13.3.</span> <span class="toc-text">命令模式在Spring框架JdbcTemplate应用的源码分析</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#命令模式的注意事项和细节"><span class="toc-number">1.0.3.13.4.</span> <span class="toc-text">命令模式的注意事项和细节</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#14-访问者模式"><span class="toc-number">1.0.3.14.</span> <span class="toc-text">14.访问者模式</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#访问者模式基本介绍"><span class="toc-number">1.0.3.14.1.</span> <span class="toc-text">访问者模式基本介绍</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#访问者模式解决测评系统需求"><span class="toc-number">1.0.3.14.2.</span> <span class="toc-text">访问者模式解决测评系统需求</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#双分派"><span class="toc-number">1.0.3.14.3.</span> <span class="toc-text">双分派</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#访问者模式的注意事项和细节"><span class="toc-number">1.0.3.14.4.</span> <span class="toc-text">访问者模式的注意事项和细节</span></a></li></ol></li></ol></li></ol></li></ol></li></ol></div><!-- top--><i class="fa fa-arrow-up close" id="go-up" aria-hidden="true"></i><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"debug":false,"model":{"jsonPath":"/live2dw/assets/assets/shizuku.model.json"},"display":{"position":"right","width":150,"height":300},"mobile":{"show":true},"log":false});</script></body></html>